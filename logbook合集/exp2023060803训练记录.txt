(base) jialu@jialu-System-Product-Name:~$ cd zeroshot123cycle0524/
(base) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ conda activate dfnet0514
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_pre_posenet_dso.py --config config_dfnetdm.txt --no_grad_update False --lrate 5e-8 
Command Line Args:   --config config_dfnetdm.txt --no_grad_update False --lrate 5e-8
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    ['1.', '10.', '50.']
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       True
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --learning_rate:   1e-05
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2

 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]

frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]

frame_idx_dso[0:4] =  [0 1 2 3]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg_from_file = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (1186, 3, 4)
pose_avg =  [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]]


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                          | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
At epoch    0 : train loss: 4.5593, train psnr: 19.8882, val loss: 0.0001, val psnr: 19.0284
epochs:   0%|                                          | 0/2001 [01:37<?, ?it/s]

 ============= self.val_on_psnr =  True
                      Median error 0.0095484578050673m and 0.8735664784908295 degrees.al loss: 19.0284
Mean error 0.011148542102717564m and 1.0092880174985177 degrees.
epochs:   0%|                              | 1/2001 [01:42<57:01:31, 102.65s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch    1 : train loss: 4.4907, train psnr: 20.1171, val loss: 0.0001, val psnr: 19.9173          
epochs:   0%|                              | 1/2001 [03:17<57:01:31, 102.65s/it]
Best val loss: 19.0284
 ============= self.val_on_psnr =  True
epochs:   0%|                              | 2/2001 [03:17<55:40:12, 100.26s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    2 : train loss: 4.3007, train psnr: 20.1994, val loss: 0.0001, val psnr: 19.2111          
epochs:   0%|                              | 2/2001 [04:52<55:40:12, 100.26s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 3/2001 [04:52<54:49:13, 98.78s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    3 : train loss: 4.7848, train psnr: 19.6711, val loss: 0.0004, val psnr: 19.0742          
epochs:   0%|                               | 3/2001 [06:34<54:49:13, 98.78s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 4/2001 [06:34<55:14:43, 99.59s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    4 : train loss: 4.8438, train psnr: 19.5788, val loss: 0.0002, val psnr: 18.7308          
epochs:   0%|                               | 4/2001 [08:12<55:14:43, 99.59s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 5/2001 [08:12<54:56:21, 99.09s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    5 : train loss: 4.1094, train psnr: 20.3963, val loss: 0.0002, val psnr: 19.6966          
epochs:   0%|                               | 5/2001 [09:52<54:56:21, 99.09s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 6/2001 [09:52<55:08:16, 99.50s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    6 : train loss: 3.9945, train psnr: 20.4955, val loss: 0.0002, val psnr: 19.2866          
epochs:   0%|                               | 6/2001 [11:30<55:08:16, 99.50s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 7/2001 [11:30<54:54:38, 99.14s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    7 : train loss: 4.8856, train psnr: 19.7942, val loss: 0.0001, val psnr: 19.0850          
epochs:   0%|                               | 7/2001 [13:14<54:54:38, 99.14s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|                              | 8/2001 [13:14<55:37:17, 100.47s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    8 : train loss: 4.2496, train psnr: 20.1734, val loss: 0.0001, val psnr: 18.8450          
epochs:   0%|                              | 8/2001 [14:50<55:37:17, 100.47s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|▏                              | 9/2001 [14:50<54:50:17, 99.11s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch    9 : train loss: 4.4568, train psnr: 20.0584, val loss: 0.0001, val psnr: 19.6255          
epochs:   0%|▏                              | 9/2001 [16:24<54:50:17, 99.11s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   0%|▏                             | 10/2001 [16:24<53:58:36, 97.60s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch   10 : train loss: 4.2237, train psnr: 20.2044, val loss: 0.0002, val psnr: 19.3014          
epochs:   0%|▏                             | 10/2001 [17:58<53:58:36, 97.60s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 11/2001 [17:58<53:24:58, 96.63s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch   11 : train loss: 4.2583, train psnr: 20.2289, val loss: 0.0001, val psnr: 19.0917          
epochs:   1%|▏                             | 11/2001 [19:33<53:24:58, 96.63s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 12/2001 [19:33<53:00:36, 95.95s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch   12 : train loss: 4.6878, train psnr: 19.7880, val loss: 0.0001, val psnr: 18.0848          
epochs:   1%|▏                             | 12/2001 [21:07<53:00:36, 95.95s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 13/2001 [21:07<52:43:07, 95.47s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch   13 : train loss: 4.4040, train psnr: 20.1277, val loss: 0.0001, val psnr: 19.4692          
epochs:   1%|▏                             | 13/2001 [22:41<52:43:07, 95.47s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 14/2001 [22:41<52:29:55, 95.12s/it]
Best val loss: 19.9173
 ==== Origional DFnet training in train_on_epoch==========
At epoch   14 : train loss: 4.1932, train psnr: 20.2442, val loss: 0.0001, val psnr: 19.9347          
epochs:   1%|▏                             | 14/2001 [24:16<52:29:55, 95.12s/it]
Best val loss: 19.9173
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 15/2001 [24:16<52:22:31, 94.94s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   15 : train loss: 4.3090, train psnr: 20.1094, val loss: 0.0001, val psnr: 19.2700          
epochs:   1%|▏                             | 15/2001 [25:50<52:22:31, 94.94s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 16/2001 [25:50<52:18:06, 94.85s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   16 : train loss: 4.1754, train psnr: 20.3787, val loss: 0.0001, val psnr: 19.5897          
epochs:   1%|▏                             | 16/2001 [27:25<52:18:06, 94.85s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 17/2001 [27:25<52:11:15, 94.70s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   17 : train loss: 4.0779, train psnr: 20.4469, val loss: 0.0001, val psnr: 19.5971          
epochs:   1%|▎                             | 17/2001 [28:59<52:11:15, 94.70s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 18/2001 [28:59<52:07:34, 94.63s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   18 : train loss: 4.5469, train psnr: 20.0264, val loss: 0.0002, val psnr: 18.8658          
epochs:   1%|▎                             | 18/2001 [30:34<52:07:34, 94.63s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 19/2001 [30:34<52:02:53, 94.54s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   19 : train loss: 4.3635, train psnr: 20.1869, val loss: 0.0001, val psnr: 19.2727          
epochs:   1%|▎                             | 19/2001 [32:08<52:02:53, 94.54s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 20/2001 [32:08<51:59:33, 94.48s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   20 : train loss: 4.4648, train psnr: 20.0642, val loss: 0.0001, val psnr: 18.5410          
epochs:   1%|▎                             | 20/2001 [33:42<51:59:33, 94.48s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
                      Median error 0.011452232021838427m and 0.8299170136451721 degrees. loss: 19.9347
Mean error 0.014480829081118205m and 0.9951470781660635 degrees.
epochs:   1%|▎                             | 21/2001 [33:47<52:46:54, 95.97s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   21 : train loss: 4.0616, train psnr: 20.2602, val loss: 0.0001, val psnr: 19.2554          
epochs:   1%|▎                             | 21/2001 [35:22<52:46:54, 95.97s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 22/2001 [35:22<52:29:27, 95.49s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   22 : train loss: 4.4098, train psnr: 20.0284, val loss: 0.0001, val psnr: 19.4653          
epochs:   1%|▎                             | 22/2001 [36:56<52:29:27, 95.49s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 23/2001 [36:56<52:17:06, 95.16s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   23 : train loss: 4.5259, train psnr: 20.0103, val loss: 0.0001, val psnr: 19.4074          
epochs:   1%|▎                             | 23/2001 [38:30<52:17:06, 95.16s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 24/2001 [38:30<52:07:37, 94.92s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   24 : train loss: 4.3273, train psnr: 20.2437, val loss: 0.0001, val psnr: 19.4541          
epochs:   1%|▎                             | 24/2001 [40:05<52:07:37, 94.92s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 25/2001 [40:05<52:01:08, 94.77s/it]
Best val loss: 19.9347
 ==== Origional DFnet training in train_on_epoch==========
At epoch   25 : train loss: 3.9472, train psnr: 20.5694, val loss: 0.0001, val psnr: 20.2022          
epochs:   1%|▎                             | 25/2001 [41:39<52:01:08, 94.77s/it]
Best val loss: 19.9347
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 26/2001 [41:39<51:55:00, 94.63s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   26 : train loss: 4.1358, train psnr: 20.3717, val loss: 0.0001, val psnr: 19.7828          
epochs:   1%|▍                             | 26/2001 [43:14<51:55:00, 94.63s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 27/2001 [43:14<51:52:50, 94.62s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   27 : train loss: 3.8786, train psnr: 20.5724, val loss: 0.0001, val psnr: 19.2960          
epochs:   1%|▍                             | 27/2001 [44:48<51:52:50, 94.62s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 28/2001 [44:48<51:48:53, 94.54s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   28 : train loss: 4.2873, train psnr: 20.3754, val loss: 0.0001, val psnr: 19.7320          
epochs:   1%|▍                             | 28/2001 [46:23<51:48:53, 94.54s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 29/2001 [46:23<51:46:46, 94.53s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   29 : train loss: 4.2929, train psnr: 20.3288, val loss: 0.0001, val psnr: 20.0084          
epochs:   1%|▍                             | 29/2001 [47:57<51:46:46, 94.53s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 30/2001 [47:57<51:43:21, 94.47s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   30 : train loss: 4.0205, train psnr: 20.4961, val loss: 0.0001, val psnr: 19.3512          
epochs:   1%|▍                             | 30/2001 [49:31<51:43:21, 94.47s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 31/2001 [49:31<51:37:55, 94.35s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   31 : train loss: 4.5436, train psnr: 19.7989, val loss: 0.0002, val psnr: 18.9298          
epochs:   2%|▍                             | 31/2001 [51:06<51:37:55, 94.35s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 32/2001 [51:06<51:37:15, 94.38s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   32 : train loss: 4.5468, train psnr: 19.9180, val loss: 0.0001, val psnr: 19.6160          
epochs:   2%|▍                             | 32/2001 [52:40<51:37:15, 94.38s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 33/2001 [52:40<51:37:07, 94.42s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   33 : train loss: 4.2902, train psnr: 20.2679, val loss: 0.0001, val psnr: 19.7977          
epochs:   2%|▍                             | 33/2001 [54:15<51:37:07, 94.42s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 34/2001 [54:15<51:36:57, 94.47s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   34 : train loss: 3.9584, train psnr: 20.5089, val loss: 0.0001, val psnr: 19.6382          
epochs:   2%|▌                             | 34/2001 [55:49<51:36:57, 94.47s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 35/2001 [55:49<51:34:42, 94.45s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   35 : train loss: 4.4512, train psnr: 20.0353, val loss: 0.0001, val psnr: 19.7895          
epochs:   2%|▌                             | 35/2001 [57:24<51:34:42, 94.45s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 36/2001 [57:24<51:34:00, 94.47s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   36 : train loss: 3.8618, train psnr: 20.5754, val loss: 0.0001, val psnr: 20.1000          
epochs:   2%|▌                             | 36/2001 [58:58<51:34:00, 94.47s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 37/2001 [58:58<51:32:04, 94.46s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   37 : train loss: 3.9303, train psnr: 20.5804, val loss: 0.0001, val psnr: 19.3094          
epochs:   2%|▌                           | 37/2001 [1:00:32<51:32:04, 94.46s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 38/2001 [1:00:32<51:27:37, 94.37s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   38 : train loss: 4.5031, train psnr: 19.9759, val loss: 0.0001, val psnr: 19.5304          
epochs:   2%|▌                           | 38/2001 [1:02:07<51:27:37, 94.37s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 39/2001 [1:02:07<51:27:06, 94.41s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   39 : train loss: 4.6807, train psnr: 19.8948, val loss: 0.0001, val psnr: 18.9813          
epochs:   2%|▌                           | 39/2001 [1:03:41<51:27:06, 94.41s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 40/2001 [1:03:41<51:24:16, 94.37s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   40 : train loss: 4.3661, train psnr: 20.0812, val loss: 0.0001, val psnr: 19.3959          
epochs:   2%|▌                           | 40/2001 [1:05:15<51:24:16, 94.37s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
                      Median error 0.008692000061273575m and 0.8517908453941345 degrees. loss: 20.2022
Mean error 0.011288230174871752m and 1.0131667020093453 degrees.
epochs:   2%|▌                           | 41/2001 [1:05:21<52:15:18, 95.98s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   41 : train loss: 4.0633, train psnr: 20.3454, val loss: 0.0001, val psnr: 19.8503          
epochs:   2%|▌                           | 41/2001 [1:06:55<52:15:18, 95.98s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 42/2001 [1:06:55<51:59:28, 95.54s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   42 : train loss: 4.1179, train psnr: 20.4310, val loss: 0.0001, val psnr: 19.7808          
epochs:   2%|▌                           | 42/2001 [1:08:29<51:59:28, 95.54s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 43/2001 [1:08:29<51:45:32, 95.16s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   43 : train loss: 3.9714, train psnr: 20.4334, val loss: 0.0001, val psnr: 17.9791          
epochs:   2%|▌                           | 43/2001 [1:10:04<51:45:32, 95.16s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 44/2001 [1:10:04<51:35:24, 94.90s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   44 : train loss: 4.0271, train psnr: 20.5143, val loss: 0.0001, val psnr: 19.9044          
epochs:   2%|▌                           | 44/2001 [1:11:38<51:35:24, 94.90s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 45/2001 [1:11:38<51:29:12, 94.76s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   45 : train loss: 3.9613, train psnr: 20.5203, val loss: 0.0001, val psnr: 20.0313          
epochs:   2%|▋                           | 45/2001 [1:13:13<51:29:12, 94.76s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 46/2001 [1:13:13<51:24:40, 94.67s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   46 : train loss: 3.9547, train psnr: 20.4136, val loss: 0.0001, val psnr: 19.8809          
epochs:   2%|▋                           | 46/2001 [1:14:47<51:24:40, 94.67s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 47/2001 [1:14:47<51:21:54, 94.63s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   47 : train loss: 4.0412, train psnr: 20.3580, val loss: 0.0001, val psnr: 18.9821          
epochs:   2%|▋                           | 47/2001 [1:16:22<51:21:54, 94.63s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 48/2001 [1:16:22<51:19:37, 94.61s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   48 : train loss: 4.3944, train psnr: 20.2034, val loss: 0.0001, val psnr: 19.8635          
epochs:   2%|▋                           | 48/2001 [1:17:56<51:19:37, 94.61s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 49/2001 [1:17:56<51:16:25, 94.56s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   49 : train loss: 4.1980, train psnr: 20.2897, val loss: 0.0001, val psnr: 19.7232          
epochs:   2%|▋                           | 49/2001 [1:19:31<51:16:25, 94.56s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 50/2001 [1:19:31<51:13:22, 94.52s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   50 : train loss: 4.3515, train psnr: 20.2004, val loss: 0.0002, val psnr: 19.5763          
epochs:   2%|▋                           | 50/2001 [1:21:05<51:13:22, 94.52s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 51/2001 [1:21:05<51:11:56, 94.52s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   51 : train loss: 4.1996, train psnr: 20.3182, val loss: 0.0001, val psnr: 18.4711          
epochs:   3%|▋                           | 51/2001 [1:22:39<51:11:56, 94.52s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 52/2001 [1:22:39<51:08:20, 94.46s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   52 : train loss: 4.2738, train psnr: 20.3561, val loss: 0.0001, val psnr: 19.7549          
epochs:   3%|▋                           | 52/2001 [1:24:14<51:08:20, 94.46s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 53/2001 [1:24:14<51:05:52, 94.43s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   53 : train loss: 3.7603, train psnr: 20.7343, val loss: 0.0001, val psnr: 19.7582          
epochs:   3%|▋                           | 53/2001 [1:25:48<51:05:52, 94.43s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 54/2001 [1:25:48<51:04:45, 94.45s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   54 : train loss: 3.8993, train psnr: 20.4815, val loss: 0.0001, val psnr: 19.6111          
epochs:   3%|▊                           | 54/2001 [1:27:23<51:04:45, 94.45s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 55/2001 [1:27:23<51:03:42, 94.46s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   55 : train loss: 3.6647, train psnr: 20.7809, val loss: 0.0001, val psnr: 19.3421          
epochs:   3%|▊                           | 55/2001 [1:28:57<51:03:42, 94.46s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 56/2001 [1:28:57<51:02:39, 94.48s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   56 : train loss: 4.1674, train psnr: 20.3791, val loss: 0.0001, val psnr: 19.6947          
epochs:   3%|▊                           | 56/2001 [1:30:32<51:02:39, 94.48s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 57/2001 [1:30:32<51:02:09, 94.51s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   57 : train loss: 3.9469, train psnr: 20.4395, val loss: 0.0001, val psnr: 19.5666          
epochs:   3%|▊                           | 57/2001 [1:32:06<51:02:09, 94.51s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 58/2001 [1:32:06<51:00:02, 94.49s/it]
Best val loss: 20.2022
 ==== Origional DFnet training in train_on_epoch==========
At epoch   58 : train loss: 3.8984, train psnr: 20.4833, val loss: 0.0001, val psnr: 20.2281          
epochs:   3%|▊                           | 58/2001 [1:33:41<51:00:02, 94.49s/it]
Best val loss: 20.2022
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 59/2001 [1:33:41<50:58:30, 94.50s/it]
Best val loss: 20.2281
 ==== Origional DFnet training in train_on_epoch==========
At epoch   59 : train loss: 3.6255, train psnr: 20.8206, val loss: 0.0001, val psnr: 18.6714          
epochs:   3%|▊                           | 59/2001 [1:35:16<50:58:30, 94.50s/it]
Best val loss: 20.2281
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 60/2001 [1:35:16<50:58:36, 94.55s/it]
Best val loss: 20.2281
 ==== Origional DFnet training in train_on_epoch==========
At epoch   60 : train loss: 3.9043, train psnr: 20.6572, val loss: 0.0001, val psnr: 20.2483          
epochs:   3%|▊                           | 60/2001 [1:36:50<50:58:36, 94.55s/it]
Best val loss: 20.2281
 ============= self.val_on_psnr =  True
                      Median error 0.0083601800724864m and 0.7808401882648468 degrees.al loss: 20.2483
Mean error 0.010207853980561782m and 0.9819527202651568 degrees.
epochs:   3%|▊                           | 61/2001 [1:36:55<51:45:46, 96.06s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   61 : train loss: 3.8147, train psnr: 20.5768, val loss: 0.0001, val psnr: 19.3009          
epochs:   3%|▊                           | 61/2001 [1:38:30<51:45:46, 96.06s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 62/2001 [1:38:30<51:31:03, 95.65s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   62 : train loss: 4.1933, train psnr: 20.3803, val loss: 0.0001, val psnr: 19.9035          
epochs:   3%|▊                           | 62/2001 [1:40:04<51:31:03, 95.65s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 63/2001 [1:40:04<51:20:06, 95.36s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   63 : train loss: 3.7431, train psnr: 20.7554, val loss: 0.0001, val psnr: 19.8606          
epochs:   3%|▉                           | 63/2001 [1:41:39<51:20:06, 95.36s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 64/2001 [1:41:39<51:09:19, 95.07s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   64 : train loss: 3.9353, train psnr: 20.6368, val loss: 0.0001, val psnr: 19.2583          
epochs:   3%|▉                           | 64/2001 [1:43:13<51:09:19, 95.07s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 65/2001 [1:43:13<51:02:14, 94.90s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   65 : train loss: 3.7937, train psnr: 20.6723, val loss: 0.0001, val psnr: 19.6879          
epochs:   3%|▉                           | 65/2001 [1:44:48<51:02:14, 94.90s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 66/2001 [1:44:48<50:55:33, 94.75s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   66 : train loss: 4.2420, train psnr: 20.4420, val loss: 0.0001, val psnr: 19.6937          
epochs:   3%|▉                           | 66/2001 [1:46:22<50:55:33, 94.75s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 67/2001 [1:46:22<50:51:52, 94.68s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   67 : train loss: 4.3568, train psnr: 20.3134, val loss: 0.0001, val psnr: 19.6317          
epochs:   3%|▉                           | 67/2001 [1:47:57<50:51:52, 94.68s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 68/2001 [1:47:57<50:48:44, 94.63s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   68 : train loss: 3.8545, train psnr: 20.5615, val loss: 0.0001, val psnr: 19.8891          
epochs:   3%|▉                           | 68/2001 [1:49:31<50:48:44, 94.63s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 69/2001 [1:49:31<50:44:45, 94.56s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   69 : train loss: 3.6845, train psnr: 20.7770, val loss: 0.0001, val psnr: 19.6340          
epochs:   3%|▉                           | 69/2001 [1:51:06<50:44:45, 94.56s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 70/2001 [1:51:06<50:42:59, 94.55s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   70 : train loss: 4.0846, train psnr: 20.2582, val loss: 0.0001, val psnr: 19.5788          
epochs:   3%|▉                           | 70/2001 [1:52:40<50:42:59, 94.55s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   4%|▉                           | 71/2001 [1:52:40<50:40:18, 94.52s/it]
Best val loss: 20.2483
 ==== Origional DFnet training in train_on_epoch==========
At epoch   71 : train loss: 3.6233, train psnr: 20.7808, val loss: 0.0001, val psnr: 20.3853          
epochs:   4%|▉                           | 71/2001 [1:54:14<50:40:18, 94.52s/it]
Best val loss: 20.2483
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 72/2001 [1:54:14<50:35:10, 94.41s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   72 : train loss: 3.8766, train psnr: 20.6385, val loss: 0.0001, val psnr: 19.9851          
epochs:   4%|█                           | 72/2001 [1:55:49<50:35:10, 94.41s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 73/2001 [1:55:49<50:34:13, 94.43s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   73 : train loss: 4.1372, train psnr: 20.3809, val loss: 0.0001, val psnr: 19.0262          
epochs:   4%|█                           | 73/2001 [1:57:23<50:34:13, 94.43s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 74/2001 [1:57:23<50:33:36, 94.46s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   74 : train loss: 3.9737, train psnr: 20.5918, val loss: 0.0001, val psnr: 19.8491          
epochs:   4%|█                           | 74/2001 [1:58:58<50:33:36, 94.46s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 75/2001 [1:58:58<50:33:47, 94.51s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   75 : train loss: 3.7834, train psnr: 20.6036, val loss: 0.0001, val psnr: 19.0023          
epochs:   4%|█                           | 75/2001 [2:00:32<50:33:47, 94.51s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 76/2001 [2:00:32<50:31:23, 94.48s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   76 : train loss: 4.1980, train psnr: 20.1933, val loss: 0.0001, val psnr: 19.2359          
epochs:   4%|█                           | 76/2001 [2:02:07<50:31:23, 94.48s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 77/2001 [2:02:07<50:27:38, 94.42s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   77 : train loss: 3.7799, train psnr: 20.7557, val loss: 0.0001, val psnr: 20.3099          
epochs:   4%|█                           | 77/2001 [2:03:41<50:27:38, 94.42s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 78/2001 [2:03:41<50:26:30, 94.43s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   78 : train loss: 4.0319, train psnr: 20.4464, val loss: 0.0001, val psnr: 19.9778          
epochs:   4%|█                           | 78/2001 [2:05:15<50:26:30, 94.43s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 79/2001 [2:05:15<50:23:42, 94.39s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   79 : train loss: 3.8555, train psnr: 20.7415, val loss: 0.0001, val psnr: 20.0562          
epochs:   4%|█                           | 79/2001 [2:06:50<50:23:42, 94.39s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 80/2001 [2:06:50<50:21:16, 94.37s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   80 : train loss: 3.6796, train psnr: 20.6865, val loss: 0.0001, val psnr: 19.9319          
epochs:   4%|█                           | 80/2001 [2:08:24<50:21:16, 94.37s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
                      Median error 0.009667590726166964m and 0.7077556252479553 degrees. loss: 20.3853
Mean error 0.011985793026934307m and 0.9081477918077697 degrees.
epochs:   4%|█▏                          | 81/2001 [2:08:30<51:11:56, 96.00s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   81 : train loss: 3.9670, train psnr: 20.5930, val loss: 0.0001, val psnr: 19.4643          
epochs:   4%|█▏                          | 81/2001 [2:10:04<51:11:56, 96.00s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 82/2001 [2:10:04<50:56:15, 95.56s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   82 : train loss: 3.6877, train psnr: 20.8103, val loss: 0.0001, val psnr: 18.6991          
epochs:   4%|█▏                          | 82/2001 [2:11:38<50:56:15, 95.56s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 83/2001 [2:11:38<50:43:54, 95.22s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   83 : train loss: 3.6945, train psnr: 20.6605, val loss: 0.0001, val psnr: 19.9448          
epochs:   4%|█▏                          | 83/2001 [2:13:13<50:43:54, 95.22s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 84/2001 [2:13:13<50:32:49, 94.92s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   84 : train loss: 3.8796, train psnr: 20.5837, val loss: 0.0001, val psnr: 19.1527          
epochs:   4%|█▏                          | 84/2001 [2:14:47<50:32:49, 94.92s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 85/2001 [2:14:47<50:26:34, 94.78s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   85 : train loss: 3.7597, train psnr: 20.7134, val loss: 0.0001, val psnr: 19.0453          
epochs:   4%|█▏                          | 85/2001 [2:16:22<50:26:34, 94.78s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 86/2001 [2:16:22<50:21:27, 94.67s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   86 : train loss: 3.8878, train psnr: 20.5389, val loss: 0.0001, val psnr: 19.4736          
epochs:   4%|█▏                          | 86/2001 [2:17:56<50:21:27, 94.67s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 87/2001 [2:17:56<50:15:21, 94.53s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   87 : train loss: 3.7111, train psnr: 20.6693, val loss: 0.0001, val psnr: 20.1311          
epochs:   4%|█▏                          | 87/2001 [2:19:30<50:15:21, 94.53s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 88/2001 [2:19:30<50:14:14, 94.54s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   88 : train loss: 3.7418, train psnr: 20.6274, val loss: 0.0001, val psnr: 19.7263          
epochs:   4%|█▏                          | 88/2001 [2:21:05<50:14:14, 94.54s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 89/2001 [2:21:05<50:09:58, 94.46s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   89 : train loss: 3.7965, train psnr: 20.7777, val loss: 0.0001, val psnr: 19.1051          
epochs:   4%|█▏                          | 89/2001 [2:22:39<50:09:58, 94.46s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   4%|█▎                          | 90/2001 [2:22:39<50:08:28, 94.46s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   90 : train loss: 3.6375, train psnr: 20.8451, val loss: 0.0001, val psnr: 20.1351          
epochs:   4%|█▎                          | 90/2001 [2:24:13<50:08:28, 94.46s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 91/2001 [2:24:13<50:05:51, 94.42s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   91 : train loss: 3.9120, train psnr: 20.6339, val loss: 0.0001, val psnr: 19.6337          
epochs:   5%|█▎                          | 91/2001 [2:25:48<50:05:51, 94.42s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 92/2001 [2:25:48<50:05:18, 94.46s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   92 : train loss: 3.9125, train psnr: 20.5239, val loss: 0.0001, val psnr: 19.7057          
epochs:   5%|█▎                          | 92/2001 [2:27:22<50:05:18, 94.46s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 93/2001 [2:27:22<50:02:46, 94.43s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   93 : train loss: 3.8178, train psnr: 20.6646, val loss: 0.0001, val psnr: 19.2413          
epochs:   5%|█▎                          | 93/2001 [2:28:57<50:02:46, 94.43s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 94/2001 [2:28:57<50:01:56, 94.45s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   94 : train loss: 4.1259, train psnr: 20.3565, val loss: 0.0001, val psnr: 19.8733          
epochs:   5%|█▎                          | 94/2001 [2:30:31<50:01:56, 94.45s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 95/2001 [2:30:31<50:00:16, 94.45s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   95 : train loss: 4.0362, train psnr: 20.5244, val loss: 0.0001, val psnr: 19.2822          
epochs:   5%|█▎                          | 95/2001 [2:32:06<50:00:16, 94.45s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 96/2001 [2:32:06<49:57:48, 94.42s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   96 : train loss: 3.7908, train psnr: 20.6249, val loss: 0.0001, val psnr: 19.2336          
epochs:   5%|█▎                          | 96/2001 [2:33:40<49:57:48, 94.42s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 97/2001 [2:33:40<49:54:20, 94.36s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   97 : train loss: 3.6353, train psnr: 20.9418, val loss: 0.0001, val psnr: 19.5824          
epochs:   5%|█▎                          | 97/2001 [2:35:14<49:54:20, 94.36s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 98/2001 [2:35:14<49:53:12, 94.37s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   98 : train loss: 3.8934, train psnr: 20.6908, val loss: 0.0001, val psnr: 19.5008          
epochs:   5%|█▎                          | 98/2001 [2:36:48<49:53:12, 94.37s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                          | 99/2001 [2:36:48<49:50:00, 94.32s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch   99 : train loss: 3.8120, train psnr: 20.6925, val loss: 0.0001, val psnr: 20.3209          
epochs:   5%|█▍                          | 99/2001 [2:38:23<49:50:00, 94.32s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                         | 100/2001 [2:38:23<49:51:03, 94.40s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  100 : train loss: 3.5815, train psnr: 20.8479, val loss: 0.0001, val psnr: 19.7019          
epochs:   5%|█▎                         | 100/2001 [2:39:57<49:51:03, 94.40s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
                      Median error 0.007528732530772686m and 0.7932703793048859 degrees. loss: 20.3853
Mean error 0.009947513400467192m and 0.9932929921729362 degrees.
epochs:   5%|█▎                         | 101/2001 [2:40:02<50:37:03, 95.91s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  101 : train loss: 3.9002, train psnr: 20.6134, val loss: 0.0001, val psnr: 18.8749          
epochs:   5%|█▎                         | 101/2001 [2:41:37<50:37:03, 95.91s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 102/2001 [2:41:37<50:21:23, 95.46s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  102 : train loss: 3.8350, train psnr: 20.7882, val loss: 0.0001, val psnr: 19.4447          
epochs:   5%|█▍                         | 102/2001 [2:43:11<50:21:23, 95.46s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 103/2001 [2:43:11<50:09:56, 95.15s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  103 : train loss: 3.7231, train psnr: 20.7615, val loss: 0.0001, val psnr: 19.7036          
epochs:   5%|█▍                         | 103/2001 [2:44:46<50:09:56, 95.15s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 104/2001 [2:44:46<49:59:44, 94.88s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  104 : train loss: 3.5091, train psnr: 21.0041, val loss: 0.0001, val psnr: 20.1430          
epochs:   5%|█▍                         | 104/2001 [2:46:20<49:59:44, 94.88s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 105/2001 [2:46:20<49:53:01, 94.72s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  105 : train loss: 4.0309, train psnr: 20.5387, val loss: 0.0001, val psnr: 19.9258          
epochs:   5%|█▍                         | 105/2001 [2:47:54<49:53:01, 94.72s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 106/2001 [2:47:54<49:48:23, 94.62s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  106 : train loss: 3.6377, train psnr: 20.8342, val loss: 0.0001, val psnr: 19.8897          
epochs:   5%|█▍                         | 106/2001 [2:49:29<49:48:23, 94.62s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 107/2001 [2:49:29<49:44:30, 94.55s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  107 : train loss: 3.9617, train psnr: 20.5957, val loss: 0.0001, val psnr: 18.9193          
epochs:   5%|█▍                         | 107/2001 [2:51:03<49:44:30, 94.55s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 108/2001 [2:51:03<49:40:40, 94.47s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  108 : train loss: 3.7656, train psnr: 20.5816, val loss: 0.0001, val psnr: 19.3290          
epochs:   5%|█▍                         | 108/2001 [2:52:37<49:40:40, 94.47s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 109/2001 [2:52:37<49:38:06, 94.44s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  109 : train loss: 3.9951, train psnr: 20.5063, val loss: 0.0001, val psnr: 19.8618          
epochs:   5%|█▍                         | 109/2001 [2:54:12<49:38:06, 94.44s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 110/2001 [2:54:12<49:36:09, 94.43s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  110 : train loss: 3.8885, train psnr: 20.5900, val loss: 0.0001, val psnr: 20.2253          
epochs:   5%|█▍                         | 110/2001 [2:55:46<49:36:09, 94.43s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   6%|█▍                         | 111/2001 [2:55:46<49:34:52, 94.44s/it]
Best val loss: 20.3853
 ==== Origional DFnet training in train_on_epoch==========
At epoch  111 : train loss: 3.5909, train psnr: 20.8664, val loss: 0.0001, val psnr: 20.3972          
epochs:   6%|█▍                         | 111/2001 [2:57:20<49:34:52, 94.44s/it]
Best val loss: 20.3853
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 112/2001 [2:57:20<49:31:32, 94.38s/it]
Best val loss: 20.3972
 ==== Origional DFnet training in train_on_epoch==========
At epoch  112 : train loss: 4.4612, train psnr: 20.1812, val loss: 0.0001, val psnr: 20.0446          
epochs:   6%|█▌                         | 112/2001 [2:58:55<49:31:32, 94.38s/it]
Best val loss: 20.3972
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 113/2001 [2:58:55<49:31:10, 94.42s/it]
Best val loss: 20.3972
 ==== Origional DFnet training in train_on_epoch==========
At epoch  113 : train loss: 3.8184, train psnr: 20.6447, val loss: 0.0001, val psnr: 20.5991          
epochs:   6%|█▌                         | 113/2001 [3:00:29<49:31:10, 94.42s/it]
Best val loss: 20.3972
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 114/2001 [3:00:29<49:29:07, 94.41s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  114 : train loss: 3.5516, train psnr: 20.8726, val loss: 0.0001, val psnr: 19.4522          
epochs:   6%|█▌                         | 114/2001 [3:02:04<49:29:07, 94.41s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 115/2001 [3:02:04<49:28:54, 94.45s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  115 : train loss: 3.5832, train psnr: 20.9218, val loss: 0.0001, val psnr: 19.6846          
epochs:   6%|█▌                         | 115/2001 [3:03:38<49:28:54, 94.45s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 116/2001 [3:03:38<49:27:41, 94.46s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  116 : train loss: 3.7146, train psnr: 20.7437, val loss: 0.0001, val psnr: 19.6326          
epochs:   6%|█▌                         | 116/2001 [3:05:13<49:27:41, 94.46s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 117/2001 [3:05:13<49:25:18, 94.44s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  117 : train loss: 3.3955, train psnr: 20.9886, val loss: 0.0001, val psnr: 20.4862          
epochs:   6%|█▌                         | 117/2001 [3:06:47<49:25:18, 94.44s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 118/2001 [3:06:47<49:23:27, 94.43s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  118 : train loss: 3.9276, train psnr: 20.4208, val loss: 0.0001, val psnr: 20.2369          
epochs:   6%|█▌                         | 118/2001 [3:08:22<49:23:27, 94.43s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 119/2001 [3:08:22<49:21:35, 94.42s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  119 : train loss: 3.6126, train psnr: 20.7390, val loss: 0.0001, val psnr: 19.5093          
epochs:   6%|█▌                         | 119/2001 [3:09:56<49:21:35, 94.42s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 120/2001 [3:09:56<49:19:45, 94.41s/it]
Best val loss: 20.5991
 ==== Origional DFnet training in train_on_epoch==========
At epoch  120 : train loss: 3.8865, train psnr: 20.5814, val loss: 0.0001, val psnr: 20.6335          
epochs:   6%|█▌                         | 120/2001 [3:11:30<49:19:45, 94.41s/it]
Best val loss: 20.5991
 ============= self.val_on_psnr =  True
                      Median error 0.007476606871932745m and 0.7823424339294434 degrees. loss: 20.6335
Mean error 0.009817071520808946m and 0.9933852594277939 degrees.
epochs:   6%|█▋                         | 121/2001 [3:11:35<50:06:25, 95.95s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  121 : train loss: 3.6971, train psnr: 20.7739, val loss: 0.0001, val psnr: 19.8986          
epochs:   6%|█▋                         | 121/2001 [3:13:10<50:06:25, 95.95s/it]
Best val loss: 20.6335
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 122/2001 [3:13:10<49:51:21, 95.52s/it]
Best val loss: 20.6335
 ==== Origional DFnet training in train_on_epoch==========
At epoch  122 : train loss: 3.5596, train psnr: 20.8395, val loss: 0.0001, val psnr: 20.6845          
epochs:   6%|█▋                         | 122/2001 [3:14:44<49:51:21, 95.52s/it]
Best val loss: 20.6335
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 123/2001 [3:14:44<49:40:17, 95.22s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  123 : train loss: 3.5195, train psnr: 20.8108, val loss: 0.0001, val psnr: 19.2510          
epochs:   6%|█▋                         | 123/2001 [3:16:19<49:40:17, 95.22s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 124/2001 [3:16:19<49:32:35, 95.02s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  124 : train loss: 3.6021, train psnr: 20.8181, val loss: 0.0001, val psnr: 19.9572          
epochs:   6%|█▋                         | 124/2001 [3:17:54<49:32:35, 95.02s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 125/2001 [3:17:54<49:27:40, 94.92s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  125 : train loss: 3.8581, train psnr: 20.5869, val loss: 0.0001, val psnr: 19.8118          
epochs:   6%|█▋                         | 125/2001 [3:19:28<49:27:40, 94.92s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 126/2001 [3:19:28<49:22:03, 94.79s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  126 : train loss: 3.4069, train psnr: 21.1312, val loss: 0.0001, val psnr: 20.1100          
epochs:   6%|█▋                         | 126/2001 [3:21:03<49:22:03, 94.79s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 127/2001 [3:21:03<49:17:45, 94.70s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  127 : train loss: 3.8149, train psnr: 20.6012, val loss: 0.0001, val psnr: 20.0546          
epochs:   6%|█▋                         | 127/2001 [3:22:37<49:17:45, 94.70s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 128/2001 [3:22:37<49:14:10, 94.63s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  128 : train loss: 3.5482, train psnr: 20.9272, val loss: 0.0001, val psnr: 20.1316          
epochs:   6%|█▋                         | 128/2001 [3:24:12<49:14:10, 94.63s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 129/2001 [3:24:12<49:10:44, 94.58s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  129 : train loss: 3.8466, train psnr: 20.6790, val loss: 0.0001, val psnr: 19.7568          
epochs:   6%|█▋                         | 129/2001 [3:25:46<49:10:44, 94.58s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   6%|█▊                         | 130/2001 [3:25:46<49:09:06, 94.57s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  130 : train loss: 3.8763, train psnr: 20.6362, val loss: 0.0001, val psnr: 20.0644          
epochs:   6%|█▊                         | 130/2001 [3:27:21<49:09:06, 94.57s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 131/2001 [3:27:21<49:08:00, 94.59s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  131 : train loss: 3.5075, train psnr: 20.9251, val loss: 0.0001, val psnr: 20.1691          
epochs:   7%|█▊                         | 131/2001 [3:28:55<49:08:00, 94.59s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 132/2001 [3:28:55<49:04:03, 94.51s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  132 : train loss: 3.9830, train psnr: 20.6662, val loss: 0.0001, val psnr: 20.3687          
epochs:   7%|█▊                         | 132/2001 [3:30:30<49:04:03, 94.51s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 133/2001 [3:30:30<49:02:07, 94.50s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  133 : train loss: 3.5213, train psnr: 20.9312, val loss: 0.0001, val psnr: 19.8270          
epochs:   7%|█▊                         | 133/2001 [3:32:04<49:02:07, 94.50s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 134/2001 [3:32:04<48:59:24, 94.46s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  134 : train loss: 3.5808, train psnr: 20.9081, val loss: 0.0001, val psnr: 19.8510          
epochs:   7%|█▊                         | 134/2001 [3:33:38<48:59:24, 94.46s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 135/2001 [3:33:38<48:57:47, 94.46s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  135 : train loss: 3.7658, train psnr: 20.7494, val loss: 0.0001, val psnr: 19.4259          
epochs:   7%|█▊                         | 135/2001 [3:35:13<48:57:47, 94.46s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 136/2001 [3:35:13<48:56:59, 94.49s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  136 : train loss: 3.4578, train psnr: 20.9955, val loss: 0.0001, val psnr: 19.9837          
epochs:   7%|█▊                         | 136/2001 [3:36:48<48:56:59, 94.49s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 137/2001 [3:36:48<48:55:40, 94.50s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  137 : train loss: 3.8853, train psnr: 20.6485, val loss: 0.0001, val psnr: 19.2853          
epochs:   7%|█▊                         | 137/2001 [3:38:22<48:55:40, 94.50s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 138/2001 [3:38:22<48:54:33, 94.51s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  138 : train loss: 3.5598, train psnr: 20.8315, val loss: 0.0001, val psnr: 20.0172          
epochs:   7%|█▊                         | 138/2001 [3:39:56<48:54:33, 94.51s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 139/2001 [3:39:56<48:51:59, 94.48s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  139 : train loss: 3.7142, train psnr: 20.8736, val loss: 0.0001, val psnr: 19.4875          
epochs:   7%|█▉                         | 139/2001 [3:41:31<48:51:59, 94.48s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 140/2001 [3:41:31<48:49:55, 94.46s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  140 : train loss: 3.4534, train psnr: 21.1699, val loss: 0.0001, val psnr: 19.6909          
epochs:   7%|█▉                         | 140/2001 [3:43:05<48:49:55, 94.46s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
                      Median error 0.007960395887494087m and 0.7823424339294434 degrees. loss: 20.6845
Mean error 0.010329504405678088m and 0.9727942546799417 degrees.
epochs:   7%|█▉                         | 141/2001 [3:43:10<49:34:13, 95.94s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  141 : train loss: 3.7279, train psnr: 20.8859, val loss: 0.0001, val psnr: 19.8565          
epochs:   7%|█▉                         | 141/2001 [3:44:45<49:34:13, 95.94s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 142/2001 [3:44:45<49:21:39, 95.59s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  142 : train loss: 3.5309, train psnr: 20.8937, val loss: 0.0001, val psnr: 20.1699          
epochs:   7%|█▉                         | 142/2001 [3:46:20<49:21:39, 95.59s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 143/2001 [3:46:20<49:09:52, 95.26s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  143 : train loss: 3.5545, train psnr: 20.8651, val loss: 0.0001, val psnr: 20.0667          
epochs:   7%|█▉                         | 143/2001 [3:47:54<49:09:52, 95.26s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 144/2001 [3:47:54<49:01:17, 95.03s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  144 : train loss: 3.7603, train psnr: 20.7527, val loss: 0.0001, val psnr: 20.0878          
epochs:   7%|█▉                         | 144/2001 [3:49:28<49:01:17, 95.03s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 145/2001 [3:49:28<48:52:15, 94.79s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  145 : train loss: 3.4222, train psnr: 21.1553, val loss: 0.0001, val psnr: 19.9770          
epochs:   7%|█▉                         | 145/2001 [3:51:03<48:52:15, 94.79s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 146/2001 [3:51:03<48:47:28, 94.69s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  146 : train loss: 3.9674, train psnr: 20.4953, val loss: 0.0001, val psnr: 19.9617          
epochs:   7%|█▉                         | 146/2001 [3:52:37<48:47:28, 94.69s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 147/2001 [3:52:37<48:43:41, 94.62s/it]
Best val loss: 20.6845
 ==== Origional DFnet training in train_on_epoch==========
At epoch  147 : train loss: 3.3567, train psnr: 20.9074, val loss: 0.0001, val psnr: 20.6957          
epochs:   7%|█▉                         | 147/2001 [3:54:12<48:43:41, 94.62s/it]
Best val loss: 20.6845
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 148/2001 [3:54:12<48:42:04, 94.62s/it]
Best val loss: 20.6957
 ==== Origional DFnet training in train_on_epoch==========
At epoch  148 : train loss: 3.4178, train psnr: 21.0564, val loss: 0.0001, val psnr: 19.6706          
epochs:   7%|█▉                         | 148/2001 [3:55:46<48:42:04, 94.62s/it]
Best val loss: 20.6957
 ============= self.val_on_psnr =  True
epochs:   7%|██                         | 149/2001 [3:55:46<48:39:46, 94.59s/it]
Best val loss: 20.6957
 ==== Origional DFnet training in train_on_epoch==========
At epoch  149 : train loss: 3.6847, train psnr: 20.7957, val loss: 0.0001, val psnr: 19.2468          
epochs:   7%|██                         | 149/2001 [3:57:21<48:39:46, 94.59s/it]
Best val loss: 20.6957
 ============= self.val_on_psnr =  True
epochs:   7%|██                         | 150/2001 [3:57:21<48:39:13, 94.63s/it]
Best val loss: 20.6957
 ==== Origional DFnet training in train_on_epoch==========
At epoch  150 : train loss: 3.5990, train psnr: 20.9146, val loss: 0.0001, val psnr: 20.7707          
epochs:   7%|██                         | 150/2001 [3:58:56<48:39:13, 94.63s/it]
Best val loss: 20.6957
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 151/2001 [3:58:56<48:37:03, 94.61s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  151 : train loss: 3.5535, train psnr: 20.8582, val loss: 0.0001, val psnr: 19.7364          
epochs:   8%|██                         | 151/2001 [4:00:30<48:37:03, 94.61s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 152/2001 [4:00:30<48:34:53, 94.59s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  152 : train loss: 3.4143, train psnr: 21.0386, val loss: 0.0001, val psnr: 20.2188          
epochs:   8%|██                         | 152/2001 [4:02:05<48:34:53, 94.59s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 153/2001 [4:02:05<48:32:03, 94.55s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  153 : train loss: 3.6160, train psnr: 20.8753, val loss: 0.0001, val psnr: 20.1899          
epochs:   8%|██                         | 153/2001 [4:03:39<48:32:03, 94.55s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 154/2001 [4:03:39<48:30:13, 94.54s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  154 : train loss: 3.2842, train psnr: 21.1954, val loss: 0.0001, val psnr: 19.1723          
epochs:   8%|██                         | 154/2001 [4:05:14<48:30:13, 94.54s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 155/2001 [4:05:14<48:28:15, 94.53s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  155 : train loss: 3.5104, train psnr: 20.9972, val loss: 0.0001, val psnr: 18.8922          
epochs:   8%|██                         | 155/2001 [4:06:48<48:28:15, 94.53s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 156/2001 [4:06:48<48:26:52, 94.53s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  156 : train loss: 3.8372, train psnr: 20.7271, val loss: 0.0001, val psnr: 19.6545          
epochs:   8%|██                         | 156/2001 [4:08:23<48:26:52, 94.53s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 157/2001 [4:08:23<48:27:34, 94.61s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  157 : train loss: 3.4942, train psnr: 20.9100, val loss: 0.0001, val psnr: 19.6065          
epochs:   8%|██                         | 157/2001 [4:09:58<48:27:34, 94.61s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 158/2001 [4:09:58<48:26:48, 94.63s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  158 : train loss: 3.5232, train psnr: 20.9314, val loss: 0.0001, val psnr: 19.4909          
epochs:   8%|██▏                        | 158/2001 [4:11:32<48:26:48, 94.63s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 159/2001 [4:11:32<48:22:57, 94.56s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  159 : train loss: 3.8974, train psnr: 20.5121, val loss: 0.0001, val psnr: 19.5526          
epochs:   8%|██▏                        | 159/2001 [4:13:06<48:22:57, 94.56s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 160/2001 [4:13:06<48:20:31, 94.53s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  160 : train loss: 3.7710, train psnr: 20.7430, val loss: 0.0001, val psnr: 19.4935          
epochs:   8%|██▏                        | 160/2001 [4:14:41<48:20:31, 94.53s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
                      Median error 0.009474195074290037m and 0.8416225016117096 degrees. loss: 20.7707
Mean error 0.011610620043114174m and 0.9976364544966081 degrees.
epochs:   8%|██▏                        | 161/2001 [4:14:46<49:05:45, 96.06s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  161 : train loss: 3.2816, train psnr: 21.2014, val loss: 0.0001, val psnr: 20.6457          
epochs:   8%|██▏                        | 161/2001 [4:16:21<49:05:45, 96.06s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 162/2001 [4:16:21<48:51:05, 95.63s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  162 : train loss: 3.3589, train psnr: 21.1868, val loss: 0.0001, val psnr: 19.7163          
epochs:   8%|██▏                        | 162/2001 [4:17:55<48:51:05, 95.63s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 163/2001 [4:17:55<48:39:20, 95.30s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  163 : train loss: 3.3696, train psnr: 21.1655, val loss: 0.0001, val psnr: 19.9493          
epochs:   8%|██▏                        | 163/2001 [4:19:30<48:39:20, 95.30s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 164/2001 [4:19:30<48:30:08, 95.05s/it]
Best val loss: 20.7707
 ==== Origional DFnet training in train_on_epoch==========
At epoch  164 : train loss: 3.5331, train psnr: 20.9075, val loss: 0.0001, val psnr: 20.9799          
epochs:   8%|██▏                        | 164/2001 [4:21:04<48:30:08, 95.05s/it]
Best val loss: 20.7707
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 165/2001 [4:21:04<48:23:32, 94.89s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  165 : train loss: 3.4158, train psnr: 21.1173, val loss: 0.0001, val psnr: 19.6777          
epochs:   8%|██▏                        | 165/2001 [4:22:39<48:23:32, 94.89s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 166/2001 [4:22:39<48:18:09, 94.76s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  166 : train loss: 3.6271, train psnr: 20.9262, val loss: 0.0001, val psnr: 20.3784          
epochs:   8%|██▏                        | 166/2001 [4:24:13<48:18:09, 94.76s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 167/2001 [4:24:13<48:15:51, 94.74s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  167 : train loss: 3.5992, train psnr: 20.8940, val loss: 0.0001, val psnr: 19.7458          
epochs:   8%|██▎                        | 167/2001 [4:25:48<48:15:51, 94.74s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 168/2001 [4:25:48<48:12:25, 94.68s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  168 : train loss: 3.9264, train psnr: 20.5661, val loss: 0.0001, val psnr: 18.3395          
epochs:   8%|██▎                        | 168/2001 [4:27:22<48:12:25, 94.68s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 169/2001 [4:27:22<48:09:37, 94.64s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  169 : train loss: 3.5061, train psnr: 21.0508, val loss: 0.0001, val psnr: 20.0545          
epochs:   8%|██▎                        | 169/2001 [4:28:57<48:09:37, 94.64s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 170/2001 [4:28:57<48:07:36, 94.62s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  170 : train loss: 3.3132, train psnr: 21.1555, val loss: 0.0001, val psnr: 19.9468          
epochs:   8%|██▎                        | 170/2001 [4:30:31<48:07:36, 94.62s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 171/2001 [4:30:31<48:03:50, 94.55s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  171 : train loss: 4.1331, train psnr: 20.4071, val loss: 0.0001, val psnr: 19.7204          
epochs:   9%|██▎                        | 171/2001 [4:32:06<48:03:50, 94.55s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 172/2001 [4:32:06<48:02:52, 94.57s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  172 : train loss: 3.6191, train psnr: 20.8646, val loss: 0.0001, val psnr: 20.6345          
epochs:   9%|██▎                        | 172/2001 [4:33:41<48:02:52, 94.57s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 173/2001 [4:33:41<47:59:59, 94.53s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  173 : train loss: 3.7710, train psnr: 20.7404, val loss: 0.0001, val psnr: 20.3461          
epochs:   9%|██▎                        | 173/2001 [4:35:15<47:59:59, 94.53s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 174/2001 [4:35:15<47:57:55, 94.51s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  174 : train loss: 3.3783, train psnr: 21.1530, val loss: 0.0001, val psnr: 20.4567          
epochs:   9%|██▎                        | 174/2001 [4:36:50<47:57:55, 94.51s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 175/2001 [4:36:50<47:56:37, 94.52s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  175 : train loss: 3.4609, train psnr: 21.0601, val loss: 0.0001, val psnr: 20.3750          
epochs:   9%|██▎                        | 175/2001 [4:38:24<47:56:37, 94.52s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 176/2001 [4:38:24<47:54:47, 94.51s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  176 : train loss: 3.3388, train psnr: 21.2210, val loss: 0.0001, val psnr: 18.8834          
epochs:   9%|██▎                        | 176/2001 [4:39:58<47:54:47, 94.51s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 177/2001 [4:39:58<47:51:52, 94.47s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  177 : train loss: 3.3304, train psnr: 21.2091, val loss: 0.0001, val psnr: 20.5204          
epochs:   9%|██▍                        | 177/2001 [4:41:33<47:51:52, 94.47s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 178/2001 [4:41:33<47:50:24, 94.47s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  178 : train loss: 3.1633, train psnr: 21.4021, val loss: 0.0001, val psnr: 20.6853          
epochs:   9%|██▍                        | 178/2001 [4:43:07<47:50:24, 94.47s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 179/2001 [4:43:07<47:50:15, 94.52s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  179 : train loss: 3.1752, train psnr: 21.3618, val loss: 0.0001, val psnr: 20.5645          
epochs:   9%|██▍                        | 179/2001 [4:44:44<47:50:15, 94.52s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 180/2001 [4:44:44<48:05:23, 95.07s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  180 : train loss: 3.3281, train psnr: 21.2240, val loss: 0.0001, val psnr: 20.4170          
epochs:   9%|██▍                        | 180/2001 [4:46:22<48:05:23, 95.07s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
                      Median error 0.007250673603266478m and 0.7666786313056946 degrees. loss: 20.9799
Mean error 0.009492201014265874m and 0.9472577520551891 degrees.
epochs:   9%|██▍                        | 181/2001 [4:46:28<49:25:07, 97.75s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  181 : train loss: 3.5726, train psnr: 20.9020, val loss: 0.0001, val psnr: 20.5471          
epochs:   9%|██▍                        | 181/2001 [4:48:23<49:25:07, 97.75s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                       | 182/2001 [4:48:23<51:59:19, 102.89s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  182 : train loss: 3.1910, train psnr: 21.3201, val loss: 0.0001, val psnr: 20.5874          
epochs:   9%|██▎                       | 182/2001 [4:50:44<51:59:19, 102.89s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 183/2001 [4:50:44<57:48:36, 114.48s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  183 : train loss: 3.6767, train psnr: 20.7223, val loss: 0.0001, val psnr: 19.8030          
epochs:   9%|██▍                       | 183/2001 [4:52:20<57:48:36, 114.48s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 184/2001 [4:52:20<54:55:09, 108.81s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  184 : train loss: 3.3762, train psnr: 21.0693, val loss: 0.0001, val psnr: 20.6571          
epochs:   9%|██▍                       | 184/2001 [4:53:58<54:55:09, 108.81s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 185/2001 [4:53:58<53:13:25, 105.51s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  185 : train loss: 3.5520, train psnr: 20.8486, val loss: 0.0001, val psnr: 20.4891          
epochs:   9%|██▍                       | 185/2001 [4:55:57<53:13:25, 105.51s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 186/2001 [4:55:57<55:18:30, 109.70s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  186 : train loss: 3.4259, train psnr: 21.0596, val loss: 0.0001, val psnr: 20.8399          
epochs:   9%|██▍                       | 186/2001 [4:58:13<55:18:30, 109.70s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 187/2001 [4:58:13<59:17:09, 117.66s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
At epoch  187 : train loss: 3.1928, train psnr: 21.3345, val loss: 0.0001, val psnr: 19.9926          
epochs:   9%|██▍                       | 187/2001 [4:59:48<59:17:09, 117.66s/it]
Best val loss: 20.9799
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                       | 188/2001 [4:59:48<55:50:01, 110.87s/it]
Best val loss: 20.9799
 ==== Origional DFnet training in train_on_epoch==========
epochs:   9%|██▌                        | 188/2001 [5:00:51<48:21:24, 96.02s/it]
Traceback (most recent call last):
  File "train_pre_posenet_dso.py", line 173, in <module>
    train()
  File "train_pre_posenet_dso.py", line 140, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_pre_posenet.py", line 674, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, num_cycle, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 442, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 402, in train_on_batch
    loss.backward()
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/autograd/__init__.py", line 175, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Best val loss: 20.9799
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_pre_posenet_dso.py --config config_dfnetdm.txt --no_grad_update False --lrate 5e-10 
Command Line Args:   --config config_dfnetdm.txt --no_grad_update False --lrate 5e-10
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    ['2.', '5.', '10.']
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       True
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --learning_rate:   1e-05
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2

 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]

frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]

frame_idx_dso[0:4] =  [0 1 2 3]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg_from_file = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (1186, 3, 4)
pose_avg =  [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]]


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                          | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
At epoch    0 : train loss: 0.9553, train psnr: 19.8837, val loss: 0.0001, val psnr: 18.8091
epochs:   0%|                                          | 0/2001 [01:38<?, ?it/s]

 ============= self.val_on_psnr =  True
                      Median error 0.009730107616633177m and 0.870874434709549 degrees.l loss: 18.8091
Mean error 0.011362634082645299m and 0.9886680263158704 degrees.
epochs:   0%|                              | 1/2001 [01:43<57:45:10, 103.96s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch    1 : train loss: 0.9195, train psnr: 20.1735, val loss: 0.0001, val psnr: 19.5318          
epochs:   0%|                              | 1/2001 [03:20<57:45:10, 103.96s/it]
Best val loss: 18.8091
 ============= self.val_on_psnr =  True
epochs:   0%|                              | 2/2001 [03:21<56:34:22, 101.88s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    2 : train loss: 0.8818, train psnr: 20.1905, val loss: 0.0001, val psnr: 19.1979          
epochs:   0%|                              | 2/2001 [04:57<56:34:22, 101.88s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                              | 3/2001 [04:57<55:40:38, 100.32s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    3 : train loss: 0.9469, train psnr: 20.0162, val loss: 0.0001, val psnr: 18.7672          
epochs:   0%|                              | 3/2001 [06:32<55:40:38, 100.32s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 4/2001 [06:32<54:44:50, 98.69s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    4 : train loss: 1.0139, train psnr: 19.7763, val loss: 0.0001, val psnr: 19.3134          
epochs:   0%|                               | 4/2001 [08:07<54:44:50, 98.69s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 5/2001 [08:07<54:03:57, 97.51s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    5 : train loss: 0.8710, train psnr: 20.1456, val loss: 0.0001, val psnr: 19.4292          
epochs:   0%|                               | 5/2001 [09:42<54:03:57, 97.51s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 6/2001 [09:42<53:35:22, 96.70s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    6 : train loss: 0.9721, train psnr: 19.9262, val loss: 0.0001, val psnr: 18.6808          
epochs:   0%|                               | 6/2001 [11:16<53:35:22, 96.70s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 7/2001 [11:16<53:13:49, 96.10s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    7 : train loss: 0.8995, train psnr: 20.1302, val loss: 0.0001, val psnr: 18.9639          
epochs:   0%|                               | 7/2001 [12:51<53:13:49, 96.10s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|                               | 8/2001 [12:51<52:58:31, 95.69s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    8 : train loss: 0.9538, train psnr: 19.9316, val loss: 0.0001, val psnr: 19.3308          
epochs:   0%|                               | 8/2001 [14:26<52:58:31, 95.69s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|▏                              | 9/2001 [14:26<52:47:17, 95.40s/it]
Best val loss: 19.5318
 ==== Origional DFnet training in train_on_epoch==========
At epoch    9 : train loss: 0.8744, train psnr: 20.1939, val loss: 0.0001, val psnr: 19.7663          
epochs:   0%|▏                              | 9/2001 [16:01<52:47:17, 95.40s/it]
Best val loss: 19.5318
 ============= self.val_on_psnr =  True
epochs:   0%|▏                             | 10/2001 [16:01<52:41:07, 95.26s/it]
Best val loss: 19.7663
 ==== Origional DFnet training in train_on_epoch==========
At epoch   10 : train loss: 0.8575, train psnr: 20.4032, val loss: 0.0001, val psnr: 19.8115          
epochs:   0%|▏                             | 10/2001 [17:36<52:41:07, 95.26s/it]
Best val loss: 19.7663
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 11/2001 [17:36<52:36:30, 95.17s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   11 : train loss: 0.8933, train psnr: 20.2865, val loss: 0.0001, val psnr: 19.7276          
epochs:   1%|▏                             | 11/2001 [19:10<52:36:30, 95.17s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 12/2001 [19:10<52:29:19, 95.00s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   12 : train loss: 0.9234, train psnr: 20.0245, val loss: 0.0003, val psnr: 19.6653          
epochs:   1%|▏                             | 12/2001 [20:45<52:29:19, 95.00s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 13/2001 [20:45<52:25:10, 94.92s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   13 : train loss: 0.9377, train psnr: 20.1216, val loss: 0.0002, val psnr: 19.4581          
epochs:   1%|▏                             | 13/2001 [22:20<52:25:10, 94.92s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 14/2001 [22:20<52:20:24, 94.83s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   14 : train loss: 0.9460, train psnr: 19.9647, val loss: 0.0002, val psnr: 19.3786          
epochs:   1%|▏                             | 14/2001 [23:54<52:20:24, 94.83s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 15/2001 [23:54<52:17:42, 94.79s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   15 : train loss: 0.8705, train psnr: 20.4297, val loss: 0.0002, val psnr: 19.4079          
epochs:   1%|▏                             | 15/2001 [25:29<52:17:42, 94.79s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▏                             | 16/2001 [25:29<52:15:58, 94.79s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   16 : train loss: 0.8956, train psnr: 20.2571, val loss: 0.0002, val psnr: 18.7621          
epochs:   1%|▏                             | 16/2001 [27:04<52:15:58, 94.79s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 17/2001 [27:04<52:12:02, 94.72s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   17 : train loss: 0.9184, train psnr: 20.2407, val loss: 0.0002, val psnr: 18.7966          
epochs:   1%|▎                             | 17/2001 [28:38<52:12:02, 94.72s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 18/2001 [28:38<52:09:02, 94.68s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   18 : train loss: 0.8469, train psnr: 20.5315, val loss: 0.0002, val psnr: 19.7269          
epochs:   1%|▎                             | 18/2001 [30:13<52:09:02, 94.68s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 19/2001 [30:13<52:08:32, 94.71s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   19 : train loss: 0.9236, train psnr: 20.3559, val loss: 0.0001, val psnr: 19.7682          
epochs:   1%|▎                             | 19/2001 [31:48<52:08:32, 94.71s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 20/2001 [31:48<52:06:49, 94.70s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   20 : train loss: 0.9209, train psnr: 20.2048, val loss: 0.0001, val psnr: 19.1338          
epochs:   1%|▎                             | 20/2001 [33:22<52:06:49, 94.70s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
                      Median error 0.00927455397322774m and 0.801612377166748 degrees.al loss: 19.8115
Mean error 0.01183550591988966m and 1.0227866331756357 degrees.
epochs:   1%|▎                             | 21/2001 [33:27<52:54:07, 96.19s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   21 : train loss: 0.8506, train psnr: 20.3225, val loss: 0.0002, val psnr: 18.9781          
epochs:   1%|▎                             | 21/2001 [35:02<52:54:07, 96.19s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 22/2001 [35:02<52:37:34, 95.73s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   22 : train loss: 0.9895, train psnr: 19.8612, val loss: 0.0001, val psnr: 19.8081          
epochs:   1%|▎                             | 22/2001 [36:37<52:37:34, 95.73s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 23/2001 [36:37<52:25:28, 95.41s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   23 : train loss: 0.9252, train psnr: 20.0202, val loss: 0.0002, val psnr: 19.1626          
epochs:   1%|▎                             | 23/2001 [38:11<52:25:28, 95.41s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 24/2001 [38:11<52:14:24, 95.13s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   24 : train loss: 0.8372, train psnr: 20.4350, val loss: 0.0001, val psnr: 19.0279          
epochs:   1%|▎                             | 24/2001 [39:46<52:14:24, 95.13s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▎                             | 25/2001 [39:46<52:08:47, 95.00s/it]
Best val loss: 19.8115
 ==== Origional DFnet training in train_on_epoch==========
At epoch   25 : train loss: 0.8856, train psnr: 20.3678, val loss: 0.0001, val psnr: 20.1224          
epochs:   1%|▎                             | 25/2001 [41:21<52:08:47, 95.00s/it]
Best val loss: 19.8115
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 26/2001 [41:21<52:05:43, 94.96s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   26 : train loss: 0.9291, train psnr: 20.0979, val loss: 0.0001, val psnr: 19.4190          
epochs:   1%|▍                             | 26/2001 [42:55<52:05:43, 94.96s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 27/2001 [42:55<52:00:45, 94.86s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   27 : train loss: 0.8573, train psnr: 20.3141, val loss: 0.0001, val psnr: 19.8772          
epochs:   1%|▍                             | 27/2001 [44:30<52:00:45, 94.86s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 28/2001 [44:30<51:57:49, 94.81s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   28 : train loss: 0.8944, train psnr: 20.1450, val loss: 0.0001, val psnr: 18.4971          
epochs:   1%|▍                             | 28/2001 [46:05<51:57:49, 94.81s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 29/2001 [46:05<51:54:25, 94.76s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   29 : train loss: 0.8439, train psnr: 20.4745, val loss: 0.0001, val psnr: 19.8597          
epochs:   1%|▍                             | 29/2001 [47:40<51:54:25, 94.76s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   1%|▍                             | 30/2001 [47:40<51:53:12, 94.77s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   30 : train loss: 0.8414, train psnr: 20.4713, val loss: 0.0001, val psnr: 19.7253          
epochs:   1%|▍                             | 30/2001 [49:14<51:53:12, 94.77s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 31/2001 [49:14<51:50:40, 94.74s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   31 : train loss: 0.9817, train psnr: 19.7618, val loss: 0.0001, val psnr: 19.5227          
epochs:   2%|▍                             | 31/2001 [50:49<51:50:40, 94.74s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 32/2001 [50:49<51:50:54, 94.80s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   32 : train loss: 0.9509, train psnr: 19.9964, val loss: 0.0001, val psnr: 18.9193          
epochs:   2%|▍                             | 32/2001 [52:24<51:50:54, 94.80s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▍                             | 33/2001 [52:24<51:49:08, 94.79s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   33 : train loss: 0.8658, train psnr: 20.4552, val loss: 0.0001, val psnr: 19.6236          
epochs:   2%|▍                             | 33/2001 [53:59<51:49:08, 94.79s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 34/2001 [53:59<51:47:59, 94.80s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   34 : train loss: 0.8756, train psnr: 20.1329, val loss: 0.0001, val psnr: 19.4783          
epochs:   2%|▌                             | 34/2001 [55:34<51:47:59, 94.80s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 35/2001 [55:34<51:46:09, 94.80s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   35 : train loss: 0.9091, train psnr: 20.2580, val loss: 0.0002, val psnr: 19.4551          
epochs:   2%|▌                             | 35/2001 [57:08<51:46:09, 94.80s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 36/2001 [57:08<51:40:20, 94.67s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   36 : train loss: 0.8363, train psnr: 20.4655, val loss: 0.0001, val psnr: 19.7456          
epochs:   2%|▌                             | 36/2001 [58:43<51:40:20, 94.67s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                             | 37/2001 [58:43<51:40:13, 94.71s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   37 : train loss: 0.8746, train psnr: 20.3419, val loss: 0.0002, val psnr: 19.5321          
epochs:   2%|▌                           | 37/2001 [1:00:17<51:40:13, 94.71s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 38/2001 [1:00:17<51:36:23, 94.64s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   38 : train loss: 0.9041, train psnr: 20.2178, val loss: 0.0001, val psnr: 19.1131          
epochs:   2%|▌                           | 38/2001 [1:01:52<51:36:23, 94.64s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 39/2001 [1:01:52<51:37:02, 94.71s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   39 : train loss: 0.8678, train psnr: 20.3174, val loss: 0.0001, val psnr: 19.4244          
epochs:   2%|▌                           | 39/2001 [1:03:27<51:37:02, 94.71s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 40/2001 [1:03:27<51:35:52, 94.72s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   40 : train loss: 0.9134, train psnr: 20.2332, val loss: 0.0001, val psnr: 19.6390          
epochs:   2%|▌                           | 40/2001 [1:05:01<51:35:52, 94.72s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
                      Median error 0.009733086917549372m and 0.8369607329368591 degrees. loss: 20.1224
Mean error 0.0123032808552983m and 1.0353478520339439 degrees.
epochs:   2%|▌                           | 41/2001 [1:05:07<52:24:47, 96.27s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   41 : train loss: 0.8666, train psnr: 20.4764, val loss: 0.0001, val psnr: 18.9063          
epochs:   2%|▌                           | 41/2001 [1:06:41<52:24:47, 96.27s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 42/2001 [1:06:41<52:08:42, 95.83s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   42 : train loss: 0.8306, train psnr: 20.5292, val loss: 0.0001, val psnr: 19.8658          
epochs:   2%|▌                           | 42/2001 [1:08:16<52:08:42, 95.83s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 43/2001 [1:08:16<51:56:50, 95.51s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   43 : train loss: 0.8139, train psnr: 20.4713, val loss: 0.0001, val psnr: 18.6475          
epochs:   2%|▌                           | 43/2001 [1:09:51<51:56:50, 95.51s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▌                           | 44/2001 [1:09:51<51:49:02, 95.32s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   44 : train loss: 0.8640, train psnr: 20.4443, val loss: 0.0001, val psnr: 19.3031          
epochs:   2%|▌                           | 44/2001 [1:11:26<51:49:02, 95.32s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 45/2001 [1:11:26<51:40:09, 95.10s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   45 : train loss: 0.7878, train psnr: 20.6083, val loss: 0.0001, val psnr: 18.5337          
epochs:   2%|▋                           | 45/2001 [1:13:00<51:40:09, 95.10s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 46/2001 [1:13:00<51:33:44, 94.95s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   46 : train loss: 0.8765, train psnr: 20.3881, val loss: 0.0001, val psnr: 19.1581          
epochs:   2%|▋                           | 46/2001 [1:14:35<51:33:44, 94.95s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 47/2001 [1:14:35<51:31:26, 94.93s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   47 : train loss: 0.8249, train psnr: 20.5529, val loss: 0.0001, val psnr: 19.2074          
epochs:   2%|▋                           | 47/2001 [1:16:10<51:31:26, 94.93s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 48/2001 [1:16:10<51:29:08, 94.90s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   48 : train loss: 0.8494, train psnr: 20.4219, val loss: 0.0001, val psnr: 19.2569          
epochs:   2%|▋                           | 48/2001 [1:17:45<51:29:08, 94.90s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 49/2001 [1:17:45<51:28:06, 94.92s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   49 : train loss: 0.8795, train psnr: 20.2276, val loss: 0.0001, val psnr: 18.2044          
epochs:   2%|▋                           | 49/2001 [1:19:20<51:28:06, 94.92s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   2%|▋                           | 50/2001 [1:19:20<51:24:21, 94.85s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   50 : train loss: 0.8761, train psnr: 20.2668, val loss: 0.0001, val psnr: 19.1427          
epochs:   2%|▋                           | 50/2001 [1:20:55<51:24:21, 94.85s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 51/2001 [1:20:55<51:23:43, 94.88s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   51 : train loss: 0.8575, train psnr: 20.4608, val loss: 0.0002, val psnr: 19.2284          
epochs:   3%|▋                           | 51/2001 [1:22:30<51:23:43, 94.88s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 52/2001 [1:22:30<51:21:53, 94.88s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   52 : train loss: 0.8265, train psnr: 20.4455, val loss: 0.0001, val psnr: 19.3925          
epochs:   3%|▋                           | 52/2001 [1:24:04<51:21:53, 94.88s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▋                           | 53/2001 [1:24:04<51:18:44, 94.83s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   53 : train loss: 0.8423, train psnr: 20.4392, val loss: 0.0001, val psnr: 19.7184          
epochs:   3%|▋                           | 53/2001 [1:25:39<51:18:44, 94.83s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 54/2001 [1:25:39<51:15:36, 94.78s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   54 : train loss: 0.8611, train psnr: 20.2284, val loss: 0.0002, val psnr: 18.8937          
epochs:   3%|▊                           | 54/2001 [1:27:14<51:15:36, 94.78s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 55/2001 [1:27:14<51:12:35, 94.74s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   55 : train loss: 0.8276, train psnr: 20.5311, val loss: 0.0002, val psnr: 20.0251          
epochs:   3%|▊                           | 55/2001 [1:28:48<51:12:35, 94.74s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 56/2001 [1:28:48<51:09:30, 94.69s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   56 : train loss: 0.8551, train psnr: 20.3088, val loss: 0.0002, val psnr: 19.3340          
epochs:   3%|▊                           | 56/2001 [1:30:23<51:09:30, 94.69s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 57/2001 [1:30:23<51:05:35, 94.62s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   57 : train loss: 0.8519, train psnr: 20.6085, val loss: 0.0002, val psnr: 19.5289          
epochs:   3%|▊                           | 57/2001 [1:31:57<51:05:35, 94.62s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 58/2001 [1:31:57<51:03:24, 94.60s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   58 : train loss: 0.8791, train psnr: 20.3666, val loss: 0.0002, val psnr: 19.1364          
epochs:   3%|▊                           | 58/2001 [1:33:32<51:03:24, 94.60s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 59/2001 [1:33:32<50:59:58, 94.54s/it]
Best val loss: 20.1224
 ==== Origional DFnet training in train_on_epoch==========
At epoch   59 : train loss: 0.8520, train psnr: 20.4570, val loss: 0.0002, val psnr: 20.3763          
epochs:   3%|▊                           | 59/2001 [1:35:06<50:59:58, 94.54s/it]
Best val loss: 20.1224
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 60/2001 [1:35:06<50:58:42, 94.55s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   60 : train loss: 0.8226, train psnr: 20.5724, val loss: 0.0002, val psnr: 19.3685          
epochs:   3%|▊                           | 60/2001 [1:36:41<50:58:42, 94.55s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
                      Median error 0.010584239847958088m and 0.8540855646133423 degrees. loss: 20.3763
Mean error 0.013452370261198696m and 1.082259611758264 degrees.
epochs:   3%|▊                           | 61/2001 [1:36:46<51:49:04, 96.16s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   61 : train loss: 0.8168, train psnr: 20.5926, val loss: 0.0001, val psnr: 20.0027          
epochs:   3%|▊                           | 61/2001 [1:38:21<51:49:04, 96.16s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▊                           | 62/2001 [1:38:21<51:33:54, 95.74s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   62 : train loss: 0.7858, train psnr: 20.6718, val loss: 0.0001, val psnr: 19.7166          
epochs:   3%|▊                           | 62/2001 [1:39:55<51:33:54, 95.74s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 63/2001 [1:39:55<51:21:27, 95.40s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   63 : train loss: 0.8263, train psnr: 20.6703, val loss: 0.0001, val psnr: 19.1993          
epochs:   3%|▉                           | 63/2001 [1:41:30<51:21:27, 95.40s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 64/2001 [1:41:30<51:11:20, 95.14s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   64 : train loss: 0.8298, train psnr: 20.5554, val loss: 0.0001, val psnr: 19.0489          
epochs:   3%|▉                           | 64/2001 [1:43:05<51:11:20, 95.14s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 65/2001 [1:43:05<51:05:46, 95.01s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   65 : train loss: 0.8414, train psnr: 20.4723, val loss: 0.0002, val psnr: 19.0847          
epochs:   3%|▉                           | 65/2001 [1:44:39<51:05:46, 95.01s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 66/2001 [1:44:39<51:00:10, 94.89s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   66 : train loss: 0.8165, train psnr: 20.4871, val loss: 0.0001, val psnr: 18.5166          
epochs:   3%|▉                           | 66/2001 [1:46:14<51:00:10, 94.89s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 67/2001 [1:46:14<50:56:05, 94.81s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   67 : train loss: 0.9366, train psnr: 20.1048, val loss: 0.0001, val psnr: 19.8811          
epochs:   3%|▉                           | 67/2001 [1:47:49<50:56:05, 94.81s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 68/2001 [1:47:49<50:53:50, 94.79s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   68 : train loss: 0.7777, train psnr: 20.7600, val loss: 0.0001, val psnr: 19.7730          
epochs:   3%|▉                           | 68/2001 [1:49:23<50:53:50, 94.79s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 69/2001 [1:49:23<50:52:19, 94.79s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   69 : train loss: 0.7290, train psnr: 20.9961, val loss: 0.0001, val psnr: 19.6848          
epochs:   3%|▉                           | 69/2001 [1:50:58<50:52:19, 94.79s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   3%|▉                           | 70/2001 [1:50:58<50:50:12, 94.78s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   70 : train loss: 0.7567, train psnr: 20.8200, val loss: 0.0001, val psnr: 19.0045          
epochs:   3%|▉                           | 70/2001 [1:52:33<50:50:12, 94.78s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|▉                           | 71/2001 [1:52:33<50:44:55, 94.66s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   71 : train loss: 0.7816, train psnr: 20.7252, val loss: 0.0001, val psnr: 20.1537          
epochs:   4%|▉                           | 71/2001 [1:54:07<50:44:55, 94.66s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 72/2001 [1:54:07<50:42:40, 94.64s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   72 : train loss: 0.7864, train psnr: 20.7635, val loss: 0.0001, val psnr: 20.1370          
epochs:   4%|█                           | 72/2001 [1:55:42<50:42:40, 94.64s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 73/2001 [1:55:42<50:41:41, 94.66s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   73 : train loss: 0.8375, train psnr: 20.4554, val loss: 0.0001, val psnr: 20.2020          
epochs:   4%|█                           | 73/2001 [1:57:16<50:41:41, 94.66s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 74/2001 [1:57:16<50:38:17, 94.60s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   74 : train loss: 0.8337, train psnr: 20.3702, val loss: 0.0002, val psnr: 19.5952          
epochs:   4%|█                           | 74/2001 [1:58:51<50:38:17, 94.60s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 75/2001 [1:58:51<50:35:41, 94.57s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   75 : train loss: 0.8108, train psnr: 20.5481, val loss: 0.0001, val psnr: 19.0546          
epochs:   4%|█                           | 75/2001 [2:00:25<50:35:41, 94.57s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 76/2001 [2:00:25<50:32:12, 94.51s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   76 : train loss: 0.8813, train psnr: 20.2518, val loss: 0.0001, val psnr: 20.0062          
epochs:   4%|█                           | 76/2001 [2:02:00<50:32:12, 94.51s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 77/2001 [2:02:00<50:35:18, 94.66s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   77 : train loss: 0.8702, train psnr: 20.4366, val loss: 0.0001, val psnr: 19.8288          
epochs:   4%|█                           | 77/2001 [2:03:35<50:35:18, 94.66s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 78/2001 [2:03:35<50:33:02, 94.63s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   78 : train loss: 0.7775, train psnr: 20.7116, val loss: 0.0001, val psnr: 19.6437          
epochs:   4%|█                           | 78/2001 [2:05:09<50:33:02, 94.63s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 79/2001 [2:05:09<50:32:17, 94.66s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   79 : train loss: 0.7747, train psnr: 20.8878, val loss: 0.0001, val psnr: 19.8945          
epochs:   4%|█                           | 79/2001 [2:06:44<50:32:17, 94.66s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█                           | 80/2001 [2:06:44<50:30:03, 94.64s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   80 : train loss: 0.7843, train psnr: 20.7068, val loss: 0.0001, val psnr: 20.2394          
epochs:   4%|█                           | 80/2001 [2:08:19<50:30:03, 94.64s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
                      Median error 0.0077244003769010305m and 0.7605286836624146 degrees.loss: 20.3763
Mean error 0.009915638842137092m and 0.963464846333059 degrees.
epochs:   4%|█▏                          | 81/2001 [2:08:24<51:18:47, 96.21s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch   81 : train loss: 0.8865, train psnr: 20.2586, val loss: 0.0001, val psnr: 18.7262          
epochs:   4%|█▏                          | 81/2001 [2:09:59<51:18:47, 96.21s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 82/2001 [2:09:59<51:04:48, 95.83s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   82 : train loss: 0.7559, train psnr: 20.8759, val loss: 0.0001, val psnr: 19.6386          
epochs:   4%|█▏                          | 82/2001 [2:11:34<51:04:48, 95.83s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 83/2001 [2:11:34<50:52:52, 95.50s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   83 : train loss: 0.8198, train psnr: 20.4799, val loss: 0.0001, val psnr: 19.5903          
epochs:   4%|█▏                          | 83/2001 [2:13:08<50:52:52, 95.50s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 84/2001 [2:13:08<50:42:44, 95.23s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   84 : train loss: 0.8294, train psnr: 20.6000, val loss: 0.0001, val psnr: 19.5006          
epochs:   4%|█▏                          | 84/2001 [2:14:43<50:42:44, 95.23s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 85/2001 [2:14:43<50:35:09, 95.05s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   85 : train loss: 0.8113, train psnr: 20.5765, val loss: 0.0001, val psnr: 19.6506          
epochs:   4%|█▏                          | 85/2001 [2:16:17<50:35:09, 95.05s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 86/2001 [2:16:17<50:29:10, 94.91s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   86 : train loss: 0.7950, train psnr: 20.6440, val loss: 0.0001, val psnr: 19.9794          
epochs:   4%|█▏                          | 86/2001 [2:17:52<50:29:10, 94.91s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 87/2001 [2:17:52<50:25:15, 94.84s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   87 : train loss: 0.7581, train psnr: 20.7884, val loss: 0.0002, val psnr: 19.3096          
epochs:   4%|█▏                          | 87/2001 [2:19:27<50:25:15, 94.84s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 88/2001 [2:19:27<50:23:48, 94.84s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   88 : train loss: 0.8434, train psnr: 20.5345, val loss: 0.0001, val psnr: 19.3930          
epochs:   4%|█▏                          | 88/2001 [2:21:02<50:23:48, 94.84s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▏                          | 89/2001 [2:21:02<50:22:28, 94.85s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   89 : train loss: 0.7967, train psnr: 20.6809, val loss: 0.0001, val psnr: 19.1885          
epochs:   4%|█▏                          | 89/2001 [2:22:36<50:22:28, 94.85s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   4%|█▎                          | 90/2001 [2:22:36<50:18:39, 94.78s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   90 : train loss: 0.8269, train psnr: 20.5993, val loss: 0.0001, val psnr: 19.3249          
epochs:   4%|█▎                          | 90/2001 [2:24:11<50:18:39, 94.78s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 91/2001 [2:24:11<50:14:23, 94.69s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   91 : train loss: 0.8068, train psnr: 20.5933, val loss: 0.0001, val psnr: 19.1784          
epochs:   5%|█▎                          | 91/2001 [2:25:45<50:14:23, 94.69s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 92/2001 [2:25:45<50:10:46, 94.63s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   92 : train loss: 0.8214, train psnr: 20.5882, val loss: 0.0002, val psnr: 19.5170          
epochs:   5%|█▎                          | 92/2001 [2:27:20<50:10:46, 94.63s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 93/2001 [2:27:20<50:12:00, 94.72s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   93 : train loss: 0.7758, train psnr: 20.6196, val loss: 0.0001, val psnr: 19.1725          
epochs:   5%|█▎                          | 93/2001 [2:28:55<50:12:00, 94.72s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 94/2001 [2:28:55<50:08:21, 94.65s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   94 : train loss: 0.7740, train psnr: 20.7003, val loss: 0.0001, val psnr: 19.5774          
epochs:   5%|█▎                          | 94/2001 [2:30:30<50:08:21, 94.65s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 95/2001 [2:30:30<50:11:10, 94.79s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   95 : train loss: 0.8132, train psnr: 20.6742, val loss: 0.0002, val psnr: 18.9914          
epochs:   5%|█▎                          | 95/2001 [2:32:05<50:11:10, 94.79s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 96/2001 [2:32:05<50:10:14, 94.81s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   96 : train loss: 0.8800, train psnr: 20.4039, val loss: 0.0001, val psnr: 20.2575          
epochs:   5%|█▎                          | 96/2001 [2:33:39<50:10:14, 94.81s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 97/2001 [2:33:39<50:06:42, 94.75s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   97 : train loss: 0.7406, train psnr: 20.7911, val loss: 0.0001, val psnr: 19.0318          
epochs:   5%|█▎                          | 97/2001 [2:35:14<50:06:42, 94.75s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                          | 98/2001 [2:35:14<50:03:06, 94.69s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   98 : train loss: 0.8516, train psnr: 20.5429, val loss: 0.0001, val psnr: 19.5385          
epochs:   5%|█▎                          | 98/2001 [2:36:49<50:03:06, 94.69s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                          | 99/2001 [2:36:49<50:03:23, 94.74s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch   99 : train loss: 0.8112, train psnr: 20.5228, val loss: 0.0002, val psnr: 19.6880          
epochs:   5%|█▍                          | 99/2001 [2:38:24<50:03:23, 94.74s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▎                         | 100/2001 [2:38:24<50:01:40, 94.74s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch  100 : train loss: 0.8371, train psnr: 20.4502, val loss: 0.0001, val psnr: 20.1637          
epochs:   5%|█▎                         | 100/2001 [2:39:58<50:01:40, 94.74s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
                      Median error 0.008270169608294964m and 0.7687136232852936 degrees. loss: 20.3763
Mean error 0.010535133976584983m and 0.9638125180655163 degrees.
epochs:   5%|█▎                         | 101/2001 [2:40:03<50:46:49, 96.22s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  101 : train loss: 0.8021, train psnr: 20.5910, val loss: 0.0002, val psnr: 19.9017          
epochs:   5%|█▎                         | 101/2001 [2:41:38<50:46:49, 96.22s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 102/2001 [2:41:38<50:31:46, 95.79s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch  102 : train loss: 0.8075, train psnr: 20.7861, val loss: 0.0002, val psnr: 20.2846          
epochs:   5%|█▍                         | 102/2001 [2:43:13<50:31:46, 95.79s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 103/2001 [2:43:13<50:21:27, 95.51s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch  103 : train loss: 0.7763, train psnr: 20.8319, val loss: 0.0001, val psnr: 19.8594          
epochs:   5%|█▍                         | 103/2001 [2:44:47<50:21:27, 95.51s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 104/2001 [2:44:47<50:10:39, 95.22s/it]
Best val loss: 20.3763
 ==== Origional DFnet training in train_on_epoch==========
At epoch  104 : train loss: 0.7518, train psnr: 20.8308, val loss: 0.0001, val psnr: 20.4291          
epochs:   5%|█▍                         | 104/2001 [2:46:22<50:10:39, 95.22s/it]
Best val loss: 20.3763
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 105/2001 [2:46:22<50:03:31, 95.05s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  105 : train loss: 0.7702, train psnr: 20.7495, val loss: 0.0001, val psnr: 19.5637          
epochs:   5%|█▍                         | 105/2001 [2:47:57<50:03:31, 95.05s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 106/2001 [2:47:57<49:57:21, 94.90s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  106 : train loss: 0.8037, train psnr: 20.6118, val loss: 0.0001, val psnr: 19.6837          
epochs:   5%|█▍                         | 106/2001 [2:49:31<49:57:21, 94.90s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 107/2001 [2:49:31<49:53:01, 94.82s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  107 : train loss: 0.8308, train psnr: 20.7231, val loss: 0.0001, val psnr: 20.1027          
epochs:   5%|█▍                         | 107/2001 [2:51:06<49:53:01, 94.82s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 108/2001 [2:51:06<49:50:44, 94.79s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  108 : train loss: 0.7508, train psnr: 20.9434, val loss: 0.0001, val psnr: 19.9218          
epochs:   5%|█▍                         | 108/2001 [2:52:41<49:50:44, 94.79s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 109/2001 [2:52:41<49:52:03, 94.89s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  109 : train loss: 0.7994, train psnr: 20.7441, val loss: 0.0001, val psnr: 20.1331          
epochs:   5%|█▍                         | 109/2001 [2:54:16<49:52:03, 94.89s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   5%|█▍                         | 110/2001 [2:54:16<49:48:01, 94.81s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  110 : train loss: 0.7753, train psnr: 20.8514, val loss: 0.0001, val psnr: 19.7410          
epochs:   5%|█▍                         | 110/2001 [2:55:50<49:48:01, 94.81s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   6%|█▍                         | 111/2001 [2:55:50<49:43:44, 94.72s/it]
Best val loss: 20.4291
 ==== Origional DFnet training in train_on_epoch==========
At epoch  111 : train loss: 0.7861, train psnr: 20.7873, val loss: 0.0001, val psnr: 20.5075          
epochs:   6%|█▍                         | 111/2001 [2:57:25<49:43:44, 94.72s/it]
Best val loss: 20.4291
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 112/2001 [2:57:25<49:40:54, 94.68s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  112 : train loss: 0.8531, train psnr: 20.3828, val loss: 0.0001, val psnr: 19.6476          
epochs:   6%|█▌                         | 112/2001 [2:59:00<49:40:54, 94.68s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 113/2001 [2:59:00<49:40:10, 94.71s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  113 : train loss: 0.7923, train psnr: 20.5226, val loss: 0.0001, val psnr: 20.0268          
epochs:   6%|█▌                         | 113/2001 [3:00:34<49:40:10, 94.71s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 114/2001 [3:00:34<49:39:12, 94.73s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  114 : train loss: 0.7289, train psnr: 20.9905, val loss: 0.0001, val psnr: 20.2676          
epochs:   6%|█▌                         | 114/2001 [3:02:09<49:39:12, 94.73s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 115/2001 [3:02:09<49:35:12, 94.65s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  115 : train loss: 0.7917, train psnr: 20.7540, val loss: 0.0002, val psnr: 18.5015          
epochs:   6%|█▌                         | 115/2001 [3:03:43<49:35:12, 94.65s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 116/2001 [3:03:43<49:33:49, 94.66s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  116 : train loss: 0.7641, train psnr: 20.9001, val loss: 0.0001, val psnr: 19.5455          
epochs:   6%|█▌                         | 116/2001 [3:05:18<49:33:49, 94.66s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 117/2001 [3:05:18<49:31:51, 94.65s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  117 : train loss: 0.7438, train psnr: 20.9172, val loss: 0.0001, val psnr: 20.4931          
epochs:   6%|█▌                         | 117/2001 [3:06:53<49:31:51, 94.65s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 118/2001 [3:06:53<49:30:37, 94.66s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  118 : train loss: 0.7695, train psnr: 20.8143, val loss: 0.0001, val psnr: 20.1772          
epochs:   6%|█▌                         | 118/2001 [3:08:27<49:30:37, 94.66s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 119/2001 [3:08:27<49:29:23, 94.67s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  119 : train loss: 0.7485, train psnr: 20.8814, val loss: 0.0001, val psnr: 19.9114          
epochs:   6%|█▌                         | 119/2001 [3:10:02<49:29:23, 94.67s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▌                         | 120/2001 [3:10:02<49:24:54, 94.57s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  120 : train loss: 0.7902, train psnr: 20.7523, val loss: 0.0002, val psnr: 19.0417          
epochs:   6%|█▌                         | 120/2001 [3:11:37<49:24:54, 94.57s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
                      Median error 0.009349021129310131m and 0.8771430552005768 degrees. loss: 20.5075
Mean error 0.012214473280492464m and 1.0706016778764937 degrees.
epochs:   6%|█▋                         | 121/2001 [3:11:42<50:15:51, 96.25s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  121 : train loss: 0.8023, train psnr: 20.6860, val loss: 0.0001, val psnr: 19.1740          
epochs:   6%|█▋                         | 121/2001 [3:13:17<50:15:51, 96.25s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 122/2001 [3:13:17<49:59:53, 95.79s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  122 : train loss: 0.7831, train psnr: 20.6616, val loss: 0.0001, val psnr: 19.3849          
epochs:   6%|█▋                         | 122/2001 [3:14:51<49:59:53, 95.79s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 123/2001 [3:14:51<49:48:49, 95.49s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  123 : train loss: 0.7193, train psnr: 20.9760, val loss: 0.0001, val psnr: 19.6056          
epochs:   6%|█▋                         | 123/2001 [3:16:26<49:48:49, 95.49s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 124/2001 [3:16:26<49:39:06, 95.23s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  124 : train loss: 0.7485, train psnr: 21.0871, val loss: 0.0001, val psnr: 19.5764          
epochs:   6%|█▋                         | 124/2001 [3:18:01<49:39:06, 95.23s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 125/2001 [3:18:01<49:31:17, 95.03s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  125 : train loss: 0.7469, train psnr: 20.9253, val loss: 0.0001, val psnr: 19.5076          
epochs:   6%|█▋                         | 125/2001 [3:19:35<49:31:17, 95.03s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 126/2001 [3:19:35<49:26:55, 94.94s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  126 : train loss: 0.7528, train psnr: 20.8897, val loss: 0.0001, val psnr: 19.8455          
epochs:   6%|█▋                         | 126/2001 [3:21:10<49:26:55, 94.94s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 127/2001 [3:21:10<49:23:53, 94.89s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  127 : train loss: 0.7266, train psnr: 21.0671, val loss: 0.0001, val psnr: 20.4226          
epochs:   6%|█▋                         | 127/2001 [3:22:45<49:23:53, 94.89s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 128/2001 [3:22:45<49:21:50, 94.88s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  128 : train loss: 0.6963, train psnr: 20.9974, val loss: 0.0001, val psnr: 19.9662          
epochs:   6%|█▋                         | 128/2001 [3:24:20<49:21:50, 94.88s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▋                         | 129/2001 [3:24:20<49:18:07, 94.81s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  129 : train loss: 0.7006, train psnr: 21.1136, val loss: 0.0001, val psnr: 19.8822          
epochs:   6%|█▋                         | 129/2001 [3:25:54<49:18:07, 94.81s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   6%|█▊                         | 130/2001 [3:25:54<49:14:54, 94.76s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  130 : train loss: 0.7311, train psnr: 21.0167, val loss: 0.0001, val psnr: 19.1855          
epochs:   6%|█▊                         | 130/2001 [3:27:29<49:14:54, 94.76s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 131/2001 [3:27:29<49:12:49, 94.74s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  131 : train loss: 0.7443, train psnr: 21.0398, val loss: 0.0001, val psnr: 18.9618          
epochs:   7%|█▊                         | 131/2001 [3:29:04<49:12:49, 94.74s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 132/2001 [3:29:04<49:11:53, 94.76s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  132 : train loss: 0.8073, train psnr: 20.6994, val loss: 0.0001, val psnr: 19.5694          
epochs:   7%|█▊                         | 132/2001 [3:30:39<49:11:53, 94.76s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 133/2001 [3:30:39<49:13:09, 94.86s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  133 : train loss: 0.7741, train psnr: 20.7153, val loss: 0.0001, val psnr: 19.4642          
epochs:   7%|█▊                         | 133/2001 [3:32:14<49:13:09, 94.86s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 134/2001 [3:32:14<49:11:20, 94.85s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  134 : train loss: 0.7391, train psnr: 20.9432, val loss: 0.0001, val psnr: 19.5662          
epochs:   7%|█▊                         | 134/2001 [3:33:48<49:11:20, 94.85s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 135/2001 [3:33:48<49:08:35, 94.81s/it]
Best val loss: 20.5075
 ==== Origional DFnet training in train_on_epoch==========
At epoch  135 : train loss: 0.7424, train psnr: 20.9667, val loss: 0.0001, val psnr: 20.5554          
epochs:   7%|█▊                         | 135/2001 [3:35:24<49:08:35, 94.81s/it]
Best val loss: 20.5075
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 136/2001 [3:35:24<49:09:44, 94.90s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  136 : train loss: 0.7028, train psnr: 20.9529, val loss: 0.0001, val psnr: 19.9433          
epochs:   7%|█▊                         | 136/2001 [3:36:58<49:09:44, 94.90s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 137/2001 [3:36:58<49:07:15, 94.87s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  137 : train loss: 0.7638, train psnr: 20.7887, val loss: 0.0001, val psnr: 19.7638          
epochs:   7%|█▊                         | 137/2001 [3:38:33<49:07:15, 94.87s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▊                         | 138/2001 [3:38:33<49:04:57, 94.85s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  138 : train loss: 0.8033, train psnr: 20.7007, val loss: 0.0001, val psnr: 19.9040          
epochs:   7%|█▊                         | 138/2001 [3:40:08<49:04:57, 94.85s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 139/2001 [3:40:08<49:04:08, 94.87s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  139 : train loss: 0.6916, train psnr: 21.2086, val loss: 0.0002, val psnr: 19.7173          
epochs:   7%|█▉                         | 139/2001 [3:41:43<49:04:08, 94.87s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 140/2001 [3:41:43<49:00:06, 94.79s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  140 : train loss: 0.7759, train psnr: 20.6343, val loss: 0.0001, val psnr: 18.5580          
epochs:   7%|█▉                         | 140/2001 [3:43:17<49:00:06, 94.79s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
                      Median error 0.011090971995145082m and 0.6954837441444397 degrees. loss: 20.5554
Mean error 0.013191153910348044m and 0.8846705772683989 degrees.
epochs:   7%|█▉                         | 141/2001 [3:43:23<49:46:44, 96.35s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  141 : train loss: 0.7447, train psnr: 20.9257, val loss: 0.0001, val psnr: 20.2188          
epochs:   7%|█▉                         | 141/2001 [3:44:57<49:46:44, 96.35s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 142/2001 [3:44:57<49:29:22, 95.84s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  142 : train loss: 0.7851, train psnr: 20.7705, val loss: 0.0001, val psnr: 19.9087          
epochs:   7%|█▉                         | 142/2001 [3:46:32<49:29:22, 95.84s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 143/2001 [3:46:32<49:18:19, 95.53s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  143 : train loss: 0.7635, train psnr: 20.9656, val loss: 0.0001, val psnr: 20.4740          
epochs:   7%|█▉                         | 143/2001 [3:48:07<49:18:19, 95.53s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 144/2001 [3:48:07<49:09:39, 95.30s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  144 : train loss: 0.7432, train psnr: 20.9034, val loss: 0.0001, val psnr: 19.6407          
epochs:   7%|█▉                         | 144/2001 [3:49:42<49:09:39, 95.30s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 145/2001 [3:49:42<49:03:23, 95.15s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  145 : train loss: 0.7278, train psnr: 21.0631, val loss: 0.0001, val psnr: 20.5452          
epochs:   7%|█▉                         | 145/2001 [3:51:17<49:03:23, 95.15s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 146/2001 [3:51:17<48:58:30, 95.05s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  146 : train loss: 0.8004, train psnr: 20.5097, val loss: 0.0001, val psnr: 19.7620          
epochs:   7%|█▉                         | 146/2001 [3:52:51<48:58:30, 95.05s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 147/2001 [3:52:51<48:54:53, 94.98s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  147 : train loss: 0.7119, train psnr: 21.1242, val loss: 0.0001, val psnr: 20.3674          
epochs:   7%|█▉                         | 147/2001 [3:54:26<48:54:53, 94.98s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|█▉                         | 148/2001 [3:54:26<48:50:25, 94.89s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  148 : train loss: 0.7449, train psnr: 20.8782, val loss: 0.0001, val psnr: 19.1462          
epochs:   7%|█▉                         | 148/2001 [3:56:01<48:50:25, 94.89s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|██                         | 149/2001 [3:56:01<48:48:13, 94.87s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  149 : train loss: 0.7840, train psnr: 20.7098, val loss: 0.0001, val psnr: 19.8015          
epochs:   7%|██                         | 149/2001 [3:57:36<48:48:13, 94.87s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   7%|██                         | 150/2001 [3:57:36<48:47:17, 94.89s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  150 : train loss: 0.6999, train psnr: 21.1989, val loss: 0.0001, val psnr: 20.3666          
epochs:   7%|██                         | 150/2001 [3:59:10<48:47:17, 94.89s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 151/2001 [3:59:10<48:43:55, 94.83s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  151 : train loss: 0.7540, train psnr: 20.8747, val loss: 0.0001, val psnr: 19.7196          
epochs:   8%|██                         | 151/2001 [4:00:45<48:43:55, 94.83s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 152/2001 [4:00:45<48:41:32, 94.80s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  152 : train loss: 0.7228, train psnr: 21.0453, val loss: 0.0001, val psnr: 19.8193          
epochs:   8%|██                         | 152/2001 [4:02:20<48:41:32, 94.80s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 153/2001 [4:02:20<48:39:20, 94.78s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  153 : train loss: 0.7636, train psnr: 20.8487, val loss: 0.0001, val psnr: 20.1698          
epochs:   8%|██                         | 153/2001 [4:03:55<48:39:20, 94.78s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 154/2001 [4:03:55<48:36:22, 94.74s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  154 : train loss: 0.8020, train psnr: 20.7555, val loss: 0.0001, val psnr: 20.3516          
epochs:   8%|██                         | 154/2001 [4:05:29<48:36:22, 94.74s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 155/2001 [4:05:29<48:36:18, 94.79s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  155 : train loss: 0.6868, train psnr: 21.2659, val loss: 0.0001, val psnr: 20.3540          
epochs:   8%|██                         | 155/2001 [4:07:04<48:36:18, 94.79s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 156/2001 [4:07:04<48:32:11, 94.71s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  156 : train loss: 0.7984, train psnr: 20.7643, val loss: 0.0001, val psnr: 20.0497          
epochs:   8%|██                         | 156/2001 [4:08:39<48:32:11, 94.71s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██                         | 157/2001 [4:08:39<48:29:13, 94.66s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  157 : train loss: 0.7509, train psnr: 20.7673, val loss: 0.0001, val psnr: 19.9594          
epochs:   8%|██                         | 157/2001 [4:10:13<48:29:13, 94.66s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 158/2001 [4:10:13<48:29:42, 94.73s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  158 : train loss: 0.7333, train psnr: 20.9683, val loss: 0.0002, val psnr: 18.9376          
epochs:   8%|██▏                        | 158/2001 [4:11:48<48:29:42, 94.73s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 159/2001 [4:11:48<48:29:25, 94.77s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  159 : train loss: 0.7768, train psnr: 20.6837, val loss: 0.0001, val psnr: 20.5173          
epochs:   8%|██▏                        | 159/2001 [4:13:23<48:29:25, 94.77s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 160/2001 [4:13:23<48:26:40, 94.73s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  160 : train loss: 0.7185, train psnr: 21.0771, val loss: 0.0001, val psnr: 20.0519          
epochs:   8%|██▏                        | 160/2001 [4:14:58<48:26:40, 94.73s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
                      Median error 0.0076321635860949755m and 0.7273890376091003 degrees.loss: 20.5554
Mean error 0.010211062752573396m and 0.9182356987902631 degrees.
epochs:   8%|██▏                        | 161/2001 [4:15:03<49:12:14, 96.27s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  161 : train loss: 0.6536, train psnr: 21.2778, val loss: 0.0001, val psnr: 19.7180          
epochs:   8%|██▏                        | 161/2001 [4:16:37<49:12:14, 96.27s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 162/2001 [4:16:37<48:55:41, 95.78s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  162 : train loss: 0.6967, train psnr: 21.0670, val loss: 0.0001, val psnr: 20.1432          
epochs:   8%|██▏                        | 162/2001 [4:18:12<48:55:41, 95.78s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 163/2001 [4:18:12<48:44:19, 95.46s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  163 : train loss: 0.7434, train psnr: 20.9958, val loss: 0.0001, val psnr: 19.5378          
epochs:   8%|██▏                        | 163/2001 [4:19:47<48:44:19, 95.46s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 164/2001 [4:19:47<48:36:33, 95.26s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  164 : train loss: 0.7884, train psnr: 20.7366, val loss: 0.0001, val psnr: 20.0636          
epochs:   8%|██▏                        | 164/2001 [4:21:22<48:36:33, 95.26s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 165/2001 [4:21:22<48:30:24, 95.11s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  165 : train loss: 0.6936, train psnr: 21.2004, val loss: 0.0001, val psnr: 20.3889          
epochs:   8%|██▏                        | 165/2001 [4:22:56<48:30:24, 95.11s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▏                        | 166/2001 [4:22:56<48:25:37, 95.01s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  166 : train loss: 0.7838, train psnr: 20.6772, val loss: 0.0001, val psnr: 19.9000          
epochs:   8%|██▏                        | 166/2001 [4:24:31<48:25:37, 95.01s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 167/2001 [4:24:31<48:21:07, 94.91s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  167 : train loss: 0.7500, train psnr: 20.8449, val loss: 0.0001, val psnr: 20.3264          
epochs:   8%|██▎                        | 167/2001 [4:26:06<48:21:07, 94.91s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 168/2001 [4:26:06<48:17:38, 94.85s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  168 : train loss: 0.7279, train psnr: 21.0131, val loss: 0.0001, val psnr: 20.1762          
epochs:   8%|██▎                        | 168/2001 [4:27:41<48:17:38, 94.85s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 169/2001 [4:27:41<48:15:04, 94.82s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  169 : train loss: 0.6915, train psnr: 21.1998, val loss: 0.0001, val psnr: 20.3209          
epochs:   8%|██▎                        | 169/2001 [4:29:15<48:15:04, 94.82s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   8%|██▎                        | 170/2001 [4:29:15<48:13:13, 94.81s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  170 : train loss: 0.7724, train psnr: 20.8978, val loss: 0.0001, val psnr: 20.1604          
epochs:   8%|██▎                        | 170/2001 [4:30:50<48:13:13, 94.81s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 171/2001 [4:30:50<48:10:45, 94.78s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  171 : train loss: 0.7356, train psnr: 20.8710, val loss: 0.0001, val psnr: 20.3165          
epochs:   9%|██▎                        | 171/2001 [4:32:25<48:10:45, 94.78s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 172/2001 [4:32:25<48:07:50, 94.73s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  172 : train loss: 0.7522, train psnr: 20.8895, val loss: 0.0001, val psnr: 19.4108          
epochs:   9%|██▎                        | 172/2001 [4:33:59<48:07:50, 94.73s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 173/2001 [4:33:59<48:06:18, 94.74s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  173 : train loss: 0.7841, train psnr: 20.6944, val loss: 0.0001, val psnr: 20.0601          
epochs:   9%|██▎                        | 173/2001 [4:35:34<48:06:18, 94.74s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 174/2001 [4:35:34<48:03:37, 94.70s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  174 : train loss: 0.7363, train psnr: 20.9976, val loss: 0.0001, val psnr: 19.8066          
epochs:   9%|██▎                        | 174/2001 [4:37:09<48:03:37, 94.70s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 175/2001 [4:37:09<48:01:52, 94.69s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  175 : train loss: 0.6990, train psnr: 21.1921, val loss: 0.0001, val psnr: 20.0501          
epochs:   9%|██▎                        | 175/2001 [4:38:44<48:01:52, 94.69s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▎                        | 176/2001 [4:38:44<48:01:31, 94.74s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  176 : train loss: 0.7034, train psnr: 21.1687, val loss: 0.0002, val psnr: 20.2597          
epochs:   9%|██▎                        | 176/2001 [4:40:18<48:01:31, 94.74s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 177/2001 [4:40:18<47:58:43, 94.70s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  177 : train loss: 0.6555, train psnr: 21.4397, val loss: 0.0001, val psnr: 20.3424          
epochs:   9%|██▍                        | 177/2001 [4:41:53<47:58:43, 94.70s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 178/2001 [4:41:53<47:55:52, 94.65s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  178 : train loss: 0.7335, train psnr: 21.0732, val loss: 0.0001, val psnr: 20.5446          
epochs:   9%|██▍                        | 178/2001 [4:43:28<47:55:52, 94.65s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 179/2001 [4:43:28<47:57:02, 94.74s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  179 : train loss: 0.7557, train psnr: 21.0472, val loss: 0.0001, val psnr: 19.6020          
epochs:   9%|██▍                        | 179/2001 [4:45:02<47:57:02, 94.74s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 180/2001 [4:45:02<47:54:23, 94.71s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  180 : train loss: 0.8143, train psnr: 20.7191, val loss: 0.0001, val psnr: 20.4276          
epochs:   9%|██▍                        | 180/2001 [4:46:37<47:54:23, 94.71s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
                      Median error 0.007668058853596449m and 0.8499521315097809 degrees. loss: 20.5554
Mean error 0.0099915323225425m and 1.053489494495667 degrees.
epochs:   9%|██▍                        | 181/2001 [4:46:43<48:42:31, 96.35s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  181 : train loss: 0.6989, train psnr: 21.0828, val loss: 0.0001, val psnr: 20.0449          
epochs:   9%|██▍                        | 181/2001 [4:48:17<48:42:31, 96.35s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 182/2001 [4:48:17<48:25:18, 95.83s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  182 : train loss: 0.7062, train psnr: 21.0671, val loss: 0.0001, val psnr: 20.2832          
epochs:   9%|██▍                        | 182/2001 [4:49:52<48:25:18, 95.83s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 183/2001 [4:49:52<48:12:08, 95.45s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  183 : train loss: 0.7193, train psnr: 21.0840, val loss: 0.0001, val psnr: 19.8651          
epochs:   9%|██▍                        | 183/2001 [4:51:26<48:12:08, 95.45s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 184/2001 [4:51:26<48:02:27, 95.18s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  184 : train loss: 0.6774, train psnr: 21.1814, val loss: 0.0001, val psnr: 19.6983          
epochs:   9%|██▍                        | 184/2001 [4:53:01<48:02:27, 95.18s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▍                        | 185/2001 [4:53:01<47:59:13, 95.13s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  185 : train loss: 0.7444, train psnr: 20.9916, val loss: 0.0001, val psnr: 20.3528          
epochs:   9%|██▍                        | 185/2001 [4:54:36<47:59:13, 95.13s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▌                        | 186/2001 [4:54:36<47:53:36, 95.00s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  186 : train loss: 0.7770, train psnr: 20.8529, val loss: 0.0001, val psnr: 20.4872          
epochs:   9%|██▌                        | 186/2001 [4:56:11<47:53:36, 95.00s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▌                        | 187/2001 [4:56:11<47:50:07, 94.93s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  187 : train loss: 0.6982, train psnr: 21.2689, val loss: 0.0001, val psnr: 19.9272          
epochs:   9%|██▌                        | 187/2001 [4:57:45<47:50:07, 94.93s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▌                        | 188/2001 [4:57:45<47:45:36, 94.84s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  188 : train loss: 0.7309, train psnr: 21.0317, val loss: 0.0001, val psnr: 20.4895          
epochs:   9%|██▌                        | 188/2001 [4:59:20<47:45:36, 94.84s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▌                        | 189/2001 [4:59:20<47:43:08, 94.81s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  189 : train loss: 0.7527, train psnr: 20.9487, val loss: 0.0001, val psnr: 19.6197          
epochs:   9%|██▌                        | 189/2001 [5:00:55<47:43:08, 94.81s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:   9%|██▌                        | 190/2001 [5:00:55<47:40:49, 94.78s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  190 : train loss: 0.7076, train psnr: 21.0486, val loss: 0.0001, val psnr: 20.2472          
epochs:   9%|██▌                        | 190/2001 [5:02:30<47:40:49, 94.78s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▌                        | 191/2001 [5:02:30<47:40:27, 94.82s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  191 : train loss: 0.6795, train psnr: 21.0163, val loss: 0.0001, val psnr: 19.6605          
epochs:  10%|██▌                        | 191/2001 [5:04:04<47:40:27, 94.82s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▌                        | 192/2001 [5:04:04<47:37:01, 94.76s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  192 : train loss: 0.7647, train psnr: 20.7473, val loss: 0.0001, val psnr: 20.1959          
epochs:  10%|██▌                        | 192/2001 [5:05:39<47:37:01, 94.76s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▌                        | 193/2001 [5:05:39<47:36:24, 94.79s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  193 : train loss: 0.7510, train psnr: 21.0646, val loss: 0.0001, val psnr: 19.4919          
epochs:  10%|██▌                        | 193/2001 [5:07:14<47:36:24, 94.79s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▌                        | 194/2001 [5:07:14<47:36:21, 94.84s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  194 : train loss: 0.6693, train psnr: 21.2625, val loss: 0.0001, val psnr: 19.7724          
epochs:  10%|██▌                        | 194/2001 [5:08:49<47:36:21, 94.84s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 195/2001 [5:08:49<47:35:30, 94.87s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  195 : train loss: 0.6940, train psnr: 21.1898, val loss: 0.0001, val psnr: 20.3274          
epochs:  10%|██▋                        | 195/2001 [5:10:24<47:35:30, 94.87s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 196/2001 [5:10:24<47:33:43, 94.86s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  196 : train loss: 0.6811, train psnr: 21.2599, val loss: 0.0001, val psnr: 20.2823          
epochs:  10%|██▋                        | 196/2001 [5:11:59<47:33:43, 94.86s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 197/2001 [5:11:59<47:31:01, 94.82s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  197 : train loss: 0.7155, train psnr: 21.1244, val loss: 0.0001, val psnr: 19.5205          
epochs:  10%|██▋                        | 197/2001 [5:13:33<47:31:01, 94.82s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 198/2001 [5:13:33<47:27:52, 94.77s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  198 : train loss: 0.6121, train psnr: 21.6497, val loss: 0.0001, val psnr: 20.3729          
epochs:  10%|██▋                        | 198/2001 [5:15:08<47:27:52, 94.77s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 199/2001 [5:15:08<47:26:10, 94.77s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  199 : train loss: 0.6821, train psnr: 21.3383, val loss: 0.0001, val psnr: 20.4345          
epochs:  10%|██▋                        | 199/2001 [5:16:43<47:26:10, 94.77s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 200/2001 [5:16:43<47:24:19, 94.76s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  200 : train loss: 0.6515, train psnr: 21.5119, val loss: 0.0001, val psnr: 19.9844          
epochs:  10%|██▋                        | 200/2001 [5:18:17<47:24:19, 94.76s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
                      Median error 0.007616433082148433m and 0.7548466622829437 degrees. loss: 20.5554
Mean error 0.010173527535010102m and 0.9312002668534274 degrees.
epochs:  10%|██▋                        | 201/2001 [5:18:23<48:09:10, 96.31s/it]

 ==== Origional DFnet training in train_on_epoch==========
At epoch  201 : train loss: 0.6638, train psnr: 21.3903, val loss: 0.0001, val psnr: 19.4603          
epochs:  10%|██▋                        | 201/2001 [5:19:58<48:09:10, 96.31s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 202/2001 [5:19:58<47:54:13, 95.86s/it]
Best val loss: 20.5554
 ==== Origional DFnet training in train_on_epoch==========
At epoch  202 : train loss: 0.6457, train psnr: 21.4648, val loss: 0.0001, val psnr: 20.6088          
epochs:  10%|██▋                        | 202/2001 [5:21:32<47:54:13, 95.86s/it]
Best val loss: 20.5554
 ============= self.val_on_psnr =  True
epochs:  10%|██▋                        | 203/2001 [5:21:32<47:41:18, 95.48s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  203 : train loss: 0.7641, train psnr: 21.1282, val loss: 0.0001, val psnr: 19.9737          
epochs:  10%|██▋                        | 203/2001 [5:23:07<47:41:18, 95.48s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 204/2001 [5:23:07<47:32:55, 95.26s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  204 : train loss: 0.6411, train psnr: 21.4488, val loss: 0.0001, val psnr: 20.2811          
epochs:  10%|██▊                        | 204/2001 [5:24:42<47:32:55, 95.26s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 205/2001 [5:24:42<47:27:30, 95.13s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  205 : train loss: 0.6573, train psnr: 21.3957, val loss: 0.0001, val psnr: 20.0938          
epochs:  10%|██▊                        | 205/2001 [5:26:16<47:27:30, 95.13s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 206/2001 [5:26:16<47:22:19, 95.01s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  206 : train loss: 0.7301, train psnr: 21.0704, val loss: 0.0001, val psnr: 20.0925          
epochs:  10%|██▊                        | 206/2001 [5:27:51<47:22:19, 95.01s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 207/2001 [5:27:51<47:18:58, 94.95s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  207 : train loss: 0.7049, train psnr: 21.0451, val loss: 0.0001, val psnr: 19.8656          
epochs:  10%|██▊                        | 207/2001 [5:29:26<47:18:58, 94.95s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 208/2001 [5:29:26<47:19:15, 95.01s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  208 : train loss: 0.7621, train psnr: 20.8578, val loss: 0.0001, val psnr: 20.2197          
epochs:  10%|██▊                        | 208/2001 [5:31:01<47:19:15, 95.01s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 209/2001 [5:31:01<47:14:55, 94.92s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  209 : train loss: 0.6854, train psnr: 21.1516, val loss: 0.0001, val psnr: 20.1034          
epochs:  10%|██▊                        | 209/2001 [5:32:36<47:14:55, 94.92s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  10%|██▊                        | 210/2001 [5:32:36<47:12:59, 94.91s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  210 : train loss: 0.8380, train psnr: 20.5303, val loss: 0.0001, val psnr: 19.7561          
epochs:  10%|██▊                        | 210/2001 [5:34:11<47:12:59, 94.91s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  11%|██▊                        | 211/2001 [5:34:11<47:09:45, 94.85s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  211 : train loss: 0.7552, train psnr: 20.9085, val loss: 0.0001, val psnr: 20.0918          
epochs:  11%|██▊                        | 211/2001 [5:35:46<47:09:45, 94.85s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  11%|██▊                        | 212/2001 [5:35:46<47:07:59, 94.85s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  212 : train loss: 0.7289, train psnr: 20.9287, val loss: 0.0001, val psnr: 20.6072          
epochs:  11%|██▊                        | 212/2001 [5:37:20<47:07:59, 94.85s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  11%|██▊                        | 213/2001 [5:37:20<47:04:06, 94.77s/it]
Best val loss: 20.6088
 ==== Origional DFnet training in train_on_epoch==========
At epoch  213 : train loss: 0.6248, train psnr: 21.5786, val loss: 0.0001, val psnr: 20.8236          
epochs:  11%|██▊                        | 213/2001 [5:38:55<47:04:06, 94.77s/it]
Best val loss: 20.6088
 ============= self.val_on_psnr =  True
epochs:  11%|██▉                        | 214/2001 [5:38:55<47:04:00, 94.82s/it]
Best val loss: 20.8236
 ==== Origional DFnet training in train_on_epoch==========
At epoch  214 : train loss: 0.6591, train psnr: 21.5180, val loss: 0.0001, val psnr: 19.9030          
epochs:  11%|██▉                        | 214/2001 [5:40:30<47:04:00, 94.82s/it]
Best val loss: 20.8236
 ============= self.val_on_psnr =  True
epochs:  11%|██▉                        | 215/2001 [5:40:30<47:01:28, 94.79s/it]
Best val loss: 20.8236
 ==== Origional DFnet training in train_on_epoch==========
At epoch  215 : train loss: 0.7631, train psnr: 20.8456, val loss: 0.0001, val psnr: 20.2861          
epochs:  11%|██▉                        | 215/2001 [5:42:05<47:01:28, 94.79s/it]
Best val loss: 20.8236
 ============= self.val_on_psnr =  True
epochs:  11%|██▉                        | 216/2001 [5:42:05<46:59:32, 94.77s/it]
Best val loss: 20.8236
 ==== Origional DFnet training in train_on_epoch==========
At epoch  216 : train loss: 0.7094, train psnr: 21.1535, val loss: 0.0001, val psnr: 20.6005          
epochs:  11%|██▉                        | 216/2001 [5:43:41<46:59:32, 94.77s/it]
Best val loss: 20.8236
 ============= self.val_on_psnr =  True
epochs:  11%|██▉                        | 217/2001 [5:43:41<47:11:24, 95.23s/it]
Best val loss: 20.8236
 ==== Origional DFnet training in train_on_epoch==========
At epoch  217 : train loss: 0.6331, train psnr: 21.4679, val loss: 0.0001, val psnr: 19.9523          
epochs:  11%|██▉                        | 217/2001 [5:45:23<47:11:24, 95.23s/it]
Best val loss: 20.8236
 ============= self.val_on_psnr =  True
epochs:  11%|██▉                        | 218/2001 [5:45:23<48:15:40, 97.44s/it]
Best val loss: 20.8236
 ==== Origional DFnet training in train_on_epoch==========
^CCould not load image ./data/7Scenes/heads/seq-01/frame-000869.color.png, unexpected error
epochs:  11%|██▉                        | 218/2001 [5:47:43<47:23:59, 95.70s/it]
Traceback (most recent call last):
  File "train_pre_posenet_dso.py", line 173, in <module>
    train()
  File "train_pre_posenet_dso.py", line 140, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_pre_posenet.py", line 677, in train_feature_matching
    val_loss, val_psnr = eval_on_epoch(args, data_loaders, model, feat_model, hwf, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 245, in eval_on_epoch
    loss, psnr = eval_on_batch(args, data, model, feat_model, pose, img_idx, hwf, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 209, in eval_on_batch
    batch_rays, target = prepare_batch_render(args, pose_nerf, batch_size, data, H, W, focal, half_res)
  File "./feature/direct_feature_matching_pre_posenet.py", line 186, in prepare_batch_render
    rays_rgb = rays_rgb[torch.randperm(rays_rgb.shape[0])]
KeyboardInterrupt
Best val loss: 20.8236
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_pre_posenet_dso.py --config config_dfnetdm.txt --no_grad_update False --lrate 5e-12
Command Line Args:   --config config_dfnetdm.txt --no_grad_update False --lrate 5e-12
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/exp2023060701/checkpoint-0132-19.9465.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    ['2.', '5.', '10.']
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       True
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --learning_rate:   1e-05
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2

 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]



 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  198
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]



 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg_from_file = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (1186, 3, 4)
pose_avg =  [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]]


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                          | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
epochs:   0%|                                          | 0/2001 [00:14<?, ?it/s]
Traceback (most recent call last):
  File "train_pre_posenet_dso.py", line 173, in <module>
    train()
  File "train_pre_posenet_dso.py", line 140, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_pre_posenet.py", line 674, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, num_cycle, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 442, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_pre_posenet.py", line 356, in train_on_batch
    rgb, disp, acc, extras = render(H//4, W//4, focal/4, chunk=args.chunk, c2w=pose_nerf[0,:3,:4], img_idx=img_idx, **render_kwargs_test)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 392, in render
    all_ret = batchify_rays(rays, chunk, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 344, in batchify_rays
    ret = render_rays(rays_flat[i:i+chunk], **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 292, in render_rays
    raw = network_query_fn(pts, viewdirs, None, network_fn, 'coarse', None, None, False, test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 434, in <lambda>
    test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 42, in run_network_NeRFW
    embedded_inputs = [embed_fn(inputs_flat[i: i+netchunk])]
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 216, in <lambda>
    embed = lambda x, eo=embedder_obj : eo.embed(x)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 130, in embed
    ret = torch.cat([fn(inputs) for fn in self.embed_fns], -1) # cos, sin embedding
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 130, in <listcomp>
    ret = torch.cat([fn(inputs) for fn in self.embed_fns], -1) # cos, sin embedding
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 123, in <lambda>
    embed_fns.append(lambda x, p_fn=p_fn, freq=freq : p_fn(x * freq))
KeyboardInterrupt

(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ 
