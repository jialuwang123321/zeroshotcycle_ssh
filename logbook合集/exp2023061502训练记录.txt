                  | 131/2001 [3:49:39<54:08:44, 104.24s/it]Median error 0.2020096778869629m and 4.182782411575317 degrees.
Mean error 0.21874765325186826m and 5.751449291311536 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2020096778869629 val_loss =  0.007723560777596158
epochs:   7%|█████████▊                                                                                                                                           | 132/2001 [3:49:45<54:04:14, 104.15s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 132
For nerf, args.lrate = 1e-09, new_lrate = 9.987757747064673e-10, global_step = 133
At epoch  132 : train loss: 3393.8811, train psnr: 21.1647, val loss: 0.0076, val psnr: 20.5635                                                                                                            
epochs:   7%|█████████▊                                                                                                                                           | 132/2001 [3:51:24<54:04:14, 104.15s/it]Median error 0.20469529926776886m and 3.8562663793563843 degrees.
Mean error 0.21820850663550712m and 5.582250989340095 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20469529926776886 val_loss =  0.00760955149998032
epochs:   7%|█████████▉                                                                                                                                           | 133/2001 [3:51:29<54:03:33, 104.18s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 133
For nerf, args.lrate = 1e-09, new_lrate = 9.9876657568399e-10, global_step = 134
At epoch  133 : train loss: 3489.9265, train psnr: 21.0765, val loss: 0.0076, val psnr: 20.1499                                                                                                            
epochs:   7%|█████████▉                                                                                                                                           | 133/2001 [3:53:08<54:03:33, 104.18s/it]Median error 0.20192566514015198m and 4.034641981124878 degrees.
Mean error 0.21874128086379302m and 5.604479196915018 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20192566514015198 val_loss =  0.007614038454459793
epochs:   7%|█████████▉                                                                                                                                           | 134/2001 [3:53:13<54:00:06, 104.13s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 134
For nerf, args.lrate = 1e-09, new_lrate = 9.987573767462386e-10, global_step = 135
At epoch  134 : train loss: 3296.6890, train psnr: 21.2575, val loss: 0.0075, val psnr: 20.1081                                                                                                            
epochs:   7%|█████████▉                                                                                                                                           | 134/2001 [3:54:52<54:00:06, 104.13s/it]Median error 0.19949117302894592m and 3.9101933240890503 degrees.
Mean error 0.2162893252477412m and 5.595501587790275 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19949117302894592 val_loss =  0.007533831253512536
epochs:   7%|██████████                                                                                                                                           | 135/2001 [3:54:57<53:57:53, 104.11s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 135
For nerf, args.lrate = 1e-09, new_lrate = 9.987481778932122e-10, global_step = 136
At epoch  135 : train loss: 3222.3266, train psnr: 21.3598, val loss: 0.0075, val psnr: 20.3690                                                                                                            
epochs:   7%|██████████                                                                                                                                           | 135/2001 [3:56:36<53:57:53, 104.11s/it]Median error 0.19970230758190155m and 3.8805508613586426 degrees.
Mean error 0.2167161395396238m and 5.565352239197324 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19970230758190155 val_loss =  0.00753990302105323
epochs:   7%|██████████▏                                                                                                                                          | 136/2001 [3:56:41<53:55:15, 104.08s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 136
For nerf, args.lrate = 1e-09, new_lrate = 9.9873897912491e-10, global_step = 137
At epoch  136 : train loss: 3027.0488, train psnr: 21.5406, val loss: 0.0077, val psnr: 20.7844                                                                                                            
epochs:   7%|██████████▏                                                                                                                                          | 136/2001 [3:58:20<53:55:15, 104.08s/it]Median error 0.2020958587527275m and 4.131465196609497 degrees.
Mean error 0.21859245047516185m and 5.709845128269331 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2020958587527275 val_loss =  0.007658987876970692
epochs:   7%|██████████▏                                                                                                                                          | 137/2001 [3:58:25<53:55:25, 104.14s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 137
For nerf, args.lrate = 1e-09, new_lrate = 9.98729780441331e-10, global_step = 138
At epoch  137 : train loss: 3263.7232, train psnr: 21.2694, val loss: 0.0077, val psnr: 20.5689                                                                                                            
epochs:   7%|██████████▏                                                                                                                                          | 137/2001 [4:00:04<53:55:25, 104.14s/it]Median error 0.20395703613758087m and 3.9575523138046265 degrees.
Mean error 0.22014524971289554m and 5.622387265929809 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20395703613758087 val_loss =  0.007693844598923364
epochs:   7%|██████████▎                                                                                                                                          | 138/2001 [4:00:10<53:53:34, 104.14s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 138
For nerf, args.lrate = 1e-09, new_lrate = 9.987205818424746e-10, global_step = 139
At epoch  138 : train loss: 3116.0440, train psnr: 21.4961, val loss: 0.0075, val psnr: 20.4635                                                                                                            
epochs:   7%|██████████▎                                                                                                                                          | 138/2001 [4:01:48<53:53:34, 104.14s/it]Median error 0.20183397084474564m and 4.041330337524414 degrees.
Mean error 0.21596508793276453m and 5.628311379145273 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20183397084474564 val_loss =  0.0074790794739823955
epochs:   7%|██████████▎                                                                                                                                          | 139/2001 [4:01:54<53:52:14, 104.15s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 139
For nerf, args.lrate = 1e-09, new_lrate = 9.987113833283402e-10, global_step = 140
At epoch  139 : train loss: 3339.2730, train psnr: 21.1916, val loss: 0.0077, val psnr: 20.0427                                                                                                            
epochs:   7%|██████████▎                                                                                                                                          | 139/2001 [4:03:32<53:52:14, 104.15s/it]Median error 0.20330803096294403m and 4.006799697875977 degrees.
Mean error 0.2205452133528134m and 5.646272730248177 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20330803096294403 val_loss =  0.007710406616008355
epochs:   7%|██████████▍                                                                                                                                          | 140/2001 [4:03:38<53:49:34, 104.12s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 140
For nerf, args.lrate = 1e-09, new_lrate = 9.987021848989268e-10, global_step = 141
At epoch  140 : train loss: 3230.3382, train psnr: 21.4536, val loss: 0.0076, val psnr: 20.2308                                                                                                            
epochs:   7%|██████████▍                                                                                                                                          | 140/2001 [4:05:17<53:49:34, 104.12s/it]Median error 0.2039201259613037m and 4.034059762954712 degrees.
Mean error 0.21953644623474675m and 5.646963573238145 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2039201259613037 val_loss =  0.0076256680511851815
                     Median error 0.2039201259613037m and 4.034059762954712 degrees.
Mean error 0.21953644623474675m and 5.646963573238145 degrees.
epochs:   7%|██████████▍                                                                                                                                          | 141/2001 [4:05:28<54:40:29, 105.82s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 141
For nerf, args.lrate = 1e-09, new_lrate = 9.986929865542337e-10, global_step = 142
At epoch  141 : train loss: 3235.1958, train psnr: 21.3903, val loss: 0.0074, val psnr: 19.8797                                                                                                            
epochs:   7%|██████████▍                                                                                                                                          | 141/2001 [4:07:06<54:40:29, 105.82s/it]Median error 0.2012457251548767m and 3.944757103919983 degrees.
Mean error 0.21518586742265625m and 5.584470028276385 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2012457251548767 val_loss =  0.0074136272093824574
epochs:   7%|██████████▌                                                                                                                                          | 142/2001 [4:07:12<54:23:00, 105.32s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 142
For nerf, args.lrate = 1e-09, new_lrate = 9.9868378829426e-10, global_step = 143
At epoch  142 : train loss: 3277.3532, train psnr: 21.3105, val loss: 0.0076, val psnr: 19.6631                                                                                                            
epochs:   7%|██████████▌                                                                                                                                          | 142/2001 [4:08:51<54:23:00, 105.32s/it]Median error 0.19852831959724426m and 3.9600675106048584 degrees.
Mean error 0.2169403759875761m and 5.7280121672491315 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19852831959724426 val_loss =  0.0076443438668537846
epochs:   7%|██████████▋                                                                                                                                          | 143/2001 [4:08:56<54:10:44, 104.98s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 143
For nerf, args.lrate = 1e-09, new_lrate = 9.98674590119005e-10, global_step = 144
At epoch  143 : train loss: 3672.5104, train psnr: 20.9132, val loss: 0.0076, val psnr: 19.7879                                                                                                            
epochs:   7%|██████████▋                                                                                                                                          | 143/2001 [4:10:34<54:10:44, 104.98s/it]Median error 0.20173170417547226m and 3.8012644052505493 degrees.
Mean error 0.2173236812453581m and 5.569983075927143 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20173170417547226 val_loss =  0.007590798326521836
epochs:   7%|██████████▋                                                                                                                                          | 144/2001 [4:10:40<53:58:56, 104.65s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 144
For nerf, args.lrate = 1e-09, new_lrate = 9.98665392028468e-10, global_step = 145
At epoch  144 : train loss: 3257.8247, train psnr: 21.1432, val loss: 0.0075, val psnr: 20.3358                                                                                                            
epochs:   7%|██████████▋                                                                                                                                          | 144/2001 [4:12:18<53:58:56, 104.65s/it]Median error 0.20107799768447876m and 4.039876461029053 degrees.
Mean error 0.21597743079986287m and 5.606940208085876 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20107799768447876 val_loss =  0.007489405150129012
epochs:   7%|██████████▊                                                                                                                                          | 145/2001 [4:12:24<53:50:24, 104.43s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 145
For nerf, args.lrate = 1e-09, new_lrate = 9.986561940226481e-10, global_step = 146
At epoch  145 : train loss: 3365.3166, train psnr: 21.1343, val loss: 0.0077, val psnr: 20.4485                                                                                                            
epochs:   7%|██████████▊                                                                                                                                          | 145/2001 [4:14:02<53:50:24, 104.43s/it]Median error 0.1999548301100731m and 3.9164947271347046 degrees.
Mean error 0.21747136330005792m and 5.609395937428542 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1999548301100731 val_loss =  0.007658246755056782
epochs:   7%|██████████▊                                                                                                                                          | 146/2001 [4:14:08<53:46:11, 104.35s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 146
For nerf, args.lrate = 1e-09, new_lrate = 9.986469961015446e-10, global_step = 147
At epoch  146 : train loss: 3374.4918, train psnr: 21.1035, val loss: 0.0076, val psnr: 20.2073                                                                                                            
epochs:   7%|██████████▊                                                                                                                                          | 146/2001 [4:15:46<53:46:11, 104.35s/it]Median error 0.20354987680912018m and 3.8476240634918213 degrees.
Mean error 0.21951694636858307m and 5.479288792984206 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20354987680912018 val_loss =  0.0075784696871461915
epochs:   7%|██████████▉                                                                                                                                          | 147/2001 [4:15:52<53:40:41, 104.23s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 147
For nerf, args.lrate = 1e-09, new_lrate = 9.986377982651569e-10, global_step = 148
At epoch  147 : train loss: 3389.6642, train psnr: 21.1045, val loss: 0.0075, val psnr: 20.4914                                                                                                            
epochs:   7%|██████████▉                                                                                                                                          | 147/2001 [4:17:31<53:40:41, 104.23s/it]Median error 0.20115721225738525m and 3.7428466081619263 degrees.
Mean error 0.21783280923117992m and 5.436444855683487 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20115721225738525 val_loss =  0.007514099795370705
epochs:   7%|███████████                                                                                                                                          | 148/2001 [4:17:36<53:38:21, 104.21s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 148
For nerf, args.lrate = 1e-09, new_lrate = 9.986286005134838e-10, global_step = 149
At epoch  148 : train loss: 3212.3482, train psnr: 21.3260, val loss: 0.0076, val psnr: 20.3232                                                                                                            
epochs:   7%|███████████                                                                                                                                          | 148/2001 [4:19:15<53:38:21, 104.21s/it]Median error 0.20199887454509735m and 4.009241104125977 degrees.
Mean error 0.21894724314527111m and 5.610387946641156 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20199887454509735 val_loss =  0.007648599577746811
epochs:   7%|███████████                                                                                                                                          | 149/2001 [4:19:20<53:34:37, 104.15s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 149
For nerf, args.lrate = 1e-09, new_lrate = 9.986194028465248e-10, global_step = 150
At epoch  149 : train loss: 3302.1878, train psnr: 21.2887, val loss: 0.0077, val psnr: 19.4597                                                                                                            
epochs:   7%|███████████                                                                                                                                          | 149/2001 [4:20:59<53:34:37, 104.15s/it]Median error 0.20231673121452332m and 3.9589364528656006 degrees.
Mean error 0.22002330100586118m and 5.65799383606445 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20231673121452332 val_loss =  0.007659789527870568
epochs:   7%|███████████▏                                                                                                                                         | 150/2001 [4:21:04<53:34:30, 104.20s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 150
For nerf, args.lrate = 1e-09, new_lrate = 9.98610205264279e-10, global_step = 151
At epoch  150 : train loss: 3517.9422, train psnr: 21.1169, val loss: 0.0078, val psnr: 20.2635                                                                                                            
epochs:   7%|███████████▏                                                                                                                                         | 150/2001 [4:22:43<53:34:30, 104.20s/it]Median error 0.20590821653604507m and 3.9222800731658936 degrees.
Mean error 0.2213483186974096m and 5.611083644423408 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20590821653604507 val_loss =  0.0077568507804097004
epochs:   8%|███████████▏                                                                                                                                         | 151/2001 [4:22:48<53:32:17, 104.18s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 151
For nerf, args.lrate = 1e-09, new_lrate = 9.986010077667455e-10, global_step = 152
At epoch  151 : train loss: 3138.2040, train psnr: 21.4505, val loss: 0.0076, val psnr: 20.8120                                                                                                            
epochs:   8%|███████████▏                                                                                                                                         | 151/2001 [4:24:27<53:32:17, 104.18s/it]Median error 0.20370540022850037m and 4.044038772583008 degrees.
Mean error 0.21762743373571136m and 5.681202143279888 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20370540022850037 val_loss =  0.007633948161264741
epochs:   8%|███████████▎                                                                                                                                         | 152/2001 [4:24:33<53:29:58, 104.16s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 152
For nerf, args.lrate = 1e-09, new_lrate = 9.98591810353924e-10, global_step = 153
At epoch  152 : train loss: 3269.6697, train psnr: 21.3114, val loss: 0.0077, val psnr: 20.5242                                                                                                            
epochs:   8%|███████████▎                                                                                                                                         | 152/2001 [4:26:11<53:29:58, 104.16s/it]Median error 0.20264507830142975m and 3.9623982906341553 degrees.
Mean error 0.2196209594788339m and 5.632931733330493 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20264507830142975 val_loss =  0.0076732484046779835
epochs:   8%|███████████▍                                                                                                                                         | 153/2001 [4:26:17<53:27:11, 104.13s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 153
For nerf, args.lrate = 1e-09, new_lrate = 9.985826130258132e-10, global_step = 154
At epoch  153 : train loss: 3250.1859, train psnr: 21.4353, val loss: 0.0075, val psnr: 20.0520                                                                                                            
epochs:   8%|███████████▍                                                                                                                                         | 153/2001 [4:27:55<53:27:11, 104.13s/it]Median error 0.19863788038492203m and 3.952606201171875 degrees.
Mean error 0.21650744744987502m and 5.507981879689432 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19863788038492203 val_loss =  0.007482736919525712
epochs:   8%|███████████▍                                                                                                                                         | 154/2001 [4:28:01<53:26:02, 104.15s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 154
For nerf, args.lrate = 1e-09, new_lrate = 9.985734157824128e-10, global_step = 155
At epoch  154 : train loss: 3357.9207, train psnr: 21.1685, val loss: 0.0076, val psnr: 20.8771                                                                                                            
epochs:   8%|███████████▍                                                                                                                                         | 154/2001 [4:29:40<53:26:02, 104.15s/it]Median error 0.20185541361570358m and 3.93454110622406 degrees.
Mean error 0.21813052877225736m and 5.559678831050994 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20185541361570358 val_loss =  0.007579653260116262
epochs:   8%|███████████▌                                                                                                                                         | 155/2001 [4:29:45<53:25:00, 104.17s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 155
For nerf, args.lrate = 1e-09, new_lrate = 9.985642186237215e-10, global_step = 156
At epoch  155 : train loss: 3175.0222, train psnr: 21.3495, val loss: 0.0075, val psnr: 20.9351                                                                                                            
epochs:   8%|███████████▌                                                                                                                                         | 155/2001 [4:31:24<53:25:00, 104.17s/it]Median error 0.1995861455798149m and 4.063145875930786 degrees.
Mean error 0.21629527015875466m and 5.66644945025806 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1995861455798149 val_loss =  0.007540464166705949
epochs:   8%|███████████▌                                                                                                                                         | 156/2001 [4:31:29<53:24:05, 104.20s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 156
For nerf, args.lrate = 1e-09, new_lrate = 9.985550215497389e-10, global_step = 157
At epoch  156 : train loss: 3071.2238, train psnr: 21.4908, val loss: 0.0077, val psnr: 20.2252                                                                                                            
epochs:   8%|███████████▌                                                                                                                                         | 156/2001 [4:33:08<53:24:05, 104.20s/it]Median error 0.20459137856960297m and 3.9568625688552856 degrees.
Mean error 0.21977528021765141m and 5.622410639351317 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20459137856960297 val_loss =  0.007659370105971416
epochs:   8%|███████████▋                                                                                                                                         | 157/2001 [4:33:13<53:19:09, 104.09s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 157
For nerf, args.lrate = 1e-09, new_lrate = 9.98545824560464e-10, global_step = 158
At epoch  157 : train loss: 3136.8269, train psnr: 21.4070, val loss: 0.0077, val psnr: 20.6663                                                                                                            
epochs:   8%|███████████▋                                                                                                                                         | 157/2001 [4:34:52<53:19:09, 104.09s/it]Median error 0.2043021246790886m and 3.9107937812805176 degrees.
Mean error 0.21885202469884868m and 5.604081923059124 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2043021246790886 val_loss =  0.007672231288842182
epochs:   8%|███████████▊                                                                                                                                         | 158/2001 [4:34:57<53:16:08, 104.05s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 158
For nerf, args.lrate = 1e-09, new_lrate = 9.985366276558961e-10, global_step = 159
At epoch  158 : train loss: 3114.4130, train psnr: 21.4576, val loss: 0.0076, val psnr: 20.1570                                                                                                            
epochs:   8%|███████████▊                                                                                                                                         | 158/2001 [4:36:35<53:16:08, 104.05s/it]Median error 0.2010262832045555m and 4.024442195892334 degrees.
Mean error 0.21704968028072164m and 5.649331721458358 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2010262832045555 val_loss =  0.007554309298357406
epochs:   8%|███████████▊                                                                                                                                         | 159/2001 [4:36:41<53:11:18, 103.95s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 159
For nerf, args.lrate = 1e-09, new_lrate = 9.985274308360345e-10, global_step = 160
At epoch  159 : train loss: 3218.8221, train psnr: 21.3028, val loss: 0.0076, val psnr: 20.7503                                                                                                            
epochs:   8%|███████████▊                                                                                                                                         | 159/2001 [4:38:19<53:11:18, 103.95s/it]Median error 0.20412084460258484m and 3.7638065814971924 degrees.
Mean error 0.21854163403905597m and 5.455205155860798 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20412084460258484 val_loss =  0.007554031538528198
epochs:   8%|███████████▉                                                                                                                                         | 160/2001 [4:38:25<53:09:21, 103.94s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 160
For nerf, args.lrate = 1e-09, new_lrate = 9.985182341008783e-10, global_step = 161
At epoch  160 : train loss: 3087.1778, train psnr: 21.5803, val loss: 0.0075, val psnr: 20.6330                                                                                                            
epochs:   8%|███████████▉                                                                                                                                         | 160/2001 [4:40:03<53:09:21, 103.94s/it]Median error 0.20142927020788193m and 3.9623916149139404 degrees.
Mean error 0.21573714099387045m and 5.575328778158798 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20142927020788193 val_loss =  0.007490696439836839
                     Median error 0.20142927020788193m and 3.9623916149139404 degrees.
Mean error 0.21573714099387045m and 5.575328778158798 degrees.
epochs:   8%|███████████▉                                                                                                                                         | 161/2001 [4:40:14<53:59:44, 105.64s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 161
For nerf, args.lrate = 1e-09, new_lrate = 9.985090374504269e-10, global_step = 162
At epoch  161 : train loss: 3152.6257, train psnr: 21.2415, val loss: 0.0075, val psnr: 21.0216                                                                                                            
epochs:   8%|███████████▉                                                                                                                                         | 161/2001 [4:41:53<53:59:44, 105.64s/it]Median error 0.203989639878273m and 3.9968230724334717 degrees.
Mean error 0.21816056990535998m and 5.579222734911963 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.203989639878273 val_loss =  0.007546193706266312
epochs:   8%|████████████                                                                                                                                         | 162/2001 [4:41:58<53:43:17, 105.16s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 162
For nerf, args.lrate = 1e-09, new_lrate = 9.984998408846793e-10, global_step = 163
At epoch  162 : train loss: 3451.9601, train psnr: 21.1196, val loss: 0.0078, val psnr: 19.6792                                                                                                            
epochs:   8%|████████████                                                                                                                                         | 162/2001 [4:43:37<53:43:17, 105.16s/it]Median error 0.2039625123143196m and 4.082765340805054 degrees.
Mean error 0.22094271483601105m and 5.696156422407762 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2039625123143196 val_loss =  0.007757005599207906
epochs:   8%|████████████▏                                                                                                                                        | 163/2001 [4:43:42<53:29:36, 104.77s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 163
For nerf, args.lrate = 1e-09, new_lrate = 9.984906444036348e-10, global_step = 164
At epoch  163 : train loss: 3118.5989, train psnr: 21.5102, val loss: 0.0076, val psnr: 20.2379                                                                                                            
epochs:   8%|████████████▏                                                                                                                                        | 163/2001 [4:45:21<53:29:36, 104.77s/it]Median error 0.2020508423447609m and 4.169095039367676 degrees.
Mean error 0.21871240728116229m and 5.646085650497964 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2020508423447609 val_loss =  0.007591860885278822
epochs:   8%|████████████▏                                                                                                                                        | 164/2001 [4:45:26<53:20:34, 104.54s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 164
For nerf, args.lrate = 1e-09, new_lrate = 9.984814480072926e-10, global_step = 165
At epoch  164 : train loss: 3293.8269, train psnr: 21.3740, val loss: 0.0076, val psnr: 20.6074                                                                                                            
epochs:   8%|████████████▏                                                                                                                                        | 164/2001 [4:47:05<53:20:34, 104.54s/it]Median error 0.20412135869264603m and 4.05949592590332 degrees.
Mean error 0.21957382188001384m and 5.627766993967628 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20412135869264603 val_loss =  0.00762129066887157
epochs:   8%|████████████▎                                                                                                                                        | 165/2001 [4:47:10<53:12:02, 104.31s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 165
For nerf, args.lrate = 1e-09, new_lrate = 9.98472251695652e-10, global_step = 166
At epoch  165 : train loss: 3143.0788, train psnr: 21.5201, val loss: 0.0076, val psnr: 20.3714                                                                                                            
epochs:   8%|████████████▎                                                                                                                                        | 165/2001 [4:48:49<53:12:02, 104.31s/it]Median error 0.20438022911548615m and 3.96022367477417 degrees.
Mean error 0.21973729446183451m and 5.605602806939287 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20438022911548615 val_loss =  0.007628764043320447
epochs:   8%|████████████▎                                                                                                                                        | 166/2001 [4:48:54<53:07:17, 104.22s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 166
For nerf, args.lrate = 1e-09, new_lrate = 9.984630554687123e-10, global_step = 167
At epoch  166 : train loss: 3487.6415, train psnr: 21.0520, val loss: 0.0077, val psnr: 19.5974                                                                                                            
epochs:   8%|████████████▎                                                                                                                                        | 166/2001 [4:50:33<53:07:17, 104.22s/it]Median error 0.20252623409032822m and 3.8836745023727417 degrees.
Mean error 0.2193478800974756m and 5.587119047744916 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20252623409032822 val_loss =  0.007680475530306515
epochs:   8%|████████████▍                                                                                                                                        | 167/2001 [4:50:38<53:05:26, 104.21s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 167
For nerf, args.lrate = 1e-09, new_lrate = 9.984538593264724e-10, global_step = 168
At epoch  167 : train loss: 3274.0776, train psnr: 21.2363, val loss: 0.0076, val psnr: 20.7071                                                                                                            
epochs:   8%|████████████▍                                                                                                                                        | 167/2001 [4:52:17<53:05:26, 104.21s/it]Median error 0.2034124806523323m and 3.9091920852661133 degrees.
Mean error 0.21873581763507746m and 5.554436717016494 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2034124806523323 val_loss =  0.007605891944586039
epochs:   8%|████████████▌                                                                                                                                        | 168/2001 [4:52:22<53:03:30, 104.21s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 168
For nerf, args.lrate = 1e-09, new_lrate = 9.984446632689317e-10, global_step = 169
At epoch  168 : train loss: 3088.2325, train psnr: 21.5326, val loss: 0.0076, val psnr: 20.8801                                                                                                            
epochs:   8%|████████████▌                                                                                                                                        | 168/2001 [4:54:01<53:03:30, 104.21s/it]Median error 0.2011839970946312m and 3.877017378807068 degrees.
Mean error 0.21759634045318432m and 5.567656300373767 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2011839970946312 val_loss =  0.007630206932303607
epochs:   8%|████████████▌                                                                                                                                        | 169/2001 [4:54:07<53:00:31, 104.17s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 169
For nerf, args.lrate = 1e-09, new_lrate = 9.984354672960895e-10, global_step = 170
At epoch  169 : train loss: 3161.1882, train psnr: 21.3220, val loss: 0.0076, val psnr: 20.7541                                                                                                            
epochs:   8%|████████████▌                                                                                                                                        | 169/2001 [4:55:45<53:00:31, 104.17s/it]Median error 0.20087047666311264m and 3.9341442584991455 degrees.
Mean error 0.21786298594147208m and 5.610413052322652 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20087047666311264 val_loss =  0.007626121468052102
epochs:   8%|████████████▋                                                                                                                                        | 170/2001 [4:55:51<52:59:06, 104.18s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 170
For nerf, args.lrate = 1e-09, new_lrate = 9.98426271407945e-10, global_step = 171
At epoch  170 : train loss: 3290.1267, train psnr: 21.2208, val loss: 0.0076, val psnr: 20.6480                                                                                                            
epochs:   8%|████████████▋                                                                                                                                        | 170/2001 [4:57:30<52:59:06, 104.18s/it]Median error 0.20039765536785126m and 4.033185720443726 degrees.
Mean error 0.2183269018416674m and 5.637358272666873 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20039765536785126 val_loss =  0.0076281433591693605
epochs:   9%|████████████▋                                                                                                                                        | 171/2001 [4:57:35<52:57:29, 104.18s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 171
For nerf, args.lrate = 1e-09, new_lrate = 9.984170756044972e-10, global_step = 172
At epoch  171 : train loss: 3251.9028, train psnr: 21.3539, val loss: 0.0076, val psnr: 20.3314                                                                                                            
epochs:   9%|████████████▋                                                                                                                                        | 171/2001 [4:59:13<52:57:29, 104.18s/it]Median error 0.20391977578401566m and 3.988587737083435 degrees.
Mean error 0.2200076599729809m and 5.622960468354496 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20391977578401566 val_loss =  0.007638749088854001
epochs:   9%|████████████▊                                                                                                                                        | 172/2001 [4:59:19<52:52:58, 104.09s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 172
For nerf, args.lrate = 1e-09, new_lrate = 9.984078798857456e-10, global_step = 173
At epoch  172 : train loss: 3249.6071, train psnr: 21.3478, val loss: 0.0077, val psnr: 20.1965                                                                                                            
epochs:   9%|████████████▊                                                                                                                                        | 172/2001 [5:00:57<52:52:58, 104.09s/it]Median error 0.20334412902593613m and 4.113994359970093 degrees.
Mean error 0.22024950472947194m and 5.693242009955379 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20334412902593613 val_loss =  0.00771705015632701
epochs:   9%|████████████▉                                                                                                                                        | 173/2001 [5:01:03<52:50:47, 104.07s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 173
For nerf, args.lrate = 1e-09, new_lrate = 9.983986842516894e-10, global_step = 174
At epoch  173 : train loss: 3358.4044, train psnr: 21.2211, val loss: 0.0075, val psnr: 20.6197                                                                                                            
epochs:   9%|████████████▉                                                                                                                                        | 173/2001 [5:02:42<52:50:47, 104.07s/it]Median error 0.2015499547123909m and 3.9306596517562866 degrees.
Mean error 0.21703773219636094m and 5.569114835046775 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2015499547123909 val_loss =  0.0075129173177710135
epochs:   9%|████████████▉                                                                                                                                        | 174/2001 [5:02:47<52:50:12, 104.11s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 174
For nerf, args.lrate = 1e-09, new_lrate = 9.983894887023276e-10, global_step = 175
At epoch  174 : train loss: 3285.1489, train psnr: 21.3380, val loss: 0.0076, val psnr: 19.9373                                                                                                            
epochs:   9%|████████████▉                                                                                                                                        | 174/2001 [5:04:26<52:50:12, 104.11s/it]Median error 0.20209534466266632m and 4.055832624435425 degrees.
Mean error 0.21890586055061112m and 5.631720924365376 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20209534466266632 val_loss =  0.00763020069891413
epochs:   9%|█████████████                                                                                                                                        | 175/2001 [5:04:31<52:48:28, 104.11s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 175
For nerf, args.lrate = 1e-09, new_lrate = 9.983802932376596e-10, global_step = 176
At epoch  175 : train loss: 3418.7654, train psnr: 21.0659, val loss: 0.0077, val psnr: 20.5692                                                                                                            
epochs:   9%|█████████████                                                                                                                                        | 175/2001 [5:06:10<52:48:28, 104.11s/it]Median error 0.20532945543527603m and 4.042295932769775 degrees.
Mean error 0.21990329898923996m and 5.677121014941318 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20532945543527603 val_loss =  0.007714212267211382
epochs:   9%|█████████████                                                                                                                                        | 176/2001 [5:06:15<52:43:53, 104.02s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 176
For nerf, args.lrate = 1e-09, new_lrate = 9.983710978576846e-10, global_step = 177
At epoch  176 : train loss: 3211.1423, train psnr: 21.3664, val loss: 0.0077, val psnr: 20.5139                                                                                                            
epochs:   9%|█████████████                                                                                                                                        | 176/2001 [5:07:54<52:43:53, 104.02s/it]Median error 0.20463775843381882m and 3.90929114818573 degrees.
Mean error 0.21979602745654975m and 5.572345364235552 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20463775843381882 val_loss =  0.007659185945003592
epochs:   9%|█████████████▏                                                                                                                                       | 177/2001 [5:07:59<52:44:07, 104.08s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 177
For nerf, args.lrate = 1e-09, new_lrate = 9.983619025624019e-10, global_step = 178
At epoch  177 : train loss: 3119.1959, train psnr: 21.4225, val loss: 0.0077, val psnr: 19.7937                                                                                                            
epochs:   9%|█████████████▏                                                                                                                                       | 177/2001 [5:09:38<52:44:07, 104.08s/it]Median error 0.20510215312242508m and 4.0159687995910645 degrees.
Mean error 0.22050225322591027m and 5.683681948585549 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20510215312242508 val_loss =  0.007708862383510806
epochs:   9%|█████████████▎                                                                                                                                       | 178/2001 [5:09:43<52:41:52, 104.07s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 178
For nerf, args.lrate = 1e-09, new_lrate = 9.983527073518103e-10, global_step = 179
At epoch  178 : train loss: 3304.5037, train psnr: 21.1072, val loss: 0.0077, val psnr: 19.9988                                                                                                            
epochs:   9%|█████████████▎                                                                                                                                       | 178/2001 [5:11:22<52:41:52, 104.07s/it]Median error 0.20559363067150116m and 4.013631820678711 degrees.
Mean error 0.22138252336275482m and 5.632680845013273 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20559363067150116 val_loss =  0.007717341411466897
epochs:   9%|█████████████▎                                                                                                                                       | 179/2001 [5:11:27<52:39:22, 104.04s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 179
For nerf, args.lrate = 1e-09, new_lrate = 9.983435122259095e-10, global_step = 180
At epoch  179 : train loss: 3223.0162, train psnr: 21.3201, val loss: 0.0076, val psnr: 20.8257                                                                                                            
epochs:   9%|█████████████▎                                                                                                                                       | 179/2001 [5:13:06<52:39:22, 104.04s/it]Median error 0.199492946267128m and 3.97640061378479 degrees.
Mean error 0.21751385120305455m and 5.632989168649743 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.199492946267128 val_loss =  0.007628537207358891
epochs:   9%|█████████████▍                                                                                                                                       | 180/2001 [5:13:11<52:36:09, 103.99s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 180
For nerf, args.lrate = 1e-09, new_lrate = 9.983343171846985e-10, global_step = 181
At epoch  180 : train loss: 3362.0970, train psnr: 21.2299, val loss: 0.0075, val psnr: 20.2696                                                                                                            
epochs:   9%|█████████████▍                                                                                                                                       | 180/2001 [5:14:49<52:36:09, 103.99s/it]Median error 0.20044095069169998m and 3.8947468996047974 degrees.
Mean error 0.21742947551945926m and 5.515640651588498 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20044095069169998 val_loss =  0.007526274487383989
                     Median error 0.20044095069169998m and 3.8947468996047974 degrees.
Mean error 0.21742947551945926m and 5.515640651588498 degrees.
epochs:   9%|█████████████▍                                                                                                                                       | 181/2001 [5:15:00<53:22:18, 105.57s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 181
For nerf, args.lrate = 1e-09, new_lrate = 9.983251222281766e-10, global_step = 182
At epoch  181 : train loss: 3231.3982, train psnr: 21.3193, val loss: 0.0076, val psnr: 20.0082                                                                                                            
epochs:   9%|█████████████▍                                                                                                                                       | 181/2001 [5:16:39<53:22:18, 105.57s/it]Median error 0.20054762065410614m and 3.960116982460022 degrees.
Mean error 0.2172736979206564m and 5.633378042805533 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20054762065410614 val_loss =  0.0076101204694673154
epochs:   9%|█████████████▌                                                                                                                                       | 182/2001 [5:16:44<53:05:45, 105.08s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 182
For nerf, args.lrate = 1e-09, new_lrate = 9.983159273563432e-10, global_step = 183
At epoch  182 : train loss: 3426.5465, train psnr: 21.1356, val loss: 0.0077, val psnr: 19.8096                                                                                                            
epochs:   9%|█████████████▌                                                                                                                                       | 182/2001 [5:18:23<53:05:45, 105.08s/it]Median error 0.20166921615600586m and 4.103994131088257 degrees.
Mean error 0.22016506269197111m and 5.614214779394358 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20166921615600586 val_loss =  0.007692611760061341
epochs:   9%|█████████████▋                                                                                                                                       | 183/2001 [5:18:29<52:56:29, 104.83s/it]
Best val loss: 0.1964
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 183
For nerf, args.lrate = 1e-09, new_lrate = 9.983067325691969e-10, global_step = 184
                                                                                                                                                            At epoch  183 : train loss: 3137.0005, train psnr: 21.4945, val loss: 0.0073, val psnr: 19.1576
epochs:   9%|█████████████▋                                                                                                                                       | 183/2001 [5:20:08<52:56:29, 104.83s/it]Median error 0.19897668063640594m and 4.189888000488281 degrees.
Mean error 0.21173197425042206m and 5.695103337317102 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19897668063640594 val_loss =  0.007328521052988384
epochs:   9%|█████████████▋                                                                                                                                       | 184/2001 [5:20:13<52:52:51, 104.77s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 184
For nerf, args.lrate = 1e-09, new_lrate = 9.982975378667376e-10, global_step = 185
                                                                                                                                                            At epoch  184 : train loss: 3250.2858, train psnr: 21.4304, val loss: 0.0077, val psnr: 20.4143
epochs:   9%|█████████████▋                                                                                                                                       | 184/2001 [5:21:52<52:52:51, 104.77s/it]Median error 0.20366638153791428m and 4.072875261306763 degrees.
Mean error 0.2195796689418284m and 5.646571383483497 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20366638153791428 val_loss =  0.007677291485857782
epochs:   9%|█████████████▊                                                                                                                                       | 185/2001 [5:21:57<52:44:51, 104.57s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 185
For nerf, args.lrate = 1e-09, new_lrate = 9.982883432489642e-10, global_step = 186
                                                                                                                                                            At epoch  185 : train loss: 3214.8237, train psnr: 21.5011, val loss: 0.0077, val psnr: 20.8978
epochs:   9%|█████████████▊                                                                                                                                       | 185/2001 [5:23:36<52:44:51, 104.57s/it]Median error 0.20273908972740173m and 3.966444969177246 degrees.
Mean error 0.21890608148144083m and 5.583578495421873 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20273908972740173 val_loss =  0.007658853460826627
epochs:   9%|█████████████▊                                                                                                                                       | 186/2001 [5:23:41<52:36:42, 104.35s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 186
For nerf, args.lrate = 1e-09, new_lrate = 9.982791487158759e-10, global_step = 187
                                                                                                                                                            At epoch  186 : train loss: 3276.3542, train psnr: 21.3686, val loss: 0.0076, val psnr: 19.9112
epochs:   9%|█████████████▊                                                                                                                                       | 186/2001 [5:25:20<52:36:42, 104.35s/it]Median error 0.20144253224134445m and 3.84559428691864 degrees.
Mean error 0.2200306288686841m and 5.522394485017549 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20144253224134445 val_loss =  0.007617608183620899
epochs:   9%|█████████████▉                                                                                                                                       | 187/2001 [5:25:25<52:31:29, 104.24s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 187
For nerf, args.lrate = 1e-09, new_lrate = 9.98269954267472e-10, global_step = 188
                                                                                                                                                            At epoch  187 : train loss: 3319.2538, train psnr: 21.2415, val loss: 0.0076, val psnr: 20.5629
epochs:   9%|█████████████▉                                                                                                                                       | 187/2001 [5:27:04<52:31:29, 104.24s/it]Median error 0.20149314403533936m and 3.94328510761261 degrees.
Mean error 0.21917176765091867m and 5.560502401217517 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20149314403533936 val_loss =  0.007633483668313591
epochs:   9%|█████████████▉                                                                                                                                       | 188/2001 [5:27:09<52:27:49, 104.18s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 188
For nerf, args.lrate = 1e-09, new_lrate = 9.982607599037518e-10, global_step = 189
                                                                                                                                                            At epoch  188 : train loss: 3227.8269, train psnr: 21.2317, val loss: 0.0075, val psnr: 20.4151
epochs:   9%|█████████████▉                                                                                                                                       | 188/2001 [5:28:48<52:27:49, 104.18s/it]Median error 0.20242372155189514m and 4.01158332824707 degrees.
Mean error 0.21735519480699228m and 5.575988126730147 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20242372155189514 val_loss =  0.007515453035159174
epochs:   9%|██████████████                                                                                                                                       | 189/2001 [5:28:53<52:24:58, 104.14s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 189
For nerf, args.lrate = 1e-09, new_lrate = 9.982515656247145e-10, global_step = 190
                                                                                                                                                            At epoch  189 : train loss: 3092.8293, train psnr: 21.5708, val loss: 0.0075, val psnr: 20.5111
epochs:   9%|██████████████                                                                                                                                       | 189/2001 [5:30:32<52:24:58, 104.14s/it]Median error 0.20403902977705002m and 4.1403608322143555 degrees.
Mean error 0.21875266741342872m and 5.618546457365457 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20403902977705002 val_loss =  0.007513130475536129
epochs:   9%|██████████████▏                                                                                                                                      | 190/2001 [5:30:37<52:24:36, 104.18s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 190
For nerf, args.lrate = 1e-09, new_lrate = 9.982423714303591e-10, global_step = 191
                                                                                                                                                            At epoch  190 : train loss: 2935.7342, train psnr: 21.6774, val loss: 0.0077, val psnr: 19.6558
epochs:   9%|██████████████▏                                                                                                                                      | 190/2001 [5:32:16<52:24:36, 104.18s/it]Median error 0.20245647430419922m and 4.06161904335022 degrees.
Mean error 0.21810550916834398m and 5.704996346281125 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20245647430419922 val_loss =  0.007652361211748129
epochs:  10%|██████████████▏                                                                                                                                      | 191/2001 [5:32:22<52:22:34, 104.17s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 191
For nerf, args.lrate = 1e-09, new_lrate = 9.98233177320685e-10, global_step = 192
                                                                                                                                                            At epoch  191 : train loss: 2983.2235, train psnr: 21.6224, val loss: 0.0078, val psnr: 19.8057
epochs:  10%|██████████████▏                                                                                                                                      | 191/2001 [5:34:00<52:22:34, 104.17s/it]Median error 0.20516081899404526m and 4.087172508239746 degrees.
Mean error 0.2225171552314932m and 5.700529312647065 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20516081899404526 val_loss =  0.007837975477049319
epochs:  10%|██████████████▎                                                                                                                                      | 192/2001 [5:34:06<52:19:44, 104.14s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 192
For nerf, args.lrate = 1e-09, new_lrate = 9.982239832956913e-10, global_step = 193
                                                                                                                                                            At epoch  192 : train loss: 3155.8449, train psnr: 21.5109, val loss: 0.0077, val psnr: 19.6256
epochs:  10%|██████████████▎                                                                                                                                      | 192/2001 [5:35:44<52:19:44, 104.14s/it]Median error 0.20457355678081512m and 4.217357397079468 degrees.
Mean error 0.22066396056685733m and 5.7144859070297676 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20457355678081512 val_loss =  0.0077226909459362355
epochs:  10%|██████████████▎                                                                                                                                      | 193/2001 [5:35:50<52:17:52, 104.13s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 193
For nerf, args.lrate = 1e-09, new_lrate = 9.982147893553776e-10, global_step = 194
                                                                                                                                                            At epoch  193 : train loss: 3112.3219, train psnr: 21.4040, val loss: 0.0077, val psnr: 20.4408
epochs:  10%|██████████████▎                                                                                                                                      | 193/2001 [5:37:28<52:17:52, 104.13s/it]Median error 0.20363394916057587m and 4.207669019699097 degrees.
Mean error 0.22010790882066555m and 5.75650254483165 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20363394916057587 val_loss =  0.007735283988294534
epochs:  10%|██████████████▍                                                                                                                                      | 194/2001 [5:37:34<52:16:02, 104.13s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 194
For nerf, args.lrate = 1e-09, new_lrate = 9.982055954997425e-10, global_step = 195
                                                                                                                                                            At epoch  194 : train loss: 3200.9653, train psnr: 21.3972, val loss: 0.0077, val psnr: 20.5477
epochs:  10%|██████████████▍                                                                                                                                      | 194/2001 [5:39:12<52:16:02, 104.13s/it]Median error 0.20270902663469315m and 4.007874011993408 degrees.
Mean error 0.21937647496957166m and 5.670096493518425 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20270902663469315 val_loss =  0.007727915453045278
epochs:  10%|██████████████▌                                                                                                                                      | 195/2001 [5:39:18<52:13:30, 104.10s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 195
For nerf, args.lrate = 1e-09, new_lrate = 9.981964017287858e-10, global_step = 196
                                                                                                                                                            At epoch  195 : train loss: 3514.1387, train psnr: 21.1278, val loss: 0.0078, val psnr: 20.5850
epochs:  10%|██████████████▌                                                                                                                                      | 195/2001 [5:40:57<52:13:30, 104.10s/it]Median error 0.2057543843984604m and 4.01636004447937 degrees.
Mean error 0.22150456070191102m and 5.6105580863199735 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2057543843984604 val_loss =  0.007798399610198876
epochs:  10%|██████████████▌                                                                                                                                      | 196/2001 [5:41:02<52:11:52, 104.11s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 196
For nerf, args.lrate = 1e-09, new_lrate = 9.981872080425063e-10, global_step = 197
                                                                                                                                                            At epoch  196 : train loss: 3246.2834, train psnr: 21.3289, val loss: 0.0076, val psnr: 19.8439
epochs:  10%|██████████████▌                                                                                                                                      | 196/2001 [5:42:41<52:11:52, 104.11s/it]Median error 0.2006067857146263m and 4.114377021789551 degrees.
Mean error 0.21858116882939932m and 5.68886378713646 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2006067857146263 val_loss =  0.0076324939087822966
epochs:  10%|██████████████▋                                                                                                                                      | 197/2001 [5:42:46<52:11:06, 104.14s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 197
For nerf, args.lrate = 1e-09, new_lrate = 9.981780144409034e-10, global_step = 198
                                                                                                                                                            At epoch  197 : train loss: 3329.4127, train psnr: 21.1822, val loss: 0.0077, val psnr: 20.1936
epochs:  10%|██████████████▋                                                                                                                                      | 197/2001 [5:44:25<52:11:06, 104.14s/it]Median error 0.20514044910669327m and 3.826604127883911 degrees.
Mean error 0.221523228991279m and 5.520303832163454 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20514044910669327 val_loss =  0.007677985470318273
epochs:  10%|██████████████▋                                                                                                                                      | 198/2001 [5:44:30<52:10:02, 104.16s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 198
For nerf, args.lrate = 1e-09, new_lrate = 9.981688209239765e-10, global_step = 199
                                                                                                                                                            At epoch  198 : train loss: 3245.8716, train psnr: 21.3088, val loss: 0.0076, val psnr: 19.5331
epochs:  10%|██████████████▋                                                                                                                                      | 198/2001 [5:46:09<52:10:02, 104.16s/it]Median error 0.2055908590555191m and 3.925573229789734 degrees.
Mean error 0.21760368611482594m and 5.5410416929526365 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2055908590555191 val_loss =  0.007551418622876263
epochs:  10%|██████████████▊                                                                                                                                      | 199/2001 [5:46:15<52:08:01, 104.15s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 199
For nerf, args.lrate = 1e-09, new_lrate = 9.981596274917243e-10, global_step = 200
                                                                                                                                                            At epoch  199 : train loss: 3447.3811, train psnr: 21.1022, val loss: 0.0076, val psnr: 20.8053
epochs:  10%|██████████████▊                                                                                                                                      | 199/2001 [5:47:53<52:08:01, 104.15s/it]Median error 0.20417295396327972m and 3.994567632675171 degrees.
Mean error 0.2179392735560534m and 5.607642046413441 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20417295396327972 val_loss =  0.007577687456351606
epochs:  10%|██████████████▉                                                                                                                                      | 200/2001 [5:47:59<52:05:04, 104.11s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 200
For nerf, args.lrate = 1e-09, new_lrate = 9.981504341441465e-10, global_step = 201
                                                                                                                                                            At epoch  200 : train loss: 3449.3237, train psnr: 21.0974, val loss: 0.0075, val psnr: 20.4606
epochs:  10%|██████████████▉                                                                                                                                      | 200/2001 [5:49:37<52:05:04, 104.11s/it]Median error 0.2030152827501297m and 3.8784308433532715 degrees.
Mean error 0.21751321823928157m and 5.509383556663025 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2030152827501297 val_loss =  0.007508465637384442
                     Median error 0.2030152827501297m and 3.8784308433532715 degrees.l loss: 0.1964
Mean error 0.21751321823928157m and 5.509383556663025 degrees.
epochs:  10%|██████████████▉                                                                                                                                      | 201/2001 [5:49:48<52:52:08, 105.74s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 201
For nerf, args.lrate = 1e-09, new_lrate = 9.981412408812422e-10, global_step = 202
                                                                                                                                                            At epoch  201 : train loss: 3412.2796, train psnr: 21.0857, val loss: 0.0076, val psnr: 20.2363
epochs:  10%|██████████████▉                                                                                                                                      | 201/2001 [5:51:27<52:52:08, 105.74s/it]Median error 0.2018805295228958m and 3.9846527576446533 degrees.
Mean error 0.21834146496858675m and 5.605971071220603 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2018805295228958 val_loss =  0.0076218473239328625
epochs:  10%|███████████████                                                                                                                                      | 202/2001 [5:51:32<52:35:39, 105.25s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 202
For nerf, args.lrate = 1e-09, new_lrate = 9.981320477030106e-10, global_step = 203
                                                                                                                                                            At epoch  202 : train loss: 3243.1765, train psnr: 21.4129, val loss: 0.0075, val psnr: 20.6830
epochs:  10%|███████████████                                                                                                                                      | 202/2001 [5:53:11<52:35:39, 105.25s/it]Median error 0.20281773060560226m and 3.8553532361984253 degrees.
Mean error 0.21789555425043047m and 5.497850165676009 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20281773060560226 val_loss =  0.007536915127790782
epochs:  10%|███████████████                                                                                                                                      | 203/2001 [5:53:17<52:25:55, 104.98s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 203
For nerf, args.lrate = 1e-09, new_lrate = 9.981228546094509e-10, global_step = 204
                                                                                                                                                            At epoch  203 : train loss: 3118.6304, train psnr: 21.5018, val loss: 0.0076, val psnr: 20.4441
epochs:  10%|███████████████                                                                                                                                      | 203/2001 [5:54:55<52:25:55, 104.98s/it]Median error 0.201370969414711m and 3.9025760889053345 degrees.
Mean error 0.21859237789232963m and 5.5583493650442195 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.201370969414711 val_loss =  0.007608008154781383
epochs:  10%|███████████████▏                                                                                                                                     | 204/2001 [5:55:00<52:14:16, 104.65s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 204
For nerf, args.lrate = 1e-09, new_lrate = 9.981136616005624e-10, global_step = 205
                                                                                                                                                            At epoch  204 : train loss: 3239.7691, train psnr: 21.2228, val loss: 0.0076, val psnr: 20.5110
epochs:  10%|███████████████▏                                                                                                                                     | 204/2001 [5:56:39<52:14:16, 104.65s/it]Median error 0.201706200838089m and 4.08437442779541 degrees.
Mean error 0.21846746011195997m and 5.675214230410965 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.201706200838089 val_loss =  0.007642893642512328
epochs:  10%|███████████████▎                                                                                                                                     | 205/2001 [5:56:45<52:07:16, 104.47s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 205
For nerf, args.lrate = 1e-09, new_lrate = 9.98104468676344e-10, global_step = 206
                                                                                                                                                            At epoch  205 : train loss: 3266.1417, train psnr: 21.3320, val loss: 0.0077, val psnr: 19.9670
epochs:  10%|███████████████▎                                                                                                                                     | 205/2001 [5:58:23<52:07:16, 104.47s/it]Median error 0.20441852509975433m and 3.860928773880005 degrees.
Mean error 0.2206011233881478m and 5.531225383462694 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20441852509975433 val_loss =  0.007672620600310125
epochs:  10%|███████████████▎                                                                                                                                     | 206/2001 [5:58:29<52:02:45, 104.38s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 206
For nerf, args.lrate = 1e-09, new_lrate = 9.980952758367956e-10, global_step = 207
                                                                                                                                                            At epoch  206 : train loss: 3449.1036, train psnr: 21.1225, val loss: 0.0077, val psnr: 20.1026
epochs:  10%|███████████████▎                                                                                                                                     | 206/2001 [6:00:07<52:02:45, 104.38s/it]Median error 0.20302321761846542m and 4.051385879516602 degrees.
Mean error 0.219182258256926m and 5.674186577138148 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20302321761846542 val_loss =  0.007695828868449842
epochs:  10%|███████████████▍                                                                                                                                     | 207/2001 [6:00:13<51:57:56, 104.28s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 207
For nerf, args.lrate = 1e-09, new_lrate = 9.980860830819157e-10, global_step = 208
                                                                                                                                                            At epoch  207 : train loss: 3020.6044, train psnr: 21.6661, val loss: 0.0076, val psnr: 20.8992
epochs:  10%|███████████████▍                                                                                                                                     | 207/2001 [6:01:51<51:57:56, 104.28s/it]Median error 0.202957883477211m and 4.006213188171387 degrees.
Mean error 0.21789547870018583m and 5.597765854435411 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.202957883477211 val_loss =  0.0076144978748607355
epochs:  10%|███████████████▍                                                                                                                                     | 208/2001 [6:01:57<51:53:51, 104.20s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 208
For nerf, args.lrate = 1e-09, new_lrate = 9.980768904117039e-10, global_step = 209
                                                                                                                                                            At epoch  208 : train loss: 3204.0922, train psnr: 21.2831, val loss: 0.0075, val psnr: 20.6693
epochs:  10%|███████████████▍                                                                                                                                     | 208/2001 [6:03:35<51:53:51, 104.20s/it]Median error 0.20276658236980438m and 4.084298849105835 degrees.
Mean error 0.21705138534005836m and 5.590568326142153 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20276658236980438 val_loss =  0.007491380088637523
epochs:  10%|███████████████▌                                                                                                                                     | 209/2001 [6:03:41<51:50:27, 104.15s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 209
For nerf, args.lrate = 1e-09, new_lrate = 9.980676978261592e-10, global_step = 210
                                                                                                                                                            At epoch  209 : train loss: 3034.6992, train psnr: 21.5345, val loss: 0.0076, val psnr: 20.9393
epochs:  10%|███████████████▌                                                                                                                                     | 209/2001 [6:05:19<51:50:27, 104.15s/it]Median error 0.20204681903123856m and 4.003378868103027 degrees.
Mean error 0.21882804117433213m and 5.614407983808382 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20204681903123856 val_loss =  0.007617913249971747
epochs:  10%|███████████████▋                                                                                                                                     | 210/2001 [6:05:25<51:48:37, 104.14s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 210
For nerf, args.lrate = 1e-09, new_lrate = 9.98058505325281e-10, global_step = 211
                                                                                                                                                            At epoch  210 : train loss: 2941.0164, train psnr: 21.6428, val loss: 0.0076, val psnr: 20.4838
epochs:  10%|███████████████▋                                                                                                                                     | 210/2001 [6:07:04<51:48:37, 104.14s/it]Median error 0.20335637032985687m and 3.687111258506775 degrees.
Mean error 0.2191067106969021m and 5.408486487351448 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20335637032985687 val_loss =  0.007592911946608828
epochs:  11%|███████████████▋                                                                                                                                     | 211/2001 [6:07:09<51:45:28, 104.09s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 211
For nerf, args.lrate = 1e-09, new_lrate = 9.980493129090686e-10, global_step = 212
                                                                                                                                                            At epoch  211 : train loss: 3189.0455, train psnr: 21.4067, val loss: 0.0077, val psnr: 20.1949
epochs:  11%|███████████████▋                                                                                                                                     | 211/2001 [6:08:48<51:45:28, 104.09s/it]Median error 0.20219862461090088m and 4.081902980804443 degrees.
Mean error 0.21917117155168342m and 5.740257706628879 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20219862461090088 val_loss =  0.007732205316252339
epochs:  11%|███████████████▊                                                                                                                                     | 212/2001 [6:08:53<51:43:56, 104.10s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 212
For nerf, args.lrate = 1e-09, new_lrate = 9.980401205775209e-10, global_step = 213
                                                                                                                                                            At epoch  212 : train loss: 3036.3479, train psnr: 21.6285, val loss: 0.0078, val psnr: 20.4079
epochs:  11%|███████████████▊                                                                                                                                     | 212/2001 [6:10:32<51:43:56, 104.10s/it]Median error 0.20188137143850327m and 3.8795275688171387 degrees.
Mean error 0.2204237210673661m and 5.594689132411953 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20188137143850327 val_loss =  0.00784843924067922
epochs:  11%|███████████████▊                                                                                                                                     | 213/2001 [6:10:37<51:43:13, 104.13s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 213
For nerf, args.lrate = 1e-09, new_lrate = 9.980309283306376e-10, global_step = 214
                                                                                                                                                            At epoch  213 : train loss: 3057.2645, train psnr: 21.6203, val loss: 0.0076, val psnr: 20.4761
epochs:  11%|███████████████▊                                                                                                                                     | 213/2001 [6:12:16<51:43:13, 104.13s/it]Median error 0.20214558392763138m and 3.974923849105835 degrees.
Mean error 0.21722576935372132m and 5.618390969057315 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20214558392763138 val_loss =  0.007589449103783673
epochs:  11%|███████████████▉                                                                                                                                     | 214/2001 [6:12:21<51:40:18, 104.10s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 214
For nerf, args.lrate = 1e-09, new_lrate = 9.980217361684172e-10, global_step = 215
                                                                                                                                                            At epoch  214 : train loss: 3114.7855, train psnr: 21.4748, val loss: 0.0078, val psnr: 20.3792
epochs:  11%|███████████████▉                                                                                                                                     | 214/2001 [6:14:00<51:40:18, 104.10s/it]Median error 0.20422079414129257m and 3.9382206201553345 degrees.
Mean error 0.22152672051584069m and 5.605910964943619 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20422079414129257 val_loss =  0.007768092361671321
epochs:  11%|████████████████                                                                                                                                     | 215/2001 [6:14:05<51:37:51, 104.07s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 215
For nerf, args.lrate = 1e-09, new_lrate = 9.980125440908599e-10, global_step = 216
                                                                                                                                                            At epoch  215 : train loss: 3095.5457, train psnr: 21.4823, val loss: 0.0076, val psnr: 20.3412
epochs:  11%|████████████████                                                                                                                                     | 215/2001 [6:15:44<51:37:51, 104.07s/it]Median error 0.20070107281208038m and 3.8001335859298706 degrees.
Mean error 0.21670073296060324m and 5.554808945368658 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20070107281208038 val_loss =  0.0075911338488971495
epochs:  11%|████████████████                                                                                                                                     | 216/2001 [6:15:49<51:35:48, 104.06s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 216
For nerf, args.lrate = 1e-09, new_lrate = 9.98003352097964e-10, global_step = 217
                                                                                                                                                            At epoch  216 : train loss: 3299.6327, train psnr: 21.2858, val loss: 0.0076, val psnr: 20.9210
epochs:  11%|████████████████                                                                                                                                     | 216/2001 [6:17:28<51:35:48, 104.06s/it]Median error 0.2020675614476204m and 4.0081634521484375 degrees.
Mean error 0.21785017805407766m and 5.640256588471684 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2020675614476204 val_loss =  0.007609306661988776
epochs:  11%|████████████████▏                                                                                                                                    | 217/2001 [6:17:33<51:33:30, 104.04s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 217
For nerf, args.lrate = 1e-09, new_lrate = 9.97994160189729e-10, global_step = 218
                                                                                                                                                            At epoch  217 : train loss: 3090.1020, train psnr: 21.4604, val loss: 0.0077, val psnr: 20.7047
epochs:  11%|████████████████▏                                                                                                                                    | 217/2001 [6:19:12<51:33:30, 104.04s/it]Median error 0.20279601216316223m and 3.9852501153945923 degrees.
Mean error 0.2177493679959342m and 5.690200988278698 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20279601216316223 val_loss =  0.007653117428976418
epochs:  11%|████████████████▏                                                                                                                                    | 218/2001 [6:19:17<51:31:44, 104.04s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 218
For nerf, args.lrate = 1e-09, new_lrate = 9.979849683661546e-10, global_step = 219
                                                                                                                                                            At epoch  218 : train loss: 2982.8065, train psnr: 21.5928, val loss: 0.0076, val psnr: 20.6738
epochs:  11%|████████████████▏                                                                                                                                    | 218/2001 [6:20:56<51:31:44, 104.04s/it]Median error 0.20356512814760208m and 3.8517743349075317 degrees.
Mean error 0.21762971374157228m and 5.5838537079843915 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20356512814760208 val_loss =  0.007648085049183984
epochs:  11%|████████████████▎                                                                                                                                    | 219/2001 [6:21:01<51:29:12, 104.01s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 219
For nerf, args.lrate = 1e-09, new_lrate = 9.979757766272392e-10, global_step = 220
                                                                                                                                                            At epoch  219 : train loss: 3094.9294, train psnr: 21.5057, val loss: 0.0077, val psnr: 20.8156
epochs:  11%|████████████████▎                                                                                                                                    | 219/2001 [6:22:40<51:29:12, 104.01s/it]Median error 0.20246970653533936m and 4.044138193130493 degrees.
Mean error 0.21836891308472103m and 5.6064875706547666 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20246970653533936 val_loss =  0.0076514286395057
epochs:  11%|████████████████▍                                                                                                                                    | 220/2001 [6:22:45<51:25:26, 103.95s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 220
For nerf, args.lrate = 1e-09, new_lrate = 9.979665849729828e-10, global_step = 221
                                                                                                                                                            At epoch  220 : train loss: 3227.2902, train psnr: 21.4382, val loss: 0.0076, val psnr: 20.5398
epochs:  11%|████████████████▍                                                                                                                                    | 220/2001 [6:24:23<51:25:26, 103.95s/it]Median error 0.20435719937086105m and 3.963285207748413 degrees.
Mean error 0.21912503216853027m and 5.615356151587688 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20435719937086105 val_loss =  0.007600746745562279
                     Median error 0.20435719937086105m and 3.963285207748413 degrees.l loss: 0.1964
Mean error 0.21912503216853027m and 5.615356151587688 degrees.
epochs:  11%|████████████████▍                                                                                                                                    | 221/2001 [6:24:34<52:11:47, 105.57s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 221
For nerf, args.lrate = 1e-09, new_lrate = 9.97957393403384e-10, global_step = 222
                                                                                                                                                            At epoch  221 : train loss: 3092.9339, train psnr: 21.4674, val loss: 0.0077, val psnr: 19.5760
epochs:  11%|████████████████▍                                                                                                                                    | 221/2001 [6:26:13<52:11:47, 105.57s/it]Median error 0.20108848065137863m and 4.209729909896851 degrees.
Mean error 0.2174501055285998m and 5.799712464756329 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20108848065137863 val_loss =  0.007691036526078164
epochs:  11%|████████████████▌                                                                                                                                    | 222/2001 [6:26:19<51:57:27, 105.14s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 222
For nerf, args.lrate = 1e-09, new_lrate = 9.979482019184425e-10, global_step = 223
                                                                                                                                                            At epoch  222 : train loss: 3167.8414, train psnr: 21.4345, val loss: 0.0077, val psnr: 19.9665
epochs:  11%|████████████████▌                                                                                                                                    | 222/2001 [6:27:57<51:57:27, 105.14s/it]Median error 0.2037697359919548m and 3.943479895591736 degrees.
Mean error 0.21931339442156828m and 5.651513188624913 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2037697359919548 val_loss =  0.007664434500610685
epochs:  11%|████████████████▌                                                                                                                                    | 223/2001 [6:28:03<51:46:47, 104.84s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 223
For nerf, args.lrate = 1e-09, new_lrate = 9.979390105181574e-10, global_step = 224
                                                                                                                                                            At epoch  223 : train loss: 3306.3570, train psnr: 21.2528, val loss: 0.0076, val psnr: 20.5907
epochs:  11%|████████████████▌                                                                                                                                    | 223/2001 [6:29:41<51:46:47, 104.84s/it]Median error 0.20136427879333496m and 4.0085577964782715 degrees.
Mean error 0.21831491652137114m and 5.630582890469536 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20136427879333496 val_loss =  0.007631249249272868
epochs:  11%|████████████████▋                                                                                                                                    | 224/2001 [6:29:47<51:38:04, 104.61s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 224
For nerf, args.lrate = 1e-09, new_lrate = 9.979298192025277e-10, global_step = 225
                                                                                                                                                            At epoch  224 : train loss: 3229.1949, train psnr: 21.3673, val loss: 0.0076, val psnr: 20.1545
epochs:  11%|████████████████▋                                                                                                                                    | 224/2001 [6:31:25<51:38:04, 104.61s/it]Median error 0.20225440710783005m and 3.8297847509384155 degrees.
Mean error 0.21827574073891287m and 5.536705087764784 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20225440710783005 val_loss =  0.007568294620788859
epochs:  11%|████████████████▊                                                                                                                                    | 225/2001 [6:31:31<51:31:47, 104.45s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 225
For nerf, args.lrate = 1e-09, new_lrate = 9.979206279715527e-10, global_step = 226
                                                                                                                                                            At epoch  225 : train loss: 3192.0185, train psnr: 21.3634, val loss: 0.0077, val psnr: 20.3793
epochs:  11%|████████████████▊                                                                                                                                    | 225/2001 [6:33:10<51:31:47, 104.45s/it]Median error 0.20282506197690964m and 4.151408672332764 degrees.
Mean error 0.21858008935866569m and 5.744997946055312 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20282506197690964 val_loss =  0.007716424922242729
epochs:  11%|████████████████▊                                                                                                                                    | 226/2001 [6:33:15<51:27:09, 104.35s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 226
For nerf, args.lrate = 1e-09, new_lrate = 9.979114368252317e-10, global_step = 227
                                                                                                                                                            At epoch  226 : train loss: 3015.7022, train psnr: 21.5940, val loss: 0.0075, val psnr: 20.6950
epochs:  11%|████████████████▊                                                                                                                                    | 226/2001 [6:34:54<51:27:09, 104.35s/it]Median error 0.20049186795949936m and 3.8612369298934937 degrees.
Mean error 0.21571565728619513m and 5.578726084623863 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20049186795949936 val_loss =  0.007476600605860373
epochs:  11%|████████████████▉                                                                                                                                    | 227/2001 [6:34:59<51:24:52, 104.34s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 227
For nerf, args.lrate = 1e-09, new_lrate = 9.979022457635638e-10, global_step = 228
                                                                                                                                                            At epoch  227 : train loss: 3210.0554, train psnr: 21.3262, val loss: 0.0076, val psnr: 20.3867
epochs:  11%|████████████████▉                                                                                                                                    | 227/2001 [6:36:38<51:24:52, 104.34s/it]Median error 0.20201730728149414m and 3.768484950065613 degrees.
Mean error 0.21754172446228837m and 5.524164552630683 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20201730728149414 val_loss =  0.007558359388346399
epochs:  11%|████████████████▉                                                                                                                                    | 228/2001 [6:36:43<51:19:43, 104.22s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 228
For nerf, args.lrate = 1e-09, new_lrate = 9.978930547865485e-10, global_step = 229
epochs:  11%|████████████████▉                                                                                                                                    | 228/2001 [6:38:10<51:36:22, 104.78s/it]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 739, in train_feature_matching
    val_loss, val_psnr = eval_on_epoch(args, data_loaders, model, feat_model, hwf, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 245, in eval_on_epoch
    loss, psnr = eval_on_batch(args, data, model, feat_model, pose, img_idx, hwf, half_res, device, world_setup_dict, **render_kwargs_test)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 218, in eval_on_batch
    rgb, disp, acc, extras = render(H, W, focal, chunk=args.chunk, rays=batch_rays, img_idx=img_idx, **render_kwargs_test)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 399, in render
    all_ret = batchify_rays(rays, chunk, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 344, in batchify_rays
    ret = render_rays(rays_flat[i:i+chunk], **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 334, in render_rays
    if (torch.isnan(ret[k]).any() or torch.isinf(ret[k]).any()) and DEBUG:
KeyboardInterrupt
Best val loss: 0.1964
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [1, 100, 50000]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                        | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========


 ================ pose_loss = 5.391311333369231e-06, photo_loss = 0.00422254391014576, feat_loss=0.02989518642425537


 ================ pose_loss = 0.0002074460790026933, photo_loss = 0.02172408252954483, feat_loss=0.10100728273391724


 ================ pose_loss = 0.0002601047744974494, photo_loss = 0.04522367939352989, feat_loss=0.21164000034332275


 ================ pose_loss = 6.22505322098732e-05, photo_loss = 0.025740182027220726, feat_loss=0.1811465620994568


 ================ pose_loss = 3.118436870863661e-05, photo_loss = 0.01632288284599781, feat_loss=0.21106737852096558


 ================ pose_loss = 0.0005513603100553155, photo_loss = 0.07665067911148071, feat_loss=0.43639999628067017


 ================ pose_loss = 0.0005359337665140629, photo_loss = 0.07010649144649506, feat_loss=0.5073861479759216


 ================ pose_loss = 0.00020967642194591463, photo_loss = 0.014687413349747658, feat_loss=0.11527359485626221


 ================ pose_loss = 0.0007146010175347328, photo_loss = 0.07962112873792648, feat_loss=0.6922388076782227


 ================ pose_loss = 0.00031232857145369053, photo_loss = 0.035047080367803574, feat_loss=0.18539220094680786


 ================ pose_loss = 0.00045370435691438615, photo_loss = 0.039373185485601425, feat_loss=0.22347819805145264


 ================ pose_loss = 0.0023307939991354942, photo_loss = 0.049307312816381454, feat_loss=0.5102800726890564


 ================ pose_loss = 0.00026415588217787445, photo_loss = 0.05192771553993225, feat_loss=0.2587711215019226


 ================ pose_loss = 0.0002448073064442724, photo_loss = 0.07448183000087738, feat_loss=0.40698182582855225


 ================ pose_loss = 0.0011171576334163547, photo_loss = 0.03744952008128166, feat_loss=0.2068883180618286


 ================ pose_loss = 0.00028651009779423475, photo_loss = 0.026847556233406067, feat_loss=0.2546672821044922


 ================ pose_loss = 0.000782416551373899, photo_loss = 0.03039500117301941, feat_loss=0.12289249897003174


 ================ pose_loss = 0.00017337323515675962, photo_loss = 0.02561366744339466, feat_loss=0.18927228450775146
epochs:   0%|                                        | 0/2001 [00:08<?, ?it/s]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 408, in train_on_batch
    loss.backward()
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/autograd/__init__.py", line 175, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.1, 10, 5000]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 343, in train_on_batch
    _, pose_ = inference_pose_regression(args, data, device, model, retFeature=False)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 91, in inference_pose_regression
    features, predict_pose = model(inputs, return_feature=retFeature, isSingleStream=isSingleStream, return_pose=return_pose, upsampleH=H, upsampleW=W) # features: , predict_pose: [1, 12]
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/feature/dfnet.py", line 127, in forward
    x = self.encoder[i](x)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 444, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt

(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.1, 10, 5000]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 0
For nerf, args.lrate = 1e-09, new_lrate = 9.999907897020431e-10, global_step = 1
At epoch    0 : train loss: 369.1785, train psnr: 20.7585, val loss: 0.0074, val psnr: 19.9799                                                                                                             
epochs:   0%|                                                                                                                                                                     | 0/2001 [01:39<?, ?it/s]Median error 0.20199967920780182m and 3.9189865589141846 degrees.
Mean error 0.21510697286274388m and 5.6011096113908145 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20199967920780182 val_loss =  0.007445955567892833
                     Median error 0.20199967920780182m and 3.9189865589141846 degrees.
Mean error 0.21510697286274388m and 5.6011096113908145 degrees.
epochs:   0%|                                                                                                                                                         | 1/2001 [01:50<61:15:00, 110.25s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 1
For nerf, args.lrate = 1e-09, new_lrate = 9.999815794889158e-10, global_step = 2
At epoch    1 : train loss: 399.9503, train psnr: 20.4651, val loss: 0.0075, val psnr: 20.2820                                                                                                             
epochs:   0%|                                                                                                                                                         | 1/2001 [03:28<61:15:00, 110.25s/it]Median error 0.20241468399763107m and 3.9448739290237427 degrees.
Mean error 0.2174813122514952m and 5.5589894500338595 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20241468399763107 val_loss =  0.007524701550747607
epochs:   0%|▏                                                                                                                                                        | 2/2001 [03:33<60:07:34, 108.28s/it]
Best val loss: 0.2020
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 2
For nerf, args.lrate = 1e-09, new_lrate = 9.999723693606173e-10, global_step = 3
At epoch    2 : train loss: 401.7849, train psnr: 20.4835, val loss: 0.0075, val psnr: 19.4771                                                                                                             
epochs:   0%|▏                                                                                                                                                        | 2/2001 [05:12<60:07:34, 108.28s/it]Median error 0.20126952975988388m and 3.919391632080078 degrees.
Mean error 0.21553966387548307m and 5.621382153257426 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20126952975988388 val_loss =  0.007466493201504984
epochs:   0%|▏                                                                                                                                                        | 3/2001 [05:17<59:21:58, 106.97s/it]
Best val loss: 0.2013
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 3
For nerf, args.lrate = 1e-09, new_lrate = 9.999631593171468e-10, global_step = 4
At epoch    3 : train loss: 378.1435, train psnr: 20.7004, val loss: 0.0074, val psnr: 19.5356                                                                                                             
epochs:   0%|▏                                                                                                                                                        | 3/2001 [06:56<59:21:58, 106.97s/it]Median error 0.1994526982307434m and 3.738341808319092 degrees.
Mean error 0.2164655457918159m and 5.438450586231735 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1994526982307434 val_loss =  0.007435296382204189
epochs:   0%|▎                                                                                                                                                        | 4/2001 [07:01<58:50:05, 106.06s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 4
For nerf, args.lrate = 1e-09, new_lrate = 9.999539493585035e-10, global_step = 5
At epoch    4 : train loss: 369.4596, train psnr: 20.8080, val loss: 0.0077, val psnr: 20.4689                                                                                                             
epochs:   0%|▎                                                                                                                                                        | 4/2001 [08:40<58:50:05, 106.06s/it]Median error 0.20036976784467697m and 4.096356630325317 degrees.
Mean error 0.21808634401272667m and 5.759652016133915 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20036976784467697 val_loss =  0.007723228499826622
epochs:   0%|▍                                                                                                                                                        | 5/2001 [08:45<58:28:27, 105.46s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 5
For nerf, args.lrate = 1e-09, new_lrate = 9.999447394846867e-10, global_step = 6
At epoch    5 : train loss: 382.0315, train psnr: 20.6947, val loss: 0.0077, val psnr: 19.9475                                                                                                             
epochs:   0%|▍                                                                                                                                                        | 5/2001 [10:24<58:28:27, 105.46s/it]Median error 0.20711535960435867m and 3.77802312374115 degrees.
Mean error 0.22192665953415366m and 5.52714356659395 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20711535960435867 val_loss =  0.0077456651625590145
epochs:   0%|▍                                                                                                                                                        | 6/2001 [10:30<58:14:44, 105.11s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 6
For nerf, args.lrate = 1e-09, new_lrate = 9.999355296956957e-10, global_step = 7
At epoch    6 : train loss: 384.3689, train psnr: 20.6965, val loss: 0.0076, val psnr: 19.9786                                                                                                             
epochs:   0%|▍                                                                                                                                                        | 6/2001 [12:09<58:14:44, 105.11s/it]Median error 0.2027416154742241m and 3.970686435699463 degrees.
Mean error 0.21969949422396629m and 5.644526807945749 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2027416154742241 val_loss =  0.007638879188307917
epochs:   0%|▌                                                                                                                                                        | 7/2001 [12:15<58:13:08, 105.11s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 7
For nerf, args.lrate = 1e-09, new_lrate = 9.999263199915295e-10, global_step = 8
At epoch    7 : train loss: 366.3370, train psnr: 20.9482, val loss: 0.0076, val psnr: 20.5826                                                                                                             
epochs:   0%|▌                                                                                                                                                        | 7/2001 [13:54<58:13:08, 105.11s/it]Median error 0.20263022184371948m and 3.9065823554992676 degrees.
Mean error 0.21944336016636026m and 5.568793297899879 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20263022184371948 val_loss =  0.007629782516785133
epochs:   0%|▌                                                                                                                                                        | 8/2001 [14:00<58:08:02, 105.01s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 8
For nerf, args.lrate = 1e-09, new_lrate = 9.999171103721874e-10, global_step = 9
At epoch    8 : train loss: 369.9609, train psnr: 20.8150, val loss: 0.0077, val psnr: 20.5490                                                                                                             
epochs:   0%|▌                                                                                                                                                        | 8/2001 [15:38<58:08:02, 105.01s/it]Median error 0.20331574231386185m and 4.00396192073822 degrees.
Mean error 0.2172556498996642m and 5.708234005128807 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20331574231386185 val_loss =  0.007653336985254008
epochs:   0%|▋                                                                                                                                                        | 9/2001 [15:44<57:58:13, 104.77s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 9
For nerf, args.lrate = 1e-09, new_lrate = 9.999079008376687e-10, global_step = 10
At epoch    9 : train loss: 361.4831, train psnr: 20.8495, val loss: 0.0077, val psnr: 19.9035                                                                                                             
epochs:   0%|▋                                                                                                                                                        | 9/2001 [17:23<57:58:13, 104.77s/it]Median error 0.2019105777144432m and 3.862127900123596 degrees.
Mean error 0.2181726697425128m and 5.660896098927448 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2019105777144432 val_loss =  0.0077097829018627825
epochs:   0%|▊                                                                                                                                                       | 10/2001 [17:28<57:52:35, 104.65s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 10
For nerf, args.lrate = 1e-09, new_lrate = 9.998986913879722e-10, global_step = 11
At epoch   10 : train loss: 395.4052, train psnr: 20.7251, val loss: 0.0076, val psnr: 19.5144                                                                                                             
epochs:   0%|▊                                                                                                                                                       | 10/2001 [19:07<57:52:35, 104.65s/it]Median error 0.20502546429634094m and 3.869943380355835 degrees.
Mean error 0.22164156534501656m and 5.499734304935826 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20502546429634094 val_loss =  0.007617696814697028
epochs:   1%|▊                                                                                                                                                       | 11/2001 [19:13<57:49:15, 104.60s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 11
For nerf, args.lrate = 1e-09, new_lrate = 9.99889482023098e-10, global_step = 12
At epoch   11 : train loss: 349.8107, train psnr: 21.1134, val loss: 0.0077, val psnr: 19.6061                                                                                                             
epochs:   1%|▊                                                                                                                                                       | 11/2001 [20:51<57:49:15, 104.60s/it]Median error 0.2047390267252922m and 4.192734241485596 degrees.
Mean error 0.22022169758282933m and 5.71906297397517 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2047390267252922 val_loss =  0.007680861397492247
epochs:   1%|▉                                                                                                                                                       | 12/2001 [20:57<57:44:16, 104.50s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 12
For nerf, args.lrate = 1e-09, new_lrate = 9.998802727430445e-10, global_step = 13
At epoch   12 : train loss: 360.9545, train psnr: 20.9608, val loss: 0.0075, val psnr: 19.6582                                                                                                             
epochs:   1%|▉                                                                                                                                                       | 12/2001 [22:36<57:44:16, 104.50s/it]Median error 0.19958052039146423m and 4.081327438354492 degrees.
Mean error 0.21566952266711514m and 5.621089128438037 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19958052039146423 val_loss =  0.007506660867588117
epochs:   1%|▉                                                                                                                                                       | 13/2001 [22:41<57:39:35, 104.41s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 13
For nerf, args.lrate = 1e-09, new_lrate = 9.998710635478113e-10, global_step = 14
At epoch   13 : train loss: 395.0535, train psnr: 20.5760, val loss: 0.0076, val psnr: 20.5764                                                                                                             
epochs:   1%|▉                                                                                                                                                       | 13/2001 [24:20<57:39:35, 104.41s/it]Median error 0.20424625277519226m and 3.960026264190674 degrees.
Mean error 0.21719413960676806m and 5.576853803400448 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20424625277519226 val_loss =  0.007561563966828912
epochs:   1%|█                                                                                                                                                       | 14/2001 [24:25<57:37:06, 104.39s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 14
For nerf, args.lrate = 1e-09, new_lrate = 9.998618544373976e-10, global_step = 15
At epoch   14 : train loss: 382.2595, train psnr: 20.7769, val loss: 0.0076, val psnr: 20.6959                                                                                                             
epochs:   1%|█                                                                                                                                                       | 14/2001 [26:05<57:37:06, 104.39s/it]Median error 0.20240295678377151m and 3.7808233499526978 degrees.
Mean error 0.21738917004648853m and 5.49138528250369 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20240295678377151 val_loss =  0.007556284337227001
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [26:10<57:37:48, 104.47s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 15
For nerf, args.lrate = 1e-09, new_lrate = 9.998526454118023e-10, global_step = 16
At epoch   15 : train loss: 359.8555, train psnr: 20.9424, val loss: 0.0078, val psnr: 19.7676                                                                                                             
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [27:49<57:37:48, 104.47s/it]Median error 0.20376091450452805m and 3.9019763469696045 degrees.
Mean error 0.22139444258742727m and 5.6298837068411505 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20376091450452805 val_loss =  0.007794168131499738
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [27:54<57:33:33, 104.39s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 16
For nerf, args.lrate = 1e-09, new_lrate = 9.998434364710252e-10, global_step = 17
At epoch   16 : train loss: 315.8989, train psnr: 21.4070, val loss: 0.0076, val psnr: 19.9856                                                                                                             
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [29:33<57:33:33, 104.39s/it]Median error 0.20491589605808258m and 3.9166853427886963 degrees.
Mean error 0.21934801797092202m and 5.554356175727449 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20491589605808258 val_loss =  0.007610068220992432
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [29:39<57:31:01, 104.37s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 17
For nerf, args.lrate = 1e-09, new_lrate = 9.998342276150649e-10, global_step = 18
At epoch   17 : train loss: 362.8855, train psnr: 20.8826, val loss: 0.0077, val psnr: 18.9318                                                                                                             
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [31:17<57:31:01, 104.37s/it]Median error 0.20095104724168777m and 4.113140344619751 degrees.
Mean error 0.21853190360719013m and 5.730879675913678 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20095104724168777 val_loss =  0.0077244767497707464
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [31:23<57:28:18, 104.34s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 18
For nerf, args.lrate = 1e-09, new_lrate = 9.998250188439212e-10, global_step = 19
At epoch   18 : train loss: 398.0375, train psnr: 20.5319, val loss: 0.0077, val psnr: 19.9285                                                                                                             
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [33:02<57:28:18, 104.34s/it]Median error 0.20357204973697662m and 3.9316558837890625 degrees.
Mean error 0.2205463051117263m and 5.663238398187797 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20357204973697662 val_loss =  0.007713264715893153
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [33:07<57:28:38, 104.40s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 19
For nerf, args.lrate = 1e-09, new_lrate = 9.998158101575927e-10, global_step = 20
At epoch   19 : train loss: 402.4368, train psnr: 20.5433, val loss: 0.0075, val psnr: 19.7887                                                                                                             
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [34:46<57:28:38, 104.40s/it]Median error 0.20042914897203445m and 4.132978916168213 degrees.
Mean error 0.21701070301325215m and 5.672193969882693 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20042914897203445 val_loss =  0.007516483824257314
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [34:52<57:27:36, 104.42s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 20
For nerf, args.lrate = 1e-09, new_lrate = 9.998066015560792e-10, global_step = 21
At epoch   20 : train loss: 384.5165, train psnr: 20.7197, val loss: 0.0076, val psnr: 19.2815                                                                                                             
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [36:31<57:27:36, 104.42s/it]Median error 0.2046799510717392m and 3.950823187828064 degrees.
Mean error 0.2184430743051082m and 5.5981087636971765 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2046799510717392 val_loss =  0.007620629770782595
                     Median error 0.2046799510717392m and 3.950823187828064 degrees.
Mean error 0.2184430743051082m and 5.5981087636971765 degrees.
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [36:42<58:19:37, 106.05s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 21
For nerf, args.lrate = 1e-09, new_lrate = 9.997973930393796e-10, global_step = 22
At epoch   21 : train loss: 443.3369, train psnr: 20.1629, val loss: 0.0076, val psnr: 20.2438                                                                                                             
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [38:21<58:19:37, 106.05s/it]Median error 0.2033618912100792m and 3.7513062953948975 degrees.
Mean error 0.2189565003710056m and 5.477618404305899 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2033618912100792 val_loss =  0.007570734862958106
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [38:26<58:01:36, 105.56s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 22
For nerf, args.lrate = 1e-09, new_lrate = 9.99788184607493e-10, global_step = 23
At epoch   22 : train loss: 373.9706, train psnr: 20.9545, val loss: 0.0075, val psnr: 20.0980                                                                                                             
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [40:05<58:01:36, 105.56s/it]Median error 0.20169109106063843m and 3.779064178466797 degrees.
Mean error 0.21747506158765753m and 5.474924404189172 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20169109106063843 val_loss =  0.0074884364886655
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [40:10<57:47:02, 105.17s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 23
For nerf, args.lrate = 1e-09, new_lrate = 9.99778976260419e-10, global_step = 24
At epoch   23 : train loss: 384.6211, train psnr: 20.8788, val loss: 0.0076, val psnr: 19.4113                                                                                                             
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [41:49<57:47:02, 105.17s/it]Median error 0.20469123870134354m and 3.9283695220947266 degrees.
Mean error 0.21975792355473467m and 5.570360232642305 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20469123870134354 val_loss =  0.00758981909166323
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [41:55<57:38:07, 104.95s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 24
For nerf, args.lrate = 1e-09, new_lrate = 9.997697679981565e-10, global_step = 25
At epoch   24 : train loss: 347.9347, train psnr: 21.1361, val loss: 0.0076, val psnr: 20.1084                                                                                                             
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [43:34<57:38:07, 104.95s/it]Median error 0.20006417483091354m and 3.9294649362564087 degrees.
Mean error 0.2171966360414378m and 5.581301688785977 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20006417483091354 val_loss =  0.00760301076909004
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [43:39<57:29:57, 104.76s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 25
For nerf, args.lrate = 1e-09, new_lrate = 9.99760559820705e-10, global_step = 26
At epoch   25 : train loss: 377.6566, train psnr: 20.8385, val loss: 0.0078, val psnr: 20.3247                                                                                                             
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [45:18<57:29:57, 104.76s/it]Median error 0.20219797641038895m and 3.8625513315200806 degrees.
Mean error 0.22064821814612942m and 5.583795439813905 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20219797641038895 val_loss =  0.007789856501308111
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [45:23<57:23:55, 104.63s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 26
For nerf, args.lrate = 1e-09, new_lrate = 9.997513517280636e-10, global_step = 27
At epoch   26 : train loss: 345.2825, train psnr: 21.0561, val loss: 0.0077, val psnr: 20.1606                                                                                                             
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [47:02<57:23:55, 104.63s/it]Median error 0.2021608203649521m and 3.7802025079727173 degrees.
Mean error 0.22037571782872142m and 5.524888405644218 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2021608203649521 val_loss =  0.007650192468446564
epochs:   1%|██                                                                                                                                                      | 27/2001 [47:08<57:19:14, 104.54s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 27
For nerf, args.lrate = 1e-09, new_lrate = 9.997421437202313e-10, global_step = 28
At epoch   27 : train loss: 382.7960, train psnr: 20.6457, val loss: 0.0077, val psnr: 19.9198                                                                                                             
epochs:   1%|██                                                                                                                                                      | 27/2001 [48:47<57:19:14, 104.54s/it]Median error 0.20434928685426712m and 4.013826847076416 degrees.
Mean error 0.2213799931252232m and 5.597804643123256 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20434928685426712 val_loss =  0.007737125654413006
epochs:   1%|██▏                                                                                                                                                     | 28/2001 [48:52<57:15:31, 104.48s/it]
Best val loss: 0.1995
 ==== Origional DFnet training in train_on_epoch==========
epochs:   1%|██▏                                                                                                                                                     | 28/2001 [49:33<58:11:53, 106.19s/it]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 408, in train_on_batch
    loss.backward()
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/autograd/__init__.py", line 175, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Best val loss: 0.1995
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.1, 10, 5000]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 0
For nerf, args.lrate = 1e-09, new_lrate = 9.999907897020431e-10, global_step = 1
At epoch    0 : train loss: 1915.8884, train psnr: 12.9565, val loss: 0.0109, val psnr: 13.3909                                                                                                            
epochs:   0%|                                                                                                                                                                     | 0/2001 [01:40<?, ?it/s]Median error 0.19814752042293549m and 7.425028324127197 degrees.
Mean error 0.23408837239012906m and 9.007173458453615 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19814752042293549 val_loss =  0.01089631487055246
                     Median error 0.19814752042293549m and 7.425028324127197 degrees.
Mean error 0.23408837239012906m and 9.007173458453615 degrees.
epochs:   0%|                                                                                                                                                         | 1/2001 [01:51<61:40:15, 111.01s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 1
For nerf, args.lrate = 1e-09, new_lrate = 9.999815794889158e-10, global_step = 2
At epoch    1 : train loss: 1876.9706, train psnr: 12.9919, val loss: 0.0107, val psnr: 12.3991                                                                                                            
epochs:   0%|                                                                                                                                                         | 1/2001 [03:30<61:40:15, 111.01s/it]Median error 0.20585188269615173m and 6.87692403793335 degrees.
Mean error 0.2351345960013116m and 8.269773774784104 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20585188269615173 val_loss =  0.010737850333303345
epochs:   0%|▏                                                                                                                                                        | 2/2001 [03:35<60:33:06, 109.05s/it]
Best val loss: 0.1981
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 2
For nerf, args.lrate = 1e-09, new_lrate = 9.999723693606173e-10, global_step = 3
At epoch    2 : train loss: 1812.8104, train psnr: 12.9985, val loss: 0.0088, val psnr: 12.8590                                                                                                            
epochs:   0%|▏                                                                                                                                                        | 2/2001 [05:14<60:33:06, 109.05s/it]Median error 0.20781075209379196m and 6.271875381469727 degrees.
Mean error 0.2295460929898055m and 7.38220953651768 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20781075209379196 val_loss =  0.008822737622328351
epochs:   0%|▏                                                                                                                                                        | 3/2001 [05:20<59:46:16, 107.70s/it]
Best val loss: 0.1981
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 3
For nerf, args.lrate = 1e-09, new_lrate = 9.999631593171468e-10, global_step = 4
At epoch    3 : train loss: 1877.9422, train psnr: 12.9781, val loss: 0.0145, val psnr: 12.2184                                                                                                            
epochs:   0%|▏                                                                                                                                                        | 3/2001 [06:58<59:46:16, 107.70s/it]Median error 0.2401292473077774m and 8.974839687347412 degrees.
Mean error 0.28391738512707865m and 9.935537384106564 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2401292473077774 val_loss =  0.014546052109309178
epochs:   0%|▎                                                                                                                                                        | 4/2001 [07:04<59:09:10, 106.64s/it]
Best val loss: 0.1981
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 4
For nerf, args.lrate = 1e-09, new_lrate = 9.999539493585035e-10, global_step = 5
At epoch    4 : train loss: 1656.2203, train psnr: 13.3916, val loss: 0.0101, val psnr: 13.6542                                                                                                            
epochs:   0%|▎                                                                                                                                                        | 4/2001 [08:43<59:09:10, 106.64s/it]Median error 0.2287684604525566m and 5.52062201499939 degrees.
Mean error 0.2587707970434657m and 7.070801898113147 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2287684604525566 val_loss =  0.010129210106846556
epochs:   0%|▍                                                                                                                                                        | 5/2001 [08:48<58:45:04, 105.96s/it]
Best val loss: 0.1981
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 5
For nerf, args.lrate = 1e-09, new_lrate = 9.999447394846867e-10, global_step = 6
At epoch    5 : train loss: 1588.5489, train psnr: 13.7225, val loss: 0.0094, val psnr: 13.4474                                                                                                            
epochs:   0%|▍                                                                                                                                                        | 5/2001 [10:27<58:45:04, 105.96s/it]Median error 0.19499587267637253m and 6.951979637145996 degrees.
Mean error 0.21870798430582772m and 7.868018746677681 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19499587267637253 val_loss =  0.009418245781511625
epochs:   0%|▍                                                                                                                                                        | 6/2001 [10:32<58:27:46, 105.50s/it]
Best val loss: 0.1950
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 6
For nerf, args.lrate = 1e-09, new_lrate = 9.999355296956957e-10, global_step = 7
At epoch    6 : train loss: 1535.8665, train psnr: 13.8381, val loss: 0.0077, val psnr: 12.7116                                                                                                            
epochs:   0%|▍                                                                                                                                                        | 6/2001 [12:11<58:27:46, 105.50s/it]Median error 0.15461326390504837m and 5.80099630355835 degrees.
Mean error 0.178509397811147m and 7.127011819226056 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.15461326390504837 val_loss =  0.007747836802428143
epochs:   0%|▌                                                                                                                                                        | 7/2001 [12:17<58:14:16, 105.14s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 7
For nerf, args.lrate = 1e-09, new_lrate = 9.999263199915295e-10, global_step = 8
At epoch    7 : train loss: 1637.5074, train psnr: 13.7006, val loss: 0.0110, val psnr: 14.4016                                                                                                            
epochs:   0%|▌                                                                                                                                                        | 7/2001 [13:56<58:14:16, 105.14s/it]Median error 0.2108456715941429m and 6.22834038734436 degrees.
Mean error 0.25784545460044733m and 7.453347606456232 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2108456715941429 val_loss =  0.010964972487670135
epochs:   0%|▌                                                                                                                                                        | 8/2001 [14:01<58:04:40, 104.91s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 8
For nerf, args.lrate = 1e-09, new_lrate = 9.999171103721874e-10, global_step = 9
At epoch    8 : train loss: 1537.2969, train psnr: 13.8241, val loss: 0.0134, val psnr: 14.6932                                                                                                            
epochs:   0%|▌                                                                                                                                                        | 8/2001 [15:40<58:04:40, 104.91s/it]Median error 0.2192278727889061m and 6.80629825592041 degrees.
Mean error 0.25931627115966216m and 9.011578476380723 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2192278727889061 val_loss =  0.013355907521509662
epochs:   0%|▋                                                                                                                                                        | 9/2001 [15:45<57:56:30, 104.71s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 9
For nerf, args.lrate = 1e-09, new_lrate = 9.999079008376687e-10, global_step = 10
At epoch    9 : train loss: 1398.1602, train psnr: 14.3473, val loss: 0.0121, val psnr: 14.0753                                                                                                            
epochs:   0%|▋                                                                                                                                                        | 9/2001 [17:24<57:56:30, 104.71s/it]Median error 0.22589226067066193m and 6.068825721740723 degrees.
Mean error 0.2657647568747582m and 7.939533774126397 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22589226067066193 val_loss =  0.012145088590009455
epochs:   0%|▊                                                                                                                                                       | 10/2001 [17:30<57:51:57, 104.63s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 10
For nerf, args.lrate = 1e-09, new_lrate = 9.998986913879722e-10, global_step = 11
At epoch   10 : train loss: 1331.7027, train psnr: 14.4074, val loss: 0.0107, val psnr: 14.3818                                                                                                            
epochs:   0%|▊                                                                                                                                                       | 10/2001 [19:09<57:51:57, 104.63s/it]Median error 0.21312548965215683m and 5.870566129684448 degrees.
Mean error 0.24632672382413073m and 7.584939979589903 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21312548965215683 val_loss =  0.010721304001459717
epochs:   1%|▊                                                                                                                                                       | 11/2001 [19:14<57:49:19, 104.60s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 11
For nerf, args.lrate = 1e-09, new_lrate = 9.99889482023098e-10, global_step = 12
At epoch   11 : train loss: 1373.1211, train psnr: 14.3675, val loss: 0.0101, val psnr: 14.4717                                                                                                            
epochs:   1%|▊                                                                                                                                                       | 11/2001 [20:53<57:49:19, 104.60s/it]Median error 0.22740686684846878m and 5.767627716064453 degrees.
Mean error 0.25243460216186187m and 7.012521673612267 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22740686684846878 val_loss =  0.010128572402536814
epochs:   1%|▉                                                                                                                                                       | 12/2001 [20:59<57:46:20, 104.57s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 12
For nerf, args.lrate = 1e-09, new_lrate = 9.998802727430445e-10, global_step = 13
At epoch   12 : train loss: 1283.9030, train psnr: 14.6978, val loss: 0.0101, val psnr: 15.1177                                                                                                            
epochs:   1%|▉                                                                                                                                                       | 12/2001 [22:38<57:46:20, 104.57s/it]Median error 0.2271585837006569m and 5.090357303619385 degrees.
Mean error 0.2476199901198991m and 6.872777924198009 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2271585837006569 val_loss =  0.010114427091120667
epochs:   1%|▉                                                                                                                                                       | 13/2001 [22:43<57:43:27, 104.53s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 13
For nerf, args.lrate = 1e-09, new_lrate = 9.998710635478113e-10, global_step = 14
At epoch   13 : train loss: 1292.3627, train psnr: 14.6323, val loss: 0.0090, val psnr: 15.6845                                                                                                            
epochs:   1%|▉                                                                                                                                                       | 13/2001 [24:22<57:43:27, 104.53s/it]Median error 0.20071569085121155m and 5.099121570587158 degrees.
Mean error 0.2255093966373186m and 6.796215726477414 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20071569085121155 val_loss =  0.008982379494120861
epochs:   1%|█                                                                                                                                                       | 14/2001 [24:28<57:40:17, 104.49s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 14
For nerf, args.lrate = 1e-09, new_lrate = 9.998618544373976e-10, global_step = 15
At epoch   14 : train loss: 1187.5120, train psnr: 15.1402, val loss: 0.0097, val psnr: 14.9668                                                                                                            
epochs:   1%|█                                                                                                                                                       | 14/2001 [26:07<57:40:17, 104.49s/it]Median error 0.21145742386579514m and 4.6287055015563965 degrees.
Mean error 0.24038442335494978m and 6.684651671000096 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21145742386579514 val_loss =  0.009672363099820256
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [26:12<57:38:19, 104.48s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 15
For nerf, args.lrate = 1e-09, new_lrate = 9.998526454118023e-10, global_step = 16
At epoch   15 : train loss: 1236.3774, train psnr: 14.9198, val loss: 0.0099, val psnr: 15.2590                                                                                                            
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [27:51<57:38:19, 104.48s/it]Median error 0.20104099810123444m and 5.129970550537109 degrees.
Mean error 0.23295002078320756m and 7.1017939752412715 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20104099810123444 val_loss =  0.009871452880136564
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [27:56<57:34:30, 104.42s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 16
For nerf, args.lrate = 1e-09, new_lrate = 9.998434364710252e-10, global_step = 17
At epoch   16 : train loss: 1297.9247, train psnr: 14.6863, val loss: 0.0107, val psnr: 14.2044                                                                                                            
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [29:35<57:34:30, 104.42s/it]Median error 0.22841276228427887m and 5.306641578674316 degrees.
Mean error 0.26377052915195826m and 6.849355371766968 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22841276228427887 val_loss =  0.01066212848817217
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [29:41<57:30:51, 104.36s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 17
For nerf, args.lrate = 1e-09, new_lrate = 9.998342276150649e-10, global_step = 18
At epoch   17 : train loss: 1294.9909, train psnr: 14.8035, val loss: 0.0108, val psnr: 13.7081                                                                                                            
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [31:20<57:30:51, 104.36s/it]Median error 0.2176191806793213m and 5.327404260635376 degrees.
Mean error 0.2515215884539702m and 7.156927296507214 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2176191806793213 val_loss =  0.010811694864733809
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [31:25<57:30:15, 104.40s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 18
For nerf, args.lrate = 1e-09, new_lrate = 9.998250188439212e-10, global_step = 19
At epoch   18 : train loss: 1151.6373, train psnr: 15.3169, val loss: 0.0086, val psnr: 15.7289                                                                                                            
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [33:04<57:30:15, 104.40s/it]Median error 0.2053385078907013m and 4.831942558288574 degrees.
Mean error 0.21973315594333265m and 6.576546408356684 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2053385078907013 val_loss =  0.008621215392710067
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [33:10<57:29:16, 104.42s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 19
For nerf, args.lrate = 1e-09, new_lrate = 9.998158101575927e-10, global_step = 20
At epoch   19 : train loss: 1174.5844, train psnr: 15.2323, val loss: 0.0094, val psnr: 14.9236                                                                                                            
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [34:48<57:29:16, 104.42s/it]Median error 0.188961960375309m and 5.406331300735474 degrees.
Mean error 0.22956021152896738m and 6.7101149639559665 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.188961960375309 val_loss =  0.009438458539300804
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [34:54<57:25:46, 104.36s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 20
For nerf, args.lrate = 1e-09, new_lrate = 9.998066015560792e-10, global_step = 21
At epoch   20 : train loss: 1230.9482, train psnr: 15.0377, val loss: 0.0091, val psnr: 15.6108                                                                                                            
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [36:33<57:25:46, 104.36s/it]Median error 0.19900232553482056m and 5.109018087387085 degrees.
Mean error 0.23487046891107008m and 6.4520439595466685 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19900232553482056 val_loss =  0.009147977719268657
                     Median error 0.19900232553482056m and 5.109018087387085 degrees.
Mean error 0.23487046891107008m and 6.4520439595466685 degrees.
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [36:44<58:19:17, 106.04s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 21
For nerf, args.lrate = 1e-09, new_lrate = 9.997973930393796e-10, global_step = 22
At epoch   21 : train loss: 1101.2150, train psnr: 15.4640, val loss: 0.0092, val psnr: 15.5243                                                                                                            
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [38:23<58:19:17, 106.04s/it]Median error 0.20701517164707184m and 4.369861125946045 degrees.
Mean error 0.23730838360257356m and 6.247520186700801 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20701517164707184 val_loss =  0.009193765394295837
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [38:28<58:02:35, 105.59s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 22
For nerf, args.lrate = 1e-09, new_lrate = 9.99788184607493e-10, global_step = 23
At epoch   22 : train loss: 1135.3631, train psnr: 15.4514, val loss: 0.0096, val psnr: 15.4527                                                                                                            
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [40:07<58:02:35, 105.59s/it]Median error 0.2105083018541336m and 4.728521347045898 degrees.
Mean error 0.24204053971841027m and 6.561676074799738 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2105083018541336 val_loss =  0.00957287326389132
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [40:13<57:49:16, 105.24s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 23
For nerf, args.lrate = 1e-09, new_lrate = 9.99778976260419e-10, global_step = 24
At epoch   23 : train loss: 1034.7497, train psnr: 15.7312, val loss: 0.0081, val psnr: 16.1131                                                                                                            
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [41:53<57:49:16, 105.24s/it]Median error 0.19595812261104584m and 4.71359658241272 degrees.
Mean error 0.2189323025895094m and 6.414075411041739 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19595812261104584 val_loss =  0.008140498511094944
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [41:58<57:48:21, 105.26s/it]
Best val loss: 0.1546
 ==== Origional DFnet training in train_on_epoch==========
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [42:42<58:38:17, 106.78s/it]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 356, in train_on_batch
    rgb, disp, acc, extras = render(H//4, W//4, focal/4, chunk=args.chunk, c2w=pose_nerf[0,:3,:4], img_idx=img_idx, **render_kwargs_train)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 399, in render
    all_ret = batchify_rays(rays, chunk, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 344, in batchify_rays
    ret = render_rays(rays_flat[i:i+chunk], **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 313, in render_rays
    raw = network_query_fn(pts, viewdirs, img_idxs, network_fine, 'fine', embedding_a, embedding_t, output_transient, test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 441, in <lambda>
    test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 99, in run_network_NeRFW
    out_chunks += [fn(torch.cat(embedded_inputs, 1), output_transient=output_transient)]
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 353, in forward
    transient_encoding = self.transient_encoding(transient_encoding_input)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Best val loss: 0.1546
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0067-0.1964.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.01, 1, 500]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 343, in train_on_batch
    _, pose_ = inference_pose_regression(args, data, device, model, retFeature=False)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 91, in inference_pose_regression
    features, predict_pose = model(inputs, return_feature=retFeature, isSingleStream=isSingleStream, return_pose=return_pose, upsampleH=H, upsampleW=W) # features: , predict_pose: [1, 12]
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/feature/dfnet.py", line 127, in forward
    x = self.encoder[i](x)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 444, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt

(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.0001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0006-0.1546.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0006-0.1546.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.01, 1, 500]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 0
For nerf, args.lrate = 1e-09, new_lrate = 9.999907897020431e-10, global_step = 1
At epoch    0 : train loss: 155.6942, train psnr: 13.6951, val loss: 0.0102, val psnr: 14.6127                                                                                                             
epochs:   0%|                                                                                                                                                                     | 0/2001 [01:39<?, ?it/s]Median error 0.22685115039348602m and 5.621741771697998 degrees.
Mean error 0.24856720196633686m and 7.129978001178035 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22685115039348602 val_loss =  0.01021169637371588
                     Median error 0.22685115039348602m and 5.621741771697998 degrees.
Mean error 0.24856720196633686m and 7.129978001178035 degrees.
epochs:   0%|                                                                                                                                                         | 1/2001 [01:50<61:21:21, 110.44s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 1
For nerf, args.lrate = 1e-09, new_lrate = 9.999815794889158e-10, global_step = 2
At epoch    1 : train loss: 145.5935, train psnr: 14.2199, val loss: 0.0108, val psnr: 13.5098                                                                                                             
epochs:   0%|                                                                                                                                                         | 1/2001 [03:28<61:21:21, 110.44s/it]Median error 0.2387363240122795m and 6.8660972118377686 degrees.
Mean error 0.2576890191504438m and 7.773912631880175 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2387363240122795 val_loss =  0.010832688419909739
epochs:   0%|▏                                                                                                                                                        | 2/2001 [03:34<60:11:17, 108.39s/it]
Best val loss: 0.2269
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 2
For nerf, args.lrate = 1e-09, new_lrate = 9.999723693606173e-10, global_step = 3
At epoch    2 : train loss: 145.3983, train psnr: 13.9903, val loss: 0.0097, val psnr: 14.6786                                                                                                             
epochs:   0%|▏                                                                                                                                                        | 2/2001 [05:12<60:11:17, 108.39s/it]Median error 0.21534106880426407m and 6.158167123794556 degrees.
Mean error 0.23602571498851485m and 7.732198706763959 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21534106880426407 val_loss =  0.009718369897822604
epochs:   0%|▏                                                                                                                                                        | 3/2001 [05:17<59:22:42, 106.99s/it]
Best val loss: 0.2153
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 3
For nerf, args.lrate = 1e-09, new_lrate = 9.999631593171468e-10, global_step = 4
At epoch    3 : train loss: 138.6764, train psnr: 14.3431, val loss: 0.0092, val psnr: 13.3786                                                                                                             
epochs:   0%|▏                                                                                                                                                        | 3/2001 [06:55<59:22:42, 106.99s/it]Median error 0.20289751142263412m and 5.334968566894531 degrees.
Mean error 0.22584390703226753m and 6.8914694234065195 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20289751142263412 val_loss =  0.009168344260637507
epochs:   0%|▎                                                                                                                                                        | 4/2001 [07:01<58:47:51, 105.99s/it]
Best val loss: 0.2029
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 4
For nerf, args.lrate = 1e-09, new_lrate = 9.999539493585035e-10, global_step = 5
At epoch    4 : train loss: 141.1618, train psnr: 14.3221, val loss: 0.0119, val psnr: 14.4558                                                                                                             
epochs:   0%|▎                                                                                                                                                        | 4/2001 [08:39<58:47:51, 105.99s/it]Median error 0.22162067890167236m and 6.4350645542144775 degrees.
Mean error 0.26354341559971756m and 8.086144947933281 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22162067890167236 val_loss =  0.011929112994208695
epochs:   0%|▍                                                                                                                                                        | 5/2001 [08:45<58:24:34, 105.35s/it]
Best val loss: 0.2029
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 5
For nerf, args.lrate = 1e-09, new_lrate = 9.999447394846867e-10, global_step = 6
At epoch    5 : train loss: 129.4541, train psnr: 14.5682, val loss: 0.0110, val psnr: 14.0064                                                                                                             
epochs:   0%|▍                                                                                                                                                        | 5/2001 [10:23<58:24:34, 105.35s/it]Median error 0.2167762890458107m and 6.0571722984313965 degrees.
Mean error 0.24891347374374928m and 7.775264018882624 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2167762890458107 val_loss =  0.010964042110380864
epochs:   0%|▍                                                                                                                                                        | 6/2001 [10:28<58:06:01, 104.84s/it]
Best val loss: 0.2029
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 6
For nerf, args.lrate = 1e-09, new_lrate = 9.999355296956957e-10, global_step = 7
At epoch    6 : train loss: 128.5465, train psnr: 14.7193, val loss: 0.0107, val psnr: 14.6745                                                                                                             
epochs:   0%|▍                                                                                                                                                        | 6/2001 [12:07<58:06:01, 104.84s/it]Median error 0.2216603383421898m and 6.18911600112915 degrees.
Mean error 0.25763504483137534m and 7.234969598260003 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2216603383421898 val_loss =  0.010653121717895621
epochs:   0%|▌                                                                                                                                                        | 7/2001 [12:12<57:52:32, 104.49s/it]
Best val loss: 0.2029
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 7
For nerf, args.lrate = 1e-09, new_lrate = 9.999263199915295e-10, global_step = 8
At epoch    7 : train loss: 123.7815, train psnr: 14.8431, val loss: 0.0094, val psnr: 15.4456                                                                                                             
epochs:   0%|▌                                                                                                                                                        | 7/2001 [13:50<57:52:32, 104.49s/it]Median error 0.20176994055509567m and 4.964770317077637 degrees.
Mean error 0.22904336484910748m and 6.858208381695303 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20176994055509567 val_loss =  0.009430768868276993
epochs:   0%|▌                                                                                                                                                        | 8/2001 [13:56<57:40:28, 104.18s/it]
Best val loss: 0.2018
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 8
For nerf, args.lrate = 1e-09, new_lrate = 9.999171103721874e-10, global_step = 9
At epoch    8 : train loss: 117.5511, train psnr: 15.0092, val loss: 0.0097, val psnr: 15.1837                                                                                                             
epochs:   0%|▌                                                                                                                                                        | 8/2001 [15:34<57:40:28, 104.18s/it]Median error 0.22013958543539047m and 4.681672096252441 degrees.
Mean error 0.23856566729861112m and 6.829707034625987 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22013958543539047 val_loss =  0.009727972228825186
epochs:   0%|▋                                                                                                                                                        | 9/2001 [15:39<57:33:49, 104.03s/it]
Best val loss: 0.2018
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 9
For nerf, args.lrate = 1e-09, new_lrate = 9.999079008376687e-10, global_step = 10
At epoch    9 : train loss: 119.8910, train psnr: 14.9230, val loss: 0.0090, val psnr: 14.9024                                                                                                             
epochs:   0%|▋                                                                                                                                                        | 9/2001 [17:17<57:33:49, 104.03s/it]Median error 0.20626694709062576m and 4.700204610824585 degrees.
Mean error 0.23440020238822287m and 6.5643739086172355 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20626694709062576 val_loss =  0.008999212312745166
epochs:   0%|▊                                                                                                                                                       | 10/2001 [17:23<57:26:37, 103.87s/it]
Best val loss: 0.2018
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 10
For nerf, args.lrate = 1e-09, new_lrate = 9.998986913879722e-10, global_step = 11
At epoch   10 : train loss: 109.7296, train psnr: 15.5060, val loss: 0.0094, val psnr: 14.4061                                                                                                             
epochs:   0%|▊                                                                                                                                                       | 10/2001 [19:01<57:26:37, 103.87s/it]Median error 0.21246182918548584m and 4.356061935424805 degrees.
Mean error 0.2359283271411562m and 6.622511419328118 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21246182918548584 val_loss =  0.009404964088234883
epochs:   1%|▊                                                                                                                                                       | 11/2001 [19:06<57:21:31, 103.76s/it]
Best val loss: 0.2018
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 11
For nerf, args.lrate = 1e-09, new_lrate = 9.99889482023098e-10, global_step = 12
At epoch   11 : train loss: 120.0405, train psnr: 15.0858, val loss: 0.0081, val psnr: 13.4584                                                                                                             
epochs:   1%|▊                                                                                                                                                       | 11/2001 [20:44<57:21:31, 103.76s/it]Median error 0.19879143685102463m and 5.617696523666382 degrees.
Mean error 0.20817765756792989m and 7.013445421947762 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19879143685102463 val_loss =  0.008131661212187485
epochs:   1%|▉                                                                                                                                                       | 12/2001 [20:50<57:17:16, 103.69s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 12
For nerf, args.lrate = 1e-09, new_lrate = 9.998802727430445e-10, global_step = 13
At epoch   12 : train loss: 121.2909, train psnr: 14.9421, val loss: 0.0102, val psnr: 15.1296                                                                                                             
epochs:   1%|▉                                                                                                                                                       | 12/2001 [22:28<57:17:16, 103.69s/it]Median error 0.22077244520187378m and 5.367225885391235 degrees.
Mean error 0.2408464314823269m and 7.269169574143433 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22077244520187378 val_loss =  0.010158805106772414
epochs:   1%|▉                                                                                                                                                       | 13/2001 [22:34<57:16:28, 103.72s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 13
For nerf, args.lrate = 1e-09, new_lrate = 9.998710635478113e-10, global_step = 14
At epoch   13 : train loss: 119.6344, train psnr: 15.0774, val loss: 0.0116, val psnr: 15.1170                                                                                                             
epochs:   1%|▉                                                                                                                                                       | 13/2001 [24:12<57:16:28, 103.72s/it]Median error 0.20912500470876694m and 6.56403923034668 degrees.
Mean error 0.2546200664876112m and 8.01356950718985 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20912500470876694 val_loss =  0.011582887831794689
epochs:   1%|█                                                                                                                                                       | 14/2001 [24:17<57:14:13, 103.70s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 14
For nerf, args.lrate = 1e-09, new_lrate = 9.998618544373976e-10, global_step = 15
At epoch   14 : train loss: 106.1258, train psnr: 15.7446, val loss: 0.0095, val psnr: 15.1090                                                                                                             
epochs:   1%|█                                                                                                                                                       | 14/2001 [25:56<57:14:13, 103.70s/it]Median error 0.21548347175121307m and 4.998090028762817 degrees.
Mean error 0.24578174704927122m and 6.467138882198555 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21548347175121307 val_loss =  0.009526097511139515
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [26:01<57:13:57, 103.74s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 15
For nerf, args.lrate = 1e-09, new_lrate = 9.998526454118023e-10, global_step = 16
At epoch   15 : train loss: 112.0112, train psnr: 15.2525, val loss: 0.0101, val psnr: 14.4657                                                                                                             
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [27:39<57:13:57, 103.74s/it]Median error 0.21850315481424332m and 5.421876907348633 degrees.
Mean error 0.2488937054794689m and 7.162436890216009 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21850315481424332 val_loss =  0.010106745459868003
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [27:45<57:09:29, 103.66s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 16
For nerf, args.lrate = 1e-09, new_lrate = 9.998434364710252e-10, global_step = 17
At epoch   16 : train loss: 108.0654, train psnr: 15.4352, val loss: 0.0101, val psnr: 13.9691                                                                                                             
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [29:23<57:09:29, 103.66s/it]Median error 0.23279736191034317m and 4.960972309112549 degrees.
Mean error 0.26004662439377924m and 6.483837075380661 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.23279736191034317 val_loss =  0.01010205944437889
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [29:28<57:08:17, 103.68s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 17
For nerf, args.lrate = 1e-09, new_lrate = 9.998342276150649e-10, global_step = 18
At epoch   17 : train loss: 118.1310, train psnr: 15.2030, val loss: 0.0114, val psnr: 15.2381                                                                                                             
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [31:06<57:08:17, 103.68s/it]Median error 0.2143191248178482m and 5.644187927246094 degrees.
Mean error 0.25191477052716593m and 7.706544498079701 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2143191248178482 val_loss =  0.011375646242402448
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [31:12<57:05:43, 103.65s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 18
For nerf, args.lrate = 1e-09, new_lrate = 9.998250188439212e-10, global_step = 19
At epoch   18 : train loss: 110.5301, train psnr: 15.4874, val loss: 0.0081, val psnr: 15.8858                                                                                                             
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [32:50<57:05:43, 103.65s/it]Median error 0.20173092931509018m and 4.719489336013794 degrees.
Mean error 0.22777362848982696m and 6.173724947369051 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20173092931509018 val_loss =  0.008144204678372534
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [32:56<57:05:26, 103.70s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 19
For nerf, args.lrate = 1e-09, new_lrate = 9.998158101575927e-10, global_step = 20
At epoch   19 : train loss: 101.2083, train psnr: 15.9542, val loss: 0.0084, val psnr: 16.5528                                                                                                             
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [34:34<57:05:26, 103.70s/it]Median error 0.20311805605888367m and 3.529388666152954 degrees.
Mean error 0.2288892298318476m and 5.7059567819541765 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20311805605888367 val_loss =  0.008351697050648184
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [34:39<57:02:23, 103.66s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 20
For nerf, args.lrate = 1e-09, new_lrate = 9.998066015560792e-10, global_step = 21
At epoch   20 : train loss: 92.5717, train psnr: 16.2883, val loss: 0.0079, val psnr: 16.3370                                                                                                              
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [36:17<57:02:23, 103.66s/it]Median error 0.2023744061589241m and 3.8429408073425293 degrees.
Mean error 0.22496312094648718m and 5.659077199062838 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2023744061589241 val_loss =  0.007889205891179932
                     Median error 0.2023744061589241m and 3.8429408073425293 degrees.
Mean error 0.22496312094648718m and 5.659077199062838 degrees.
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [36:28<57:53:02, 105.24s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 21
For nerf, args.lrate = 1e-09, new_lrate = 9.997973930393796e-10, global_step = 22
At epoch   21 : train loss: 108.1683, train psnr: 15.6149, val loss: 0.0095, val psnr: 16.4294                                                                                                             
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [38:06<57:53:02, 105.24s/it]Median error 0.21260234713554382m and 4.381505727767944 degrees.
Mean error 0.23378926563087987m and 6.436163501821548 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21260234713554382 val_loss =  0.009474208794890287
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [38:12<57:36:31, 104.80s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 22
For nerf, args.lrate = 1e-09, new_lrate = 9.99788184607493e-10, global_step = 23
At epoch   22 : train loss: 92.2224, train psnr: 16.2958, val loss: 0.0088, val psnr: 16.2224                                                                                                              
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [39:50<57:36:31, 104.80s/it]Median error 0.2197398543357849m and 4.440608501434326 degrees.
Mean error 0.23616747423885806m and 6.026684414700941 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2197398543357849 val_loss =  0.008800698822243554
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [39:56<57:24:55, 104.50s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 23
For nerf, args.lrate = 1e-09, new_lrate = 9.99778976260419e-10, global_step = 24
At epoch   23 : train loss: 88.3420, train psnr: 16.5303, val loss: 0.0088, val psnr: 16.3418                                                                                                              
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [41:34<57:24:55, 104.50s/it]Median error 0.21304412931203842m and 4.577937602996826 degrees.
Mean error 0.23365218371627966m and 6.239645556942654 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21304412931203842 val_loss =  0.008821464261758378
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [41:39<57:15:20, 104.26s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 24
For nerf, args.lrate = 1e-09, new_lrate = 9.997697679981565e-10, global_step = 25
At epoch   24 : train loss: 97.3841, train psnr: 16.0833, val loss: 0.0093, val psnr: 13.8558                                                                                                              
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [43:18<57:15:20, 104.26s/it]Median error 0.22081466764211655m and 4.707197189331055 degrees.
Mean error 0.23871580303952036m and 6.664964196954662 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.22081466764211655 val_loss =  0.009325460216566838
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [43:23<57:06:31, 104.04s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 25
For nerf, args.lrate = 1e-09, new_lrate = 9.99760559820705e-10, global_step = 26
At epoch   25 : train loss: 96.1257, train psnr: 16.0899, val loss: 0.0090, val psnr: 16.5601                                                                                                              
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [45:01<57:06:31, 104.04s/it]Median error 0.21983221173286438m and 4.345175266265869 degrees.
Mean error 0.24332822830442655m and 6.020067463549767 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21983221173286438 val_loss =  0.009024449278225993
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [45:07<57:01:55, 103.96s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 0.0001, new_lrate = 0.0001, global_step = 26
For nerf, args.lrate = 1e-09, new_lrate = 9.997513517280636e-10, global_step = 27
At epoch   26 : train loss: 91.5290, train psnr: 16.2699, val loss: 0.0080, val psnr: 16.1619                                                                                                              
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [46:45<57:01:55, 103.96s/it]Median error 0.20494171231985092m and 3.2666338682174683 degrees.
Mean error 0.22037612513718213m and 5.446393895155264 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20494171231985092 val_loss =  0.007997121616831778
epochs:   1%|██                                                                                                                                                      | 27/2001 [46:51<56:59:36, 103.94s/it]
Best val loss: 0.1988
 ==== Origional DFnet training in train_on_epoch==========
epochs:   1%|██                                                                                                                                                      | 27/2001 [47:04<57:21:16, 104.60s/it]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 408, in train_on_batch
    loss.backward()
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/autograd/__init__.py", line 175, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Best val loss: 0.1988
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0006-0.1546.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0006-0.1546.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.01, 1, 500]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 0
For nerf, args.lrate = 1e-09, new_lrate = 9.999907897020431e-10, global_step = 1
At epoch    0 : train loss: 147.0808, train psnr: 14.4176, val loss: 0.0086, val psnr: 15.5145                                                                                                             
epochs:   0%|                                                                                                                                                                     | 0/2001 [01:40<?, ?it/s]Median error 0.2102685049176216m and 5.09712815284729 degrees.
Mean error 0.22928701212199834m and 6.392822327944431 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2102685049176216 val_loss =  0.008562144492566679
                     Median error 0.2102685049176216m and 5.09712815284729 degrees.
Mean error 0.22928701212199834m and 6.392822327944431 degrees.
epochs:   0%|                                                                                                                                                         | 1/2001 [01:51<61:56:43, 111.50s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 1
For nerf, args.lrate = 1e-09, new_lrate = 9.999815794889158e-10, global_step = 2
At epoch    1 : train loss: 99.9221, train psnr: 16.0785, val loss: 0.0088, val psnr: 16.9532                                                                                                              
epochs:   0%|                                                                                                                                                         | 1/2001 [03:31<61:56:43, 111.50s/it]Median error 0.21562731266021729m and 4.959009408950806 degrees.
Mean error 0.23793865931088384m and 6.239960697619056 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21562731266021729 val_loss =  0.008808010910112865
epochs:   0%|▏                                                                                                                                                        | 2/2001 [03:36<60:51:42, 109.61s/it]
Best val loss: 0.2103
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 2
For nerf, args.lrate = 1e-09, new_lrate = 9.999723693606173e-10, global_step = 3
At epoch    2 : train loss: 78.8327, train psnr: 17.0700, val loss: 0.0084, val psnr: 17.6155                                                                                                              
epochs:   0%|▏                                                                                                                                                        | 2/2001 [05:15<60:51:42, 109.61s/it]Median error 0.21252375841140747m and 4.532135248184204 degrees.
Mean error 0.2314688218173077m and 5.969043661089923 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21252375841140747 val_loss =  0.008403010352811968
epochs:   0%|▏                                                                                                                                                        | 3/2001 [05:21<60:00:59, 108.14s/it]
Best val loss: 0.2103
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 3
For nerf, args.lrate = 1e-09, new_lrate = 9.999631593171468e-10, global_step = 4
At epoch    3 : train loss: 65.0496, train psnr: 17.9740, val loss: 0.0083, val psnr: 18.2734                                                                                                              
epochs:   0%|▏                                                                                                                                                        | 3/2001 [07:00<60:00:59, 108.14s/it]Median error 0.2074108049273491m and 4.171818733215332 degrees.
Mean error 0.22826038547961214m and 5.852218690550762 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2074108049273491 val_loss =  0.008254362574633214
epochs:   0%|▎                                                                                                                                                        | 4/2001 [07:06<59:25:11, 107.12s/it]
Best val loss: 0.2074
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 4
For nerf, args.lrate = 1e-09, new_lrate = 9.999539493585035e-10, global_step = 5
At epoch    4 : train loss: 55.3670, train psnr: 18.7686, val loss: 0.0079, val psnr: 18.6248                                                                                                              
epochs:   0%|▎                                                                                                                                                        | 4/2001 [08:45<59:25:11, 107.12s/it]Median error 0.2073080986738205m and 4.277902126312256 degrees.
Mean error 0.227583406108473m and 5.600160581500907 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2073080986738205 val_loss =  0.007930681436522468
epochs:   0%|▍                                                                                                                                                        | 5/2001 [08:50<58:58:27, 106.37s/it]
Best val loss: 0.2073
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 5
For nerf, args.lrate = 1e-09, new_lrate = 9.999447394846867e-10, global_step = 6
At epoch    5 : train loss: 52.6336, train psnr: 19.0871, val loss: 0.0079, val psnr: 18.8347                                                                                                              
epochs:   0%|▍                                                                                                                                                        | 5/2001 [10:29<58:58:27, 106.37s/it]Median error 0.21049641072750092m and 4.063351631164551 degrees.
Mean error 0.2265166932347453m and 5.518048103250232 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.21049641072750092 val_loss =  0.007869333855601344
epochs:   0%|▍                                                                                                                                                        | 6/2001 [10:35<58:39:42, 105.86s/it]
Best val loss: 0.2073
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 6
For nerf, args.lrate = 1e-09, new_lrate = 9.999355296956957e-10, global_step = 7
At epoch    6 : train loss: 46.4121, train psnr: 19.6023, val loss: 0.0077, val psnr: 19.1391                                                                                                              
epochs:   0%|▍                                                                                                                                                        | 6/2001 [12:14<58:39:42, 105.86s/it]Median error 0.20807602256536484m and 3.9073894023895264 degrees.
Mean error 0.22337020339391492m and 5.55894384997697 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20807602256536484 val_loss =  0.007730319680682471
epochs:   0%|▌                                                                                                                                                        | 7/2001 [12:20<58:26:54, 105.52s/it]
Best val loss: 0.2073
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 7
For nerf, args.lrate = 1e-09, new_lrate = 9.999263199915295e-10, global_step = 8
At epoch    7 : train loss: 46.2023, train psnr: 19.7202, val loss: 0.0077, val psnr: 19.6818                                                                                                              
epochs:   0%|▌                                                                                                                                                        | 7/2001 [13:59<58:26:54, 105.52s/it]Median error 0.2041163295507431m and 3.7025781869888306 degrees.
Mean error 0.22400231007863636m and 5.36801814155178 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2041163295507431 val_loss =  0.007707975962726439
epochs:   0%|▌                                                                                                                                                        | 8/2001 [14:04<58:15:11, 105.22s/it]
Best val loss: 0.2041
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 8
For nerf, args.lrate = 1e-09, new_lrate = 9.999171103721874e-10, global_step = 9
At epoch    8 : train loss: 44.0614, train psnr: 19.8661, val loss: 0.0075, val psnr: 19.9293                                                                                                              
epochs:   0%|▌                                                                                                                                                        | 8/2001 [15:43<58:15:11, 105.22s/it]Median error 0.20629289746284485m and 3.648480772972107 degrees.
Mean error 0.22058181632460974m and 5.377606068183536 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20629289746284485 val_loss =  0.00750737346905903
epochs:   0%|▋                                                                                                                                                        | 9/2001 [15:49<58:06:44, 105.02s/it]
Best val loss: 0.2041
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 9
For nerf, args.lrate = 1e-09, new_lrate = 9.999079008376687e-10, global_step = 10
At epoch    9 : train loss: 39.4871, train psnr: 20.3987, val loss: 0.0074, val psnr: 19.8966                                                                                                              
epochs:   0%|▋                                                                                                                                                        | 9/2001 [17:28<58:06:44, 105.02s/it]Median error 0.2055225446820259m and 3.957948327064514 degrees.
Mean error 0.21799963087914323m and 5.511911622365477 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2055225446820259 val_loss =  0.007379392499664067
epochs:   0%|▊                                                                                                                                                       | 10/2001 [17:34<58:02:51, 104.96s/it]
Best val loss: 0.2041
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 10
For nerf, args.lrate = 1e-09, new_lrate = 9.998986913879722e-10, global_step = 11
At epoch   10 : train loss: 38.3283, train psnr: 20.5120, val loss: 0.0075, val psnr: 20.1118                                                                                                              
epochs:   0%|▊                                                                                                                                                       | 10/2001 [19:13<58:02:51, 104.96s/it]Median error 0.2016015499830246m and 3.5802570581436157 degrees.
Mean error 0.22035537469709812m and 5.327656305934253 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2016015499830246 val_loss =  0.007452912118170068
epochs:   1%|▊                                                                                                                                                       | 11/2001 [19:18<58:00:11, 104.93s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 11
For nerf, args.lrate = 1e-09, new_lrate = 9.99889482023098e-10, global_step = 12
At epoch   11 : train loss: 37.3545, train psnr: 20.6872, val loss: 0.0075, val psnr: 20.1669                                                                                                              
epochs:   1%|▊                                                                                                                                                       | 11/2001 [20:58<58:00:11, 104.93s/it]Median error 0.20591019093990326m and 4.03987717628479 degrees.
Mean error 0.21951263978217656m and 5.54083431122998 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20591019093990326 val_loss =  0.007493916685577022
epochs:   1%|▉                                                                                                                                                       | 12/2001 [21:03<57:56:27, 104.87s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 12
For nerf, args.lrate = 1e-09, new_lrate = 9.998802727430445e-10, global_step = 13
At epoch   12 : train loss: 36.2426, train psnr: 20.7250, val loss: 0.0076, val psnr: 19.1389                                                                                                              
epochs:   1%|▉                                                                                                                                                       | 12/2001 [22:42<57:56:27, 104.87s/it]Median error 0.2077503204345703m and 3.7715996503829956 degrees.
Mean error 0.22086576974916797m and 5.4633036073644154 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2077503204345703 val_loss =  0.007628294784337214
epochs:   1%|▉                                                                                                                                                       | 13/2001 [22:48<57:53:21, 104.83s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 13
For nerf, args.lrate = 1e-09, new_lrate = 9.998710635478113e-10, global_step = 14
At epoch   13 : train loss: 37.6614, train psnr: 20.5794, val loss: 0.0075, val psnr: 19.8725                                                                                                              
epochs:   1%|▉                                                                                                                                                       | 13/2001 [24:27<57:53:21, 104.83s/it]Median error 0.2023548036813736m and 3.884863018989563 degrees.
Mean error 0.21832843543396063m and 5.56003632293901 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2023548036813736 val_loss =  0.007493898253352358
epochs:   1%|█                                                                                                                                                       | 14/2001 [24:33<57:51:26, 104.82s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 14
For nerf, args.lrate = 1e-09, new_lrate = 9.998618544373976e-10, global_step = 15
At epoch   14 : train loss: 38.0252, train psnr: 20.7146, val loss: 0.0074, val psnr: 19.8674                                                                                                              
epochs:   1%|█                                                                                                                                                       | 14/2001 [26:12<57:51:26, 104.82s/it]Median error 0.20411159098148346m and 3.8370355367660522 degrees.
Mean error 0.22049241894969213m and 5.296912877002225 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20411159098148346 val_loss =  0.007363491794749574
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [26:17<57:46:32, 104.73s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 15
For nerf, args.lrate = 1e-09, new_lrate = 9.998526454118023e-10, global_step = 16
At epoch   15 : train loss: 35.5484, train psnr: 20.8258, val loss: 0.0076, val psnr: 19.6008                                                                                                              
epochs:   1%|█▏                                                                                                                                                      | 15/2001 [27:56<57:46:32, 104.73s/it]Median error 0.2038993164896965m and 4.092322587966919 degrees.
Mean error 0.22003012772287556m and 5.56511277002603 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2038993164896965 val_loss =  0.0075838026466011395
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [28:02<57:44:53, 104.73s/it]
Best val loss: 0.2016
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 16
For nerf, args.lrate = 1e-09, new_lrate = 9.998434364710252e-10, global_step = 17
At epoch   16 : train loss: 32.6143, train psnr: 21.2154, val loss: 0.0071, val psnr: 19.8701                                                                                                              
epochs:   1%|█▏                                                                                                                                                      | 16/2001 [29:41<57:44:53, 104.73s/it]Median error 0.19996672868728638m and 3.8033156394958496 degrees.
Mean error 0.2124790695499674m and 5.372313567471166 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19996672868728638 val_loss =  0.0071316085796063735
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [29:47<57:43:09, 104.73s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 17
For nerf, args.lrate = 1e-09, new_lrate = 9.998342276150649e-10, global_step = 18
At epoch   17 : train loss: 36.0521, train psnr: 20.8737, val loss: 0.0076, val psnr: 19.7690                                                                                                              
epochs:   1%|█▎                                                                                                                                                      | 17/2001 [31:26<57:43:09, 104.73s/it]Median error 0.20306463539600372m and 4.004741907119751 degrees.
Mean error 0.22039369737299588m and 5.5237356419505375 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20306463539600372 val_loss =  0.00758368202447969
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [31:31<57:39:24, 104.67s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 18
For nerf, args.lrate = 1e-09, new_lrate = 9.998250188439212e-10, global_step = 19
At epoch   18 : train loss: 37.1657, train psnr: 20.8619, val loss: 0.0076, val psnr: 20.0858                                                                                                              
epochs:   1%|█▎                                                                                                                                                      | 18/2001 [33:10<57:39:24, 104.67s/it]Median error 0.20534151792526245m and 4.030953645706177 degrees.
Mean error 0.21971772402630524m and 5.56960933954127 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20534151792526245 val_loss =  0.007567122846594135
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [33:16<57:37:06, 104.66s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 19
For nerf, args.lrate = 1e-09, new_lrate = 9.998158101575927e-10, global_step = 20
At epoch   19 : train loss: 35.6187, train psnr: 20.9920, val loss: 0.0075, val psnr: 20.3298                                                                                                              
epochs:   1%|█▍                                                                                                                                                      | 19/2001 [34:55<57:37:06, 104.66s/it]Median error 0.2035750299692154m and 4.048103094100952 degrees.
Mean error 0.21754684103916772m and 5.5466836648672695 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2035750299692154 val_loss =  0.007488615364460194
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [35:01<57:36:15, 104.68s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 20
For nerf, args.lrate = 1e-09, new_lrate = 9.998066015560792e-10, global_step = 21
At epoch   20 : train loss: 35.4321, train psnr: 21.0726, val loss: 0.0075, val psnr: 20.5098                                                                                                              
epochs:   1%|█▌                                                                                                                                                      | 20/2001 [36:40<57:36:15, 104.68s/it]Median error 0.20370998978614807m and 3.9977028369903564 degrees.
Mean error 0.21791266479910265m and 5.533676974022919 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20370998978614807 val_loss =  0.007496333292284005
                     Median error 0.20370998978614807m and 3.9977028369903564 degrees.
Mean error 0.21791266479910265m and 5.533676974022919 degrees.
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [36:51<58:27:22, 106.28s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 21
For nerf, args.lrate = 1e-09, new_lrate = 9.997973930393796e-10, global_step = 22
At epoch   21 : train loss: 36.7728, train psnr: 20.8159, val loss: 0.0075, val psnr: 20.7036                                                                                                              
epochs:   1%|█▌                                                                                                                                                      | 21/2001 [38:30<58:27:22, 106.28s/it]Median error 0.20291413366794586m and 3.8232388496398926 degrees.
Mean error 0.2187048078510865m and 5.43966916239696 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20291413366794586 val_loss =  0.007460430572876355
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [38:35<58:08:09, 105.75s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 22
For nerf, args.lrate = 1e-09, new_lrate = 9.99788184607493e-10, global_step = 23
At epoch   22 : train loss: 31.5870, train psnr: 21.3516, val loss: 0.0076, val psnr: 19.1958                                                                                                              
epochs:   1%|█▋                                                                                                                                                      | 22/2001 [40:14<58:08:09, 105.75s/it]Median error 0.20192590355873108m and 3.971968173980713 degrees.
Mean error 0.22031844661077146m and 5.553930278731744 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20192590355873108 val_loss =  0.007588099452250059
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [40:20<57:54:18, 105.39s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 23
For nerf, args.lrate = 1e-09, new_lrate = 9.99778976260419e-10, global_step = 24
At epoch   23 : train loss: 33.8092, train psnr: 21.1779, val loss: 0.0075, val psnr: 20.8792                                                                                                              
epochs:   1%|█▋                                                                                                                                                      | 23/2001 [41:59<57:54:18, 105.39s/it]Median error 0.20358402281999588m and 3.948543071746826 degrees.
Mean error 0.21677461471257783m and 5.572864651318021 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20358402281999588 val_loss =  0.0074924398759763635
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [42:04<57:45:20, 105.17s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 24
For nerf, args.lrate = 1e-09, new_lrate = 9.997697679981565e-10, global_step = 25
At epoch   24 : train loss: 37.0368, train psnr: 20.7960, val loss: 0.0075, val psnr: 20.1306                                                                                                              
epochs:   1%|█▊                                                                                                                                                      | 24/2001 [43:43<57:45:20, 105.17s/it]Median error 0.20135126262903214m and 3.9541906118392944 degrees.
Mean error 0.21889900500218756m and 5.533011748783501 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20135126262903214 val_loss =  0.007544158995810186
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [43:49<57:37:39, 104.99s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 25
For nerf, args.lrate = 1e-09, new_lrate = 9.99760559820705e-10, global_step = 26
At epoch   25 : train loss: 35.2632, train psnr: 20.9905, val loss: 0.0074, val psnr: 20.5259                                                                                                              
epochs:   1%|█▉                                                                                                                                                      | 25/2001 [45:28<57:37:39, 104.99s/it]Median error 0.20214078575372696m and 3.922486186027527 degrees.
Mean error 0.21553355622056283m and 5.502128064994388 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20214078575372696 val_loss =  0.007356963291312266
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [45:33<57:30:19, 104.82s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 26
For nerf, args.lrate = 1e-09, new_lrate = 9.997513517280636e-10, global_step = 27
At epoch   26 : train loss: 33.6126, train psnr: 21.2643, val loss: 0.0074, val psnr: 19.5163                                                                                                              
epochs:   1%|█▉                                                                                                                                                      | 26/2001 [47:12<57:30:19, 104.82s/it]Median error 0.2050042301416397m and 3.9220869541168213 degrees.
Mean error 0.219412173830757m and 5.354637002987176 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2050042301416397 val_loss =  0.007394850111426503
epochs:   1%|██                                                                                                                                                      | 27/2001 [47:18<57:25:45, 104.73s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 27
For nerf, args.lrate = 1e-09, new_lrate = 9.997421437202313e-10, global_step = 28
At epoch   27 : train loss: 34.6239, train psnr: 20.9712, val loss: 0.0075, val psnr: 19.8696                                                                                                              
epochs:   1%|██                                                                                                                                                      | 27/2001 [48:57<57:25:45, 104.73s/it]Median error 0.20699821412563324m and 3.926077127456665 degrees.
Mean error 0.2198054202293095m and 5.539347186503623 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20699821412563324 val_loss =  0.007539037024441575
epochs:   1%|██▏                                                                                                                                                     | 28/2001 [49:02<57:23:05, 104.71s/it]
Best val loss: 0.2000
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 28
For nerf, args.lrate = 1e-09, new_lrate = 9.997329357972075e-10, global_step = 29
At epoch   28 : train loss: 33.8225, train psnr: 21.2239, val loss: 0.0075, val psnr: 19.8998                                                                                                              
epochs:   1%|██▏                                                                                                                                                     | 28/2001 [50:42<57:23:05, 104.71s/it]Median error 0.1981702595949173m and 3.981904983520508 degrees.
Mean error 0.2156185653807241m and 5.588307725544642 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1981702595949173 val_loss =  0.0074618032708436985
epochs:   1%|██▏                                                                                                                                                     | 29/2001 [50:47<57:20:45, 104.69s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 29
For nerf, args.lrate = 1e-09, new_lrate = 9.997237279589916e-10, global_step = 30
At epoch   29 : train loss: 34.0985, train psnr: 21.2324, val loss: 0.0075, val psnr: 20.5263                                                                                                              
epochs:   1%|██▏                                                                                                                                                     | 29/2001 [52:27<57:20:45, 104.69s/it]Median error 0.20068155974149704m and 3.9552793502807617 degrees.
Mean error 0.21744384896387214m and 5.498634829272626 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20068155974149704 val_loss =  0.007463274046068522
epochs:   1%|██▎                                                                                                                                                     | 30/2001 [52:32<57:20:37, 104.74s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 30
For nerf, args.lrate = 1e-09, new_lrate = 9.997145202055824e-10, global_step = 31
At epoch   30 : train loss: 33.1451, train psnr: 21.2725, val loss: 0.0077, val psnr: 19.1994                                                                                                              
epochs:   1%|██▎                                                                                                                                                     | 30/2001 [54:11<57:20:37, 104.74s/it]Median error 0.20492368936538696m and 3.823850631713867 degrees.
Mean error 0.21923845647061282m and 5.597122183333524 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20492368936538696 val_loss =  0.007688069528924124
epochs:   2%|██▎                                                                                                                                                     | 31/2001 [54:16<57:14:38, 104.61s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 31
For nerf, args.lrate = 1e-09, new_lrate = 9.997053125369793e-10, global_step = 32
At epoch   31 : train loss: 31.2114, train psnr: 21.5008, val loss: 0.0076, val psnr: 20.3707                                                                                                              
epochs:   2%|██▎                                                                                                                                                     | 31/2001 [55:55<57:14:38, 104.61s/it]Median error 0.20440158993005753m and 3.985838770866394 degrees.
Mean error 0.2201462773802249m and 5.5037292631169565 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20440158993005753 val_loss =  0.0075765618591102524
epochs:   2%|██▍                                                                                                                                                     | 32/2001 [56:01<57:12:04, 104.58s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 32
For nerf, args.lrate = 1e-09, new_lrate = 9.996961049531819e-10, global_step = 33
At epoch   32 : train loss: 31.2117, train psnr: 21.4520, val loss: 0.0075, val psnr: 20.0743                                                                                                              
epochs:   2%|██▍                                                                                                                                                     | 32/2001 [57:40<57:12:04, 104.58s/it]Median error 0.2035846933722496m and 4.1336445808410645 degrees.
Mean error 0.21698473951579467m and 5.65856937309991 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2035846933722496 val_loss =  0.00750912082527537
epochs:   2%|██▌                                                                                                                                                     | 33/2001 [57:45<57:08:22, 104.52s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 33
For nerf, args.lrate = 1e-09, new_lrate = 9.996868974541888e-10, global_step = 34
At epoch   33 : train loss: 33.5393, train psnr: 21.1342, val loss: 0.0075, val psnr: 20.1414                                                                                                              
epochs:   2%|██▌                                                                                                                                                     | 33/2001 [59:24<57:08:22, 104.52s/it]Median error 0.20135197043418884m and 3.985151529312134 degrees.
Mean error 0.21770256204221414m and 5.543390270488465 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20135197043418884 val_loss =  0.007470427495851026
epochs:   2%|██▌                                                                                                                                                     | 34/2001 [59:30<57:06:53, 104.53s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 34
For nerf, args.lrate = 1e-09, new_lrate = 9.996776900399996e-10, global_step = 35
At epoch   34 : train loss: 34.5615, train psnr: 21.1327, val loss: 0.0075, val psnr: 20.9610                                                                                                              
epochs:   2%|██▌                                                                                                                                                   | 34/2001 [1:01:09<57:06:53, 104.53s/it]Median error 0.20212574303150177m and 3.7854793071746826 degrees.
Mean error 0.21653979192469042m and 5.525830926984428 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20212574303150177 val_loss =  0.007542004897700447
epochs:   2%|██▌                                                                                                                                                   | 35/2001 [1:01:14<57:06:08, 104.56s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 35
For nerf, args.lrate = 1e-09, new_lrate = 9.996684827106136e-10, global_step = 36
At epoch   35 : train loss: 33.2438, train psnr: 21.3087, val loss: 0.0074, val psnr: 20.7792                                                                                                              
epochs:   2%|██▌                                                                                                                                                   | 35/2001 [1:02:53<57:06:08, 104.56s/it]Median error 0.20180001109838486m and 3.9898629188537598 degrees.
Mean error 0.2153063473642355m and 5.5201611282070155 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20180001109838486 val_loss =  0.007400456723432586
epochs:   2%|██▋                                                                                                                                                   | 36/2001 [1:02:59<57:04:29, 104.56s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 36
For nerf, args.lrate = 1e-09, new_lrate = 9.996592754660296e-10, global_step = 37
At epoch   36 : train loss: 31.8606, train psnr: 21.4295, val loss: 0.0076, val psnr: 20.5936                                                                                                              
epochs:   2%|██▋                                                                                                                                                   | 36/2001 [1:04:38<57:04:29, 104.56s/it]Median error 0.2033718153834343m and 3.989077925682068 degrees.
Mean error 0.21779902849482138m and 5.683690160874896 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2033718153834343 val_loss =  0.007609021999234704
epochs:   2%|██▊                                                                                                                                                   | 37/2001 [1:04:43<57:02:15, 104.55s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 37
For nerf, args.lrate = 1e-09, new_lrate = 9.996500683062473e-10, global_step = 38
At epoch   37 : train loss: 30.6279, train psnr: 21.4865, val loss: 0.0074, val psnr: 20.5799                                                                                                              
epochs:   2%|██▊                                                                                                                                                   | 37/2001 [1:06:23<57:02:15, 104.55s/it]Median error 0.20401687175035477m and 4.015384912490845 degrees.
Mean error 0.21710173789079976m and 5.529356863032951 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20401687175035477 val_loss =  0.007417919152909522
epochs:   2%|██▊                                                                                                                                                   | 38/2001 [1:06:28<57:00:06, 104.54s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 38
For nerf, args.lrate = 1e-09, new_lrate = 9.996408612312654e-10, global_step = 39
At epoch   38 : train loss: 31.3536, train psnr: 21.4809, val loss: 0.0077, val psnr: 20.5635                                                                                                              
epochs:   2%|██▊                                                                                                                                                   | 38/2001 [1:08:07<57:00:06, 104.54s/it]Median error 0.2050701603293419m and 3.968320846557617 degrees.
Mean error 0.22067097490012405m and 5.557735588326145 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2050701603293419 val_loss =  0.007735537625864565
epochs:   2%|██▉                                                                                                                                                   | 39/2001 [1:08:13<56:58:49, 104.55s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 39
For nerf, args.lrate = 1e-09, new_lrate = 9.996316542410835e-10, global_step = 40
At epoch   39 : train loss: 31.7505, train psnr: 21.4558, val loss: 0.0074, val psnr: 20.6639                                                                                                              
epochs:   2%|██▉                                                                                                                                                   | 39/2001 [1:09:52<56:58:49, 104.55s/it]Median error 0.2009245976805687m and 4.009323954582214 degrees.
Mean error 0.2161326328488557m and 5.560975539599836 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2009245976805687 val_loss =  0.0074151982552714095
epochs:   2%|██▉                                                                                                                                                   | 40/2001 [1:09:57<56:58:23, 104.59s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 40
For nerf, args.lrate = 1e-09, new_lrate = 9.996224473357007e-10, global_step = 41
At epoch   40 : train loss: 32.2229, train psnr: 21.3806, val loss: 0.0075, val psnr: 21.1358                                                                                                              
epochs:   2%|██▉                                                                                                                                                   | 40/2001 [1:11:36<56:58:23, 104.59s/it]Median error 0.20265745371580124m and 3.9429882764816284 degrees.
Mean error 0.2166509483846636m and 5.5311247576103515 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20265745371580124 val_loss =  0.007507279653774729
                     Median error 0.20265745371580124m and 3.9429882764816284 degrees.
Mean error 0.2166509483846636m and 5.5311247576103515 degrees.
epochs:   2%|███                                                                                                                                                   | 41/2001 [1:11:47<57:50:08, 106.23s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 41
For nerf, args.lrate = 1e-09, new_lrate = 9.996132405151164e-10, global_step = 42
At epoch   41 : train loss: 30.8687, train psnr: 21.4964, val loss: 0.0075, val psnr: 20.9607                                                                                                              
epochs:   2%|███                                                                                                                                                   | 41/2001 [1:13:26<57:50:08, 106.23s/it]Median error 0.20155362784862518m and 3.9591344594955444 degrees.
Mean error 0.21856570121670058m and 5.491626991192821 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20155362784862518 val_loss =  0.007494132867636633
epochs:   2%|███▏                                                                                                                                                  | 42/2001 [1:13:32<57:31:28, 105.71s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 42
For nerf, args.lrate = 1e-09, new_lrate = 9.996040337793296e-10, global_step = 43
At epoch   42 : train loss: 31.1599, train psnr: 21.4276, val loss: 0.0076, val psnr: 20.4130                                                                                                              
epochs:   2%|███▏                                                                                                                                                  | 42/2001 [1:15:11<57:31:28, 105.71s/it]Median error 0.20376665145158768m and 4.1146626472473145 degrees.
Mean error 0.21970291193273023m and 5.624773257476115 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20376665145158768 val_loss =  0.007604794226781709
epochs:   2%|███▏                                                                                                                                                  | 43/2001 [1:15:16<57:19:08, 105.39s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 43
For nerf, args.lrate = 1e-09, new_lrate = 9.995948271283396e-10, global_step = 44
At epoch   43 : train loss: 32.7455, train psnr: 21.3795, val loss: 0.0076, val psnr: 20.7257                                                                                                              
epochs:   2%|███▏                                                                                                                                                  | 43/2001 [1:16:55<57:19:08, 105.39s/it]Median error 0.20391884446144104m and 3.881355881690979 degrees.
Mean error 0.21898531491834264m and 5.511934252825343 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20391884446144104 val_loss =  0.007583274571943217
epochs:   2%|███▎                                                                                                                                                  | 44/2001 [1:17:01<57:05:59, 105.04s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 44
For nerf, args.lrate = 1e-09, new_lrate = 9.995856205621455e-10, global_step = 45
At epoch   44 : train loss: 31.8860, train psnr: 21.3450, val loss: 0.0075, val psnr: 20.0312                                                                                                              
epochs:   2%|███▎                                                                                                                                                  | 44/2001 [1:18:40<57:05:59, 105.04s/it]Median error 0.20287754386663437m and 3.929166078567505 degrees.
Mean error 0.21791902366603313m and 5.579131293755311 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20287754386663437 val_loss =  0.007543817209940015
epochs:   2%|███▎                                                                                                                                                  | 45/2001 [1:18:45<56:58:23, 104.86s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 45
For nerf, args.lrate = 1e-09, new_lrate = 9.995764140807466e-10, global_step = 46
At epoch   45 : train loss: 35.6300, train psnr: 20.9840, val loss: 0.0075, val psnr: 20.4214                                                                                                              
epochs:   2%|███▎                                                                                                                                                  | 45/2001 [1:20:24<56:58:23, 104.86s/it]Median error 0.2025172933936119m and 3.8535245656967163 degrees.
Mean error 0.21903320289922026m and 5.416497201632391 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2025172933936119 val_loss =  0.007509218122591434
epochs:   2%|███▍                                                                                                                                                  | 46/2001 [1:20:30<56:54:05, 104.78s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 46
For nerf, args.lrate = 1e-09, new_lrate = 9.995672076841423e-10, global_step = 47
At epoch   46 : train loss: 33.1769, train psnr: 21.1871, val loss: 0.0076, val psnr: 20.6601                                                                                                              
epochs:   2%|███▍                                                                                                                                                  | 46/2001 [1:22:09<56:54:05, 104.78s/it]Median error 0.2076815664768219m and 4.070763349533081 degrees.
Mean error 0.21947784843639687m and 5.650602857472926 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2076815664768219 val_loss =  0.007613388303829204
epochs:   2%|███▌                                                                                                                                                  | 47/2001 [1:22:14<56:52:08, 104.77s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 47
For nerf, args.lrate = 1e-09, new_lrate = 9.995580013723315e-10, global_step = 48
At epoch   47 : train loss: 29.7620, train psnr: 21.6320, val loss: 0.0075, val psnr: 19.7790                                                                                                              
epochs:   2%|███▌                                                                                                                                                  | 47/2001 [1:23:53<56:52:08, 104.77s/it]Median error 0.20295968651771545m and 3.9227854013442993 degrees.
Mean error 0.21737462052178044m and 5.4552634304110335 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20295968651771545 val_loss =  0.007489302133733519
epochs:   2%|███▌                                                                                                                                                  | 48/2001 [1:23:59<56:46:52, 104.67s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 48
For nerf, args.lrate = 1e-09, new_lrate = 9.995487951453137e-10, global_step = 49
At epoch   48 : train loss: 29.1024, train psnr: 21.6807, val loss: 0.0075, val psnr: 20.4511                                                                                                              
epochs:   2%|███▌                                                                                                                                                  | 48/2001 [1:25:38<56:46:52, 104.67s/it]Median error 0.2021993026137352m and 3.9758695363998413 degrees.
Mean error 0.2181192174108948m and 5.580520075251941 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2021993026137352 val_loss =  0.00752235627900194
epochs:   2%|███▋                                                                                                                                                  | 49/2001 [1:25:43<56:44:39, 104.65s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 49
For nerf, args.lrate = 1e-09, new_lrate = 9.995395890030878e-10, global_step = 50
At epoch   49 : train loss: 32.3504, train psnr: 21.4041, val loss: 0.0075, val psnr: 20.4743                                                                                                              
epochs:   2%|███▋                                                                                                                                                  | 49/2001 [1:27:23<56:44:39, 104.65s/it]Median error 0.2009475827217102m and 3.8690340518951416 degrees.
Mean error 0.2180276269636113m and 5.52176326636964 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2009475827217102 val_loss =  0.007499873537438505
epochs:   2%|███▋                                                                                                                                                  | 50/2001 [1:27:28<56:42:32, 104.64s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 50
For nerf, args.lrate = 1e-09, new_lrate = 9.995303829456534e-10, global_step = 51
At epoch   50 : train loss: 32.9846, train psnr: 21.4075, val loss: 0.0076, val psnr: 20.6180                                                                                                              
epochs:   2%|███▋                                                                                                                                                  | 50/2001 [1:29:07<56:42:32, 104.64s/it]Median error 0.20222798734903336m and 3.917593479156494 degrees.
Mean error 0.2174944653503808m and 5.62467338494685 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20222798734903336 val_loss =  0.007578441090011066
epochs:   3%|███▊                                                                                                                                                  | 51/2001 [1:29:13<56:40:59, 104.65s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 51
For nerf, args.lrate = 1e-09, new_lrate = 9.995211769730094e-10, global_step = 52
At epoch   51 : train loss: 30.8861, train psnr: 21.5325, val loss: 0.0076, val psnr: 20.5606                                                                                                              
epochs:   3%|███▊                                                                                                                                                  | 51/2001 [1:30:52<56:40:59, 104.65s/it]Median error 0.20187421143054962m and 3.99055016040802 degrees.
Mean error 0.21769793443608018m and 5.581468824191615 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20187421143054962 val_loss =  0.007576884071078474
epochs:   3%|███▉                                                                                                                                                  | 52/2001 [1:30:57<56:39:22, 104.65s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 52
For nerf, args.lrate = 1e-09, new_lrate = 9.995119710851554e-10, global_step = 53
At epoch   52 : train loss: 33.7393, train psnr: 21.2690, val loss: 0.0074, val psnr: 20.7867                                                                                                              
epochs:   3%|███▉                                                                                                                                                  | 52/2001 [1:32:37<56:39:22, 104.65s/it]Median error 0.20001918077468872m and 3.9037811756134033 degrees.
Mean error 0.21595070953009582m and 5.538844983828695 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20001918077468872 val_loss =  0.007440796043775195
epochs:   3%|███▉                                                                                                                                                  | 53/2001 [1:32:42<56:37:37, 104.65s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 53
For nerf, args.lrate = 1e-09, new_lrate = 9.9950276528209e-10, global_step = 54
At epoch   53 : train loss: 30.2417, train psnr: 21.5854, val loss: 0.0075, val psnr: 20.8879                                                                                                              
epochs:   3%|███▉                                                                                                                                                  | 53/2001 [1:34:21<56:37:37, 104.65s/it]Median error 0.20305004715919495m and 3.958931803703308 degrees.
Mean error 0.21770934119202226m and 5.530556381894992 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20305004715919495 val_loss =  0.007484179000479903
epochs:   3%|████                                                                                                                                                  | 54/2001 [1:34:27<56:35:03, 104.62s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 54
For nerf, args.lrate = 1e-09, new_lrate = 9.994935595638132e-10, global_step = 55
At epoch   54 : train loss: 31.2235, train psnr: 21.5071, val loss: 0.0075, val psnr: 20.9535                                                                                                              
epochs:   3%|████                                                                                                                                                  | 54/2001 [1:36:06<56:35:03, 104.62s/it]Median error 0.20366842299699783m and 3.97876238822937 degrees.
Mean error 0.2182211660052299m and 5.542512022773264 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20366842299699783 val_loss =  0.00750589832746429
epochs:   3%|████                                                                                                                                                  | 55/2001 [1:36:11<56:32:43, 104.61s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 55
For nerf, args.lrate = 1e-09, new_lrate = 9.994843539303235e-10, global_step = 56
At epoch   55 : train loss: 29.2230, train psnr: 21.6378, val loss: 0.0075, val psnr: 20.7125                                                                                                              
epochs:   3%|████                                                                                                                                                  | 55/2001 [1:37:50<56:32:43, 104.61s/it]Median error 0.20210646092891693m and 4.184369087219238 degrees.
Mean error 0.21487449662314978m and 5.662637845285026 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20210646092891693 val_loss =  0.0074582995949320115
epochs:   3%|████▏                                                                                                                                                 | 56/2001 [1:37:56<56:31:54, 104.63s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 56
For nerf, args.lrate = 1e-09, new_lrate = 9.994751483816206e-10, global_step = 57
At epoch   56 : train loss: 31.1626, train psnr: 21.5521, val loss: 0.0074, val psnr: 21.0567                                                                                                              
epochs:   3%|████▏                                                                                                                                                 | 56/2001 [1:39:35<56:31:54, 104.63s/it]Median error 0.20244024693965912m and 4.042393922805786 degrees.
Mean error 0.21544887734056725m and 5.576015460074913 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20244024693965912 val_loss =  0.007422467632680379
epochs:   3%|████▎                                                                                                                                                 | 57/2001 [1:39:41<56:30:21, 104.64s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 57
For nerf, args.lrate = 1e-09, new_lrate = 9.994659429177034e-10, global_step = 58
At epoch   57 : train loss: 30.6661, train psnr: 21.5481, val loss: 0.0076, val psnr: 21.0918                                                                                                              
epochs:   3%|████▎                                                                                                                                                 | 57/2001 [1:41:20<56:30:21, 104.64s/it]Median error 0.2008439004421234m and 3.9134950637817383 degrees.
Mean error 0.21732470234064197m and 5.582182051199168 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2008439004421234 val_loss =  0.007577169355190489
epochs:   3%|████▎                                                                                                                                                 | 58/2001 [1:41:25<56:27:39, 104.61s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 58
For nerf, args.lrate = 1e-09, new_lrate = 9.994567375385712e-10, global_step = 59
At epoch   58 : train loss: 31.8109, train psnr: 21.3441, val loss: 0.0074, val psnr: 20.4091                                                                                                              
epochs:   3%|████▎                                                                                                                                                 | 58/2001 [1:43:04<56:27:39, 104.61s/it]Median error 0.20180605351924896m and 3.9821053743362427 degrees.
Mean error 0.2155682835614814m and 5.508231701879849 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20180605351924896 val_loss =  0.007382207845432777
epochs:   3%|████▍                                                                                                                                                 | 59/2001 [1:43:10<56:24:29, 104.57s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 59
For nerf, args.lrate = 1e-09, new_lrate = 9.994475322442236e-10, global_step = 60
At epoch   59 : train loss: 31.9491, train psnr: 21.4455, val loss: 0.0077, val psnr: 20.2728                                                                                                              
epochs:   3%|████▍                                                                                                                                                 | 59/2001 [1:44:49<56:24:29, 104.57s/it]Median error 0.2018934264779091m and 3.8053805828094482 degrees.
Mean error 0.21924817413921177m and 5.567738149028558 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2018934264779091 val_loss =  0.007652236482157133
epochs:   3%|████▍                                                                                                                                                 | 60/2001 [1:44:54<56:22:10, 104.55s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 60
For nerf, args.lrate = 1e-09, new_lrate = 9.994383270346593e-10, global_step = 61
At epoch   60 : train loss: 30.6050, train psnr: 21.5477, val loss: 0.0076, val psnr: 20.4376                                                                                                              
epochs:   3%|████▍                                                                                                                                                 | 60/2001 [1:46:33<56:22:10, 104.55s/it]Median error 0.20182469487190247m and 3.9334468841552734 degrees.
Mean error 0.21696896510206254m and 5.566298023228221 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20182469487190247 val_loss =  0.007584780727542945
                     Median error 0.20182469487190247m and 3.9334468841552734 degrees.
Mean error 0.21696896510206254m and 5.566298023228221 degrees.
epochs:   3%|████▌                                                                                                                                                 | 61/2001 [1:46:44<57:15:40, 106.26s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 61
For nerf, args.lrate = 1e-09, new_lrate = 9.994291219098777e-10, global_step = 62
At epoch   61 : train loss: 32.5197, train psnr: 21.2452, val loss: 0.0074, val psnr: 20.1359                                                                                                              
epochs:   3%|████▌                                                                                                                                                 | 61/2001 [1:48:23<57:15:40, 106.26s/it]Median error 0.20302113890647888m and 3.9930994510650635 degrees.
Mean error 0.21780947559260525m and 5.540700992471294 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20302113890647888 val_loss =  0.0073907251795529965
epochs:   3%|████▋                                                                                                                                                 | 62/2001 [1:48:29<56:56:58, 105.73s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 62
For nerf, args.lrate = 1e-09, new_lrate = 9.994199168698782e-10, global_step = 63
At epoch   62 : train loss: 31.2317, train psnr: 21.4096, val loss: 0.0077, val psnr: 20.1882                                                                                                              
epochs:   3%|████▋                                                                                                                                                 | 62/2001 [1:50:08<56:56:58, 105.73s/it]Median error 0.2045404240489006m and 3.8858929872512817 degrees.
Mean error 0.22068449335270807m and 5.566526097249285 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2045404240489006 val_loss =  0.007660548363147475
epochs:   3%|████▋                                                                                                                                                 | 63/2001 [1:50:13<56:43:42, 105.38s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 63
For nerf, args.lrate = 1e-09, new_lrate = 9.994107119146597e-10, global_step = 64
At epoch   63 : train loss: 32.6684, train psnr: 21.2960, val loss: 0.0077, val psnr: 20.9927                                                                                                              
epochs:   3%|████▋                                                                                                                                                 | 63/2001 [1:51:53<56:43:42, 105.38s/it]Median error 0.20525337755680084m and 4.109235763549805 degrees.
Mean error 0.22008032345322343m and 5.654639054949467 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20525337755680084 val_loss =  0.00768789259803414
epochs:   3%|████▊                                                                                                                                                 | 64/2001 [1:51:58<56:34:41, 105.15s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 64
For nerf, args.lrate = 1e-09, new_lrate = 9.994015070442214e-10, global_step = 65
At epoch   64 : train loss: 31.1783, train psnr: 21.3840, val loss: 0.0075, val psnr: 19.6285                                                                                                              
epochs:   3%|████▊                                                                                                                                                 | 64/2001 [1:53:37<56:34:41, 105.15s/it]Median error 0.20005474984645844m and 4.0519700050354 degrees.
Mean error 0.21534399360961276m and 5.641298180106681 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20005474984645844 val_loss =  0.007466934334081037
epochs:   3%|████▊                                                                                                                                                 | 65/2001 [1:53:43<56:29:21, 105.04s/it]
Best val loss: 0.1982
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 65
For nerf, args.lrate = 1e-09, new_lrate = 9.99392302258563e-10, global_step = 66
At epoch   65 : train loss: 32.7990, train psnr: 21.3576, val loss: 0.0073, val psnr: 20.9904                                                                                                              
epochs:   3%|████▊                                                                                                                                                 | 65/2001 [1:55:22<56:29:21, 105.04s/it]Median error 0.19799569249153137m and 4.014801740646362 degrees.
Mean error 0.21455803782366187m and 5.569553077281245 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19799569249153137 val_loss =  0.007335536507047149
epochs:   3%|████▉                                                                                                                                                 | 66/2001 [1:55:27<56:23:24, 104.91s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 66
For nerf, args.lrate = 1e-09, new_lrate = 9.993830975576836e-10, global_step = 67
At epoch   66 : train loss: 31.4155, train psnr: 21.4841, val loss: 0.0077, val psnr: 20.3813                                                                                                              
epochs:   3%|████▉                                                                                                                                                 | 66/2001 [1:57:07<56:23:24, 104.91s/it]Median error 0.2065468430519104m and 3.89393949508667 degrees.
Mean error 0.22140873249182816m and 5.5320990228580555 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2065468430519104 val_loss =  0.007686423932041677
epochs:   3%|█████                                                                                                                                                 | 67/2001 [1:57:12<56:19:38, 104.85s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 1e-05, global_step = 67
For nerf, args.lrate = 1e-09, new_lrate = 9.993738929415818e-10, global_step = 68
Epoch 00068: reducing learning rate of group 0 to 9.5000e-06.
At epoch   67 : train loss: 32.5499, train psnr: 21.3533, val loss: 0.0074, val psnr: 20.9752                                                                                                              
epochs:   3%|█████                                                                                                                                                 | 67/2001 [1:58:51<56:19:38, 104.85s/it]Median error 0.20198461413383484m and 3.9709805250167847 degrees.
Mean error 0.2175127541503081m and 5.486293431416697 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20198461413383484 val_loss =  0.007383425784061511
epochs:   3%|█████                                                                                                                                                 | 68/2001 [1:58:57<56:15:34, 104.78s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 68
For nerf, args.lrate = 1e-09, new_lrate = 9.993646884102575e-10, global_step = 69
At epoch   68 : train loss: 30.3961, train psnr: 21.6428, val loss: 0.0076, val psnr: 20.7311                                                                                                              
epochs:   3%|█████                                                                                                                                                 | 68/2001 [2:00:36<56:15:34, 104.78s/it]Median error 0.20204998552799225m and 3.8881053924560547 degrees.
Mean error 0.21858776814345768m and 5.541144202836612 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20204998552799225 val_loss =  0.007623327575753719
epochs:   3%|█████▏                                                                                                                                                | 69/2001 [2:00:41<56:13:32, 104.77s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 69
For nerf, args.lrate = 1e-09, new_lrate = 9.993554839637096e-10, global_step = 70
At epoch   69 : train loss: 29.1527, train psnr: 21.7694, val loss: 0.0076, val psnr: 20.1599                                                                                                              
epochs:   3%|█████▏                                                                                                                                                | 69/2001 [2:02:20<56:13:32, 104.77s/it]Median error 0.20415788143873215m and 3.9937855005264282 degrees.
Mean error 0.21984997567784811m and 5.515172564307687 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20415788143873215 val_loss =  0.007556946028365899
epochs:   3%|█████▏                                                                                                                                                | 70/2001 [2:02:26<56:08:33, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 70
For nerf, args.lrate = 1e-09, new_lrate = 9.993462796019374e-10, global_step = 71
At epoch   70 : train loss: 29.7015, train psnr: 21.5654, val loss: 0.0075, val psnr: 21.0810                                                                                                              
epochs:   3%|█████▏                                                                                                                                                | 70/2001 [2:04:05<56:08:33, 104.67s/it]Median error 0.20129850506782532m and 3.911091923713684 degrees.
Mean error 0.21649786617667208m and 5.584651295442572 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20129850506782532 val_loss =  0.007528803067720521
epochs:   4%|█████▎                                                                                                                                                | 71/2001 [2:04:11<56:07:24, 104.69s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 71
For nerf, args.lrate = 1e-09, new_lrate = 9.993370753249402e-10, global_step = 72
At epoch   71 : train loss: 30.4020, train psnr: 21.5521, val loss: 0.0075, val psnr: 20.9523                                                                                                              
epochs:   4%|█████▎                                                                                                                                                | 71/2001 [2:05:50<56:07:24, 104.69s/it]Median error 0.20433901250362396m and 3.948045253753662 degrees.
Mean error 0.21817980301736095m and 5.474199603081715 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20433901250362396 val_loss =  0.007466787785204007
epochs:   4%|█████▍                                                                                                                                                | 72/2001 [2:05:55<56:03:53, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 72
For nerf, args.lrate = 1e-09, new_lrate = 9.99327871132717e-10, global_step = 73
At epoch   72 : train loss: 28.7340, train psnr: 21.7659, val loss: 0.0075, val psnr: 20.6979                                                                                                              
epochs:   4%|█████▍                                                                                                                                                | 72/2001 [2:07:34<56:03:53, 104.63s/it]Median error 0.20220061391592026m and 4.020063161849976 degrees.
Mean error 0.21971367797644636m and 5.509601039864756 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20220061391592026 val_loss =  0.007539243962043549
epochs:   4%|█████▍                                                                                                                                                | 73/2001 [2:07:40<56:03:41, 104.68s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 73
For nerf, args.lrate = 1e-09, new_lrate = 9.993186670252673e-10, global_step = 74
At epoch   73 : train loss: 33.1011, train psnr: 21.3209, val loss: 0.0075, val psnr: 20.4990                                                                                                              
epochs:   4%|█████▍                                                                                                                                                | 73/2001 [2:09:19<56:03:41, 104.68s/it]Median error 0.20226996392011642m and 4.233660697937012 degrees.
Mean error 0.2171253767882583m and 5.661643328876631 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20226996392011642 val_loss =  0.007460826617668653
epochs:   4%|█████▌                                                                                                                                                | 74/2001 [2:09:25<56:01:27, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 74
For nerf, args.lrate = 1e-09, new_lrate = 9.9930946300259e-10, global_step = 75
At epoch   74 : train loss: 31.6439, train psnr: 21.4608, val loss: 0.0076, val psnr: 20.9081                                                                                                              
epochs:   4%|█████▌                                                                                                                                                | 74/2001 [2:11:04<56:01:27, 104.66s/it]Median error 0.20113563537597656m and 3.9507241249084473 degrees.
Mean error 0.21851522221346856m and 5.607672315709263 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20113563537597656 val_loss =  0.0076342929704425865
epochs:   4%|█████▌                                                                                                                                                | 75/2001 [2:11:09<55:59:32, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 75
For nerf, args.lrate = 1e-09, new_lrate = 9.993002590646845e-10, global_step = 76
At epoch   75 : train loss: 28.3207, train psnr: 21.8699, val loss: 0.0075, val psnr: 21.2265                                                                                                              
epochs:   4%|█████▌                                                                                                                                                | 75/2001 [2:12:48<55:59:32, 104.66s/it]Median error 0.2021740972995758m and 4.010997533798218 degrees.
Mean error 0.21692691079005297m and 5.593409882383308 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2021740972995758 val_loss =  0.007496905209888871
epochs:   4%|█████▋                                                                                                                                                | 76/2001 [2:12:54<55:58:26, 104.68s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 76
For nerf, args.lrate = 1e-09, new_lrate = 9.9929105521155e-10, global_step = 77
At epoch   76 : train loss: 28.8670, train psnr: 21.8197, val loss: 0.0074, val psnr: 20.5999                                                                                                              
epochs:   4%|█████▋                                                                                                                                                | 76/2001 [2:14:33<55:58:26, 104.68s/it]Median error 0.20110221207141876m and 3.9396125078201294 degrees.
Mean error 0.2145126636860221m and 5.542741077510934 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20110221207141876 val_loss =  0.007353192815520124
epochs:   4%|█████▊                                                                                                                                                | 77/2001 [2:14:39<55:56:26, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 77
For nerf, args.lrate = 1e-09, new_lrate = 9.99281851443186e-10, global_step = 78
At epoch   77 : train loss: 29.6544, train psnr: 21.6905, val loss: 0.0075, val psnr: 21.0781                                                                                                              
epochs:   4%|█████▊                                                                                                                                                | 77/2001 [2:16:18<55:56:26, 104.67s/it]Median error 0.20296448469161987m and 3.945566415786743 degrees.
Mean error 0.21693485982429522m and 5.605272616663201 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20296448469161987 val_loss =  0.007527380851294179
epochs:   4%|█████▊                                                                                                                                                | 78/2001 [2:16:23<55:53:43, 104.64s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 78
For nerf, args.lrate = 1e-09, new_lrate = 9.992726477595913e-10, global_step = 79
At epoch   78 : train loss: 27.8934, train psnr: 21.8005, val loss: 0.0075, val psnr: 20.7443                                                                                                              
epochs:   4%|█████▊                                                                                                                                                | 78/2001 [2:18:02<55:53:43, 104.64s/it]Median error 0.19911745935678482m and 3.952802896499634 degrees.
Mean error 0.21664512436459904m and 5.58373105206229 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19911745935678482 val_loss =  0.007508343842081105
epochs:   4%|█████▉                                                                                                                                                | 79/2001 [2:18:08<55:51:47, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 79
For nerf, args.lrate = 1e-09, new_lrate = 9.992634441607652e-10, global_step = 80
At epoch   79 : train loss: 28.0022, train psnr: 21.8424, val loss: 0.0075, val psnr: 21.1681                                                                                                              
epochs:   4%|█████▉                                                                                                                                                | 79/2001 [2:19:47<55:51:47, 104.63s/it]Median error 0.20349103212356567m and 3.9793509244918823 degrees.
Mean error 0.2180937650398566m and 5.536244927931894 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20349103212356567 val_loss =  0.007519014760678533
epochs:   4%|█████▉                                                                                                                                                | 80/2001 [2:19:52<55:49:14, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 80
For nerf, args.lrate = 1e-09, new_lrate = 9.992542406467069e-10, global_step = 81
At epoch   80 : train loss: 28.9805, train psnr: 21.6373, val loss: 0.0076, val psnr: 21.1336                                                                                                              
epochs:   4%|█████▉                                                                                                                                                | 80/2001 [2:21:32<55:49:14, 104.61s/it]Median error 0.20455840975046158m and 4.044040679931641 degrees.
Mean error 0.21954394830956392m and 5.659497033880066 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20455840975046158 val_loss =  0.007643614533729191
                     Median error 0.20455840975046158m and 4.044040679931641 degrees.
Mean error 0.21954394830956392m and 5.659497033880066 degrees.
epochs:   4%|██████                                                                                                                                                | 81/2001 [2:21:42<56:40:45, 106.27s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 81
For nerf, args.lrate = 1e-09, new_lrate = 9.99245037217416e-10, global_step = 82
At epoch   81 : train loss: 29.5758, train psnr: 21.6673, val loss: 0.0074, val psnr: 20.1708                                                                                                              
epochs:   4%|██████                                                                                                                                                | 81/2001 [2:23:22<56:40:45, 106.27s/it]Median error 0.2017976939678192m and 4.127947568893433 degrees.
Mean error 0.21609333474641507m and 5.618455564233697 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2017976939678192 val_loss =  0.007436027118690154
epochs:   4%|██████▏                                                                                                                                               | 82/2001 [2:23:27<56:22:36, 105.76s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 82
For nerf, args.lrate = 1e-09, new_lrate = 9.99235833872891e-10, global_step = 83
At epoch   82 : train loss: 29.7886, train psnr: 21.6401, val loss: 0.0074, val psnr: 21.0971                                                                                                              
epochs:   4%|██████▏                                                                                                                                               | 82/2001 [2:25:06<56:22:36, 105.76s/it]Median error 0.20024556666612625m and 4.005627155303955 degrees.
Mean error 0.21612456957112078m and 5.536049538687897 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20024556666612625 val_loss =  0.0074320009460699605
epochs:   4%|██████▏                                                                                                                                               | 83/2001 [2:25:12<56:09:42, 105.41s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 83
For nerf, args.lrate = 1e-09, new_lrate = 9.992266306131319e-10, global_step = 84
At epoch   83 : train loss: 27.7776, train psnr: 21.8394, val loss: 0.0075, val psnr: 20.4215                                                                                                              
epochs:   4%|██████▏                                                                                                                                               | 83/2001 [2:26:51<56:09:42, 105.41s/it]Median error 0.20213141292333603m and 4.156490802764893 degrees.
Mean error 0.21794636269676904m and 5.60391618211863 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20213141292333603 val_loss =  0.007459947476612436
epochs:   4%|██████▎                                                                                                                                               | 84/2001 [2:26:56<55:59:22, 105.14s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 84
For nerf, args.lrate = 1e-09, new_lrate = 9.992174274381376e-10, global_step = 85
At epoch   84 : train loss: 29.9933, train psnr: 21.5368, val loss: 0.0075, val psnr: 20.2023                                                                                                              
epochs:   4%|██████▎                                                                                                                                               | 84/2001 [2:28:35<55:59:22, 105.14s/it]Median error 0.2017650455236435m and 4.118370771408081 degrees.
Mean error 0.2178885908759678m and 5.654424453553883 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2017650455236435 val_loss =  0.007533700850500955
epochs:   4%|██████▎                                                                                                                                               | 85/2001 [2:28:41<55:54:24, 105.04s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 85
For nerf, args.lrate = 1e-09, new_lrate = 9.99208224347907e-10, global_step = 86
At epoch   85 : train loss: 29.1620, train psnr: 21.6360, val loss: 0.0076, val psnr: 21.0360                                                                                                              
epochs:   4%|██████▎                                                                                                                                               | 85/2001 [2:30:20<55:54:24, 105.04s/it]Median error 0.20538686215877533m and 3.9190917015075684 degrees.
Mean error 0.21971996483743672m and 5.590929226897024 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20538686215877533 val_loss =  0.007646513038538401
epochs:   4%|██████▍                                                                                                                                               | 86/2001 [2:30:26<55:49:26, 104.94s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 86
For nerf, args.lrate = 1e-09, new_lrate = 9.991990213424399e-10, global_step = 87
At epoch   86 : train loss: 30.3782, train psnr: 21.5593, val loss: 0.0075, val psnr: 20.7180                                                                                                              
epochs:   4%|██████▍                                                                                                                                               | 86/2001 [2:32:05<55:49:26, 104.94s/it]Median error 0.2015029788017273m and 3.9771872758865356 degrees.
Mean error 0.2176464406381312m and 5.612241484315289 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2015029788017273 val_loss =  0.007533246870807783
epochs:   4%|██████▌                                                                                                                                               | 87/2001 [2:32:10<55:43:51, 104.82s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 87
For nerf, args.lrate = 1e-09, new_lrate = 9.99189818421735e-10, global_step = 88
At epoch   87 : train loss: 30.4036, train psnr: 21.6107, val loss: 0.0074, val psnr: 20.8782                                                                                                              
epochs:   4%|██████▌                                                                                                                                               | 87/2001 [2:33:49<55:43:51, 104.82s/it]Median error 0.20113187283277512m and 4.024345397949219 degrees.
Mean error 0.2153858050538099m and 5.634982395509959 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20113187283277512 val_loss =  0.0074457198237436574
epochs:   4%|██████▌                                                                                                                                               | 88/2001 [2:33:55<55:39:04, 104.73s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 88
For nerf, args.lrate = 1e-09, new_lrate = 9.991806155857917e-10, global_step = 89
At epoch   88 : train loss: 31.5748, train psnr: 21.5641, val loss: 0.0074, val psnr: 20.6311                                                                                                              
epochs:   4%|██████▌                                                                                                                                               | 88/2001 [2:35:34<55:39:04, 104.73s/it]Median error 0.20207640528678894m and 3.7514121532440186 degrees.
Mean error 0.21646791682597477m and 5.457745831746322 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20207640528678894 val_loss =  0.007405056840262229
epochs:   4%|██████▋                                                                                                                                               | 89/2001 [2:35:40<55:38:19, 104.76s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 89
For nerf, args.lrate = 1e-09, new_lrate = 9.991714128346095e-10, global_step = 90
At epoch   89 : train loss: 29.8161, train psnr: 21.7406, val loss: 0.0075, val psnr: 20.6536                                                                                                              
epochs:   4%|██████▋                                                                                                                                               | 89/2001 [2:37:19<55:38:19, 104.76s/it]Median error 0.20091620832681656m and 3.9064841270446777 degrees.
Mean error 0.21583568971030986m and 5.544793309289434 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20091620832681656 val_loss =  0.007537909565527164
epochs:   4%|██████▋                                                                                                                                               | 90/2001 [2:37:24<55:34:59, 104.71s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 90
For nerf, args.lrate = 1e-09, new_lrate = 9.991622101681873e-10, global_step = 91
At epoch   90 : train loss: 29.9219, train psnr: 21.6001, val loss: 0.0075, val psnr: 21.1935                                                                                                              
epochs:   4%|██████▋                                                                                                                                               | 90/2001 [2:39:03<55:34:59, 104.71s/it]Median error 0.20143171399831772m and 3.9564651250839233 degrees.
Mean error 0.21633626402238845m and 5.578894635172267 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20143171399831772 val_loss =  0.007515952449024707
epochs:   5%|██████▊                                                                                                                                               | 91/2001 [2:39:09<55:33:26, 104.72s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 91
For nerf, args.lrate = 1e-09, new_lrate = 9.991530075865243e-10, global_step = 92
At epoch   91 : train loss: 27.9429, train psnr: 21.9224, val loss: 0.0075, val psnr: 21.0055                                                                                                              
epochs:   5%|██████▊                                                                                                                                               | 91/2001 [2:40:48<55:33:26, 104.72s/it]Median error 0.20198176056146622m and 4.082285642623901 degrees.
Mean error 0.21593756718101048m and 5.648721414418356 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20198176056146622 val_loss =  0.007465113476479637
epochs:   5%|██████▉                                                                                                                                               | 92/2001 [2:40:53<55:30:20, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 92
For nerf, args.lrate = 1e-09, new_lrate = 9.991438050896199e-10, global_step = 93
At epoch   92 : train loss: 28.7837, train psnr: 21.8035, val loss: 0.0075, val psnr: 20.9446                                                                                                              
epochs:   5%|██████▉                                                                                                                                               | 92/2001 [2:42:33<55:30:20, 104.67s/it]Median error 0.20282584428787231m and 4.010119676589966 degrees.
Mean error 0.21763157776296743m and 5.61774653015349 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20282584428787231 val_loss =  0.0075312719276008295
epochs:   5%|██████▉                                                                                                                                               | 93/2001 [2:42:38<55:28:32, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 93
For nerf, args.lrate = 1e-09, new_lrate = 9.991346026774733e-10, global_step = 94
At epoch   93 : train loss: 29.0494, train psnr: 21.7890, val loss: 0.0075, val psnr: 20.4790                                                                                                              
epochs:   5%|██████▉                                                                                                                                               | 93/2001 [2:44:17<55:28:32, 104.67s/it]Median error 0.20312970876693726m and 3.921986699104309 degrees.
Mean error 0.21629812671361784m and 5.5069978179839945 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20312970876693726 val_loss =  0.00745580743559434
epochs:   5%|███████                                                                                                                                               | 94/2001 [2:44:23<55:27:32, 104.69s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 94
For nerf, args.lrate = 1e-09, new_lrate = 9.991254003500833e-10, global_step = 95
At epoch   94 : train loss: 30.3108, train psnr: 21.4794, val loss: 0.0077, val psnr: 20.1623                                                                                                              
epochs:   5%|███████                                                                                                                                               | 94/2001 [2:46:02<55:27:32, 104.69s/it]Median error 0.20232323557138443m and 4.060172080993652 degrees.
Mean error 0.21919963312399413m and 5.670885223005465 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20232323557138443 val_loss =  0.007668935854578492
epochs:   5%|███████                                                                                                                                               | 95/2001 [2:46:07<55:23:37, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 95
For nerf, args.lrate = 1e-09, new_lrate = 9.991161981074498e-10, global_step = 96
At epoch   95 : train loss: 30.0695, train psnr: 21.6620, val loss: 0.0073, val psnr: 20.9130                                                                                                              
epochs:   5%|███████                                                                                                                                               | 95/2001 [2:47:47<55:23:37, 104.63s/it]Median error 0.20260444283485413m and 3.874696135520935 degrees.
Mean error 0.21625918511919648m and 5.418407577433084 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20260444283485413 val_loss =  0.007332170652869551
epochs:   5%|███████▏                                                                                                                                              | 96/2001 [2:47:52<55:22:43, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 96
For nerf, args.lrate = 1e-09, new_lrate = 9.991069959495717e-10, global_step = 97
At epoch   96 : train loss: 28.6029, train psnr: 21.6989, val loss: 0.0075, val psnr: 21.0544                                                                                                              
epochs:   5%|███████▏                                                                                                                                              | 96/2001 [2:49:31<55:22:43, 104.65s/it]Median error 0.20367875695228577m and 3.9170925617218018 degrees.
Mean error 0.21841839764659343m and 5.526560152469859 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20367875695228577 val_loss =  0.007516214236904474
epochs:   5%|███████▎                                                                                                                                              | 97/2001 [2:49:37<55:20:26, 104.64s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 97
For nerf, args.lrate = 1e-09, new_lrate = 9.990977938764482e-10, global_step = 98
At epoch   97 : train loss: 30.6192, train psnr: 21.5866, val loss: 0.0075, val psnr: 20.8983                                                                                                              
epochs:   5%|███████▎                                                                                                                                              | 97/2001 [2:51:16<55:20:26, 104.64s/it]Median error 0.201641283929348m and 4.108664035797119 degrees.
Mean error 0.21513503212255505m and 5.721690850038278 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.201641283929348 val_loss =  0.0075320964342866685
epochs:   5%|███████▎                                                                                                                                              | 98/2001 [2:51:21<55:18:50, 104.64s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 98
For nerf, args.lrate = 1e-09, new_lrate = 9.990885918880785e-10, global_step = 99
At epoch   98 : train loss: 29.1211, train psnr: 21.7167, val loss: 0.0077, val psnr: 21.0349                                                                                                              
epochs:   5%|███████▎                                                                                                                                              | 98/2001 [2:53:00<55:18:50, 104.64s/it]Median error 0.20514825731515884m and 4.010607481002808 degrees.
Mean error 0.22003603267374067m and 5.595387255705079 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20514825731515884 val_loss =  0.007686958684290708
epochs:   5%|███████▍                                                                                                                                              | 99/2001 [2:53:06<55:17:15, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 99
For nerf, args.lrate = 1e-09, new_lrate = 9.990793899844618e-10, global_step = 100
At epoch   99 : train loss: 32.6183, train psnr: 21.3864, val loss: 0.0075, val psnr: 20.5310                                                                                                              
epochs:   5%|███████▍                                                                                                                                              | 99/2001 [2:54:45<55:17:15, 104.65s/it]Median error 0.2017051950097084m and 3.848137855529785 degrees.
Mean error 0.21661537357413696m and 5.495698872033643 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2017051950097084 val_loss =  0.007456392620451327
epochs:   5%|███████▍                                                                                                                                             | 100/2001 [2:54:50<55:14:19, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 100
For nerf, args.lrate = 1e-09, new_lrate = 9.990701881655975e-10, global_step = 101
At epoch  100 : train loss: 28.8955, train psnr: 21.6487, val loss: 0.0077, val psnr: 20.3627                                                                                                              
epochs:   5%|███████▍                                                                                                                                             | 100/2001 [2:56:30<55:14:19, 104.61s/it]Median error 0.20352895557880402m and 4.123025178909302 degrees.
Mean error 0.21955439345043923m and 5.699046997587208 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20352895557880402 val_loss =  0.0076699998658758435
                     Median error 0.20352895557880402m and 4.123025178909302 degrees.
Mean error 0.21955439345043923m and 5.699046997587208 degrees.
epochs:   5%|███████▌                                                                                                                                             | 101/2001 [2:56:41<56:06:02, 106.30s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 101
For nerf, args.lrate = 1e-09, new_lrate = 9.990609864314847e-10, global_step = 102
At epoch  101 : train loss: 28.2482, train psnr: 21.7819, val loss: 0.0075, val psnr: 20.7766                                                                                                              
epochs:   5%|███████▌                                                                                                                                             | 101/2001 [2:58:20<56:06:02, 106.30s/it]Median error 0.2028459534049034m and 3.899567484855652 degrees.
Mean error 0.2157943997803608m and 5.565393659538827 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2028459534049034 val_loss =  0.007450938100718256
epochs:   5%|███████▌                                                                                                                                             | 102/2001 [2:58:25<55:48:47, 105.81s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 102
For nerf, args.lrate = 1e-09, new_lrate = 9.990517847821225e-10, global_step = 103
At epoch  102 : train loss: 28.2831, train psnr: 21.7754, val loss: 0.0074, val psnr: 21.0966                                                                                                              
epochs:   5%|███████▌                                                                                                                                             | 102/2001 [3:00:04<55:48:47, 105.81s/it]Median error 0.19886570423841476m and 3.952903389930725 degrees.
Mean error 0.2148035308911733m and 5.587849132203862 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19886570423841476 val_loss =  0.0074337529712712475
epochs:   5%|███████▋                                                                                                                                             | 103/2001 [3:00:10<55:33:15, 105.37s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 103
For nerf, args.lrate = 1e-09, new_lrate = 9.9904258321751e-10, global_step = 104
At epoch  103 : train loss: 29.5701, train psnr: 21.5882, val loss: 0.0075, val psnr: 20.7573                                                                                                              
epochs:   5%|███████▋                                                                                                                                             | 103/2001 [3:01:48<55:33:15, 105.37s/it]Median error 0.20059515535831451m and 4.069225311279297 degrees.
Mean error 0.21572835124682196m and 5.652926926700934 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20059515535831451 val_loss =  0.007506456675614406
epochs:   5%|███████▋                                                                                                                                             | 104/2001 [3:01:54<55:20:35, 105.03s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 104
For nerf, args.lrate = 1e-09, new_lrate = 9.990333817376471e-10, global_step = 105
At epoch  104 : train loss: 31.7288, train psnr: 21.3063, val loss: 0.0076, val psnr: 20.3798                                                                                                              
epochs:   5%|███████▋                                                                                                                                             | 104/2001 [3:03:33<55:20:35, 105.03s/it]Median error 0.2024254947900772m and 4.105138301849365 degrees.
Mean error 0.21837540018006496m and 5.66290228563523 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2024254947900772 val_loss =  0.007615629973656263
epochs:   5%|███████▊                                                                                                                                             | 105/2001 [3:03:39<55:15:06, 104.91s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 105
For nerf, args.lrate = 1e-09, new_lrate = 9.990241803425323e-10, global_step = 106
At epoch  105 : train loss: 31.7018, train psnr: 21.4473, val loss: 0.0076, val psnr: 20.6950                                                                                                              
epochs:   5%|███████▊                                                                                                                                             | 105/2001 [3:05:18<55:15:06, 104.91s/it]Median error 0.20515494793653488m and 4.004454135894775 degrees.
Mean error 0.2181819826854687m and 5.609121414451947 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20515494793653488 val_loss =  0.007575011513129241
epochs:   5%|███████▉                                                                                                                                             | 106/2001 [3:05:23<55:11:55, 104.86s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 106
For nerf, args.lrate = 1e-09, new_lrate = 9.990149790321653e-10, global_step = 107
At epoch  106 : train loss: 30.1418, train psnr: 21.6146, val loss: 0.0075, val psnr: 21.2327                                                                                                              
epochs:   5%|███████▉                                                                                                                                             | 106/2001 [3:07:02<55:11:55, 104.86s/it]Median error 0.20048339664936066m and 3.8669098615646362 degrees.
Mean error 0.21703116835928277m and 5.490081167655435 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20048339664936066 val_loss =  0.007479025616092199
epochs:   5%|███████▉                                                                                                                                             | 107/2001 [3:07:08<55:07:30, 104.78s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 107
For nerf, args.lrate = 1e-09, new_lrate = 9.99005777806545e-10, global_step = 108
At epoch  107 : train loss: 29.1133, train psnr: 21.6560, val loss: 0.0076, val psnr: 20.6737                                                                                                              
epochs:   5%|███████▉                                                                                                                                             | 107/2001 [3:08:47<55:07:30, 104.78s/it]Median error 0.2026682272553444m and 3.942790389060974 degrees.
Mean error 0.2168042738299802m and 5.601822233875754 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2026682272553444 val_loss =  0.007605923687983686
epochs:   5%|████████                                                                                                                                             | 108/2001 [3:08:53<55:05:55, 104.78s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 108
For nerf, args.lrate = 1e-09, new_lrate = 9.989965766656705e-10, global_step = 109
At epoch  108 : train loss: 29.6952, train psnr: 21.6436, val loss: 0.0076, val psnr: 20.8649                                                                                                              
epochs:   5%|████████                                                                                                                                             | 108/2001 [3:10:32<55:05:55, 104.78s/it]Median error 0.20058388262987137m and 4.03007960319519 degrees.
Mean error 0.21664057326642608m and 5.649586401849623 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20058388262987137 val_loss =  0.0075874738004757325
epochs:   5%|████████                                                                                                                                             | 109/2001 [3:10:37<55:02:53, 104.74s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 109
For nerf, args.lrate = 1e-09, new_lrate = 9.989873756095416e-10, global_step = 110
At epoch  109 : train loss: 27.9350, train psnr: 21.9180, val loss: 0.0074, val psnr: 20.8778                                                                                                              
epochs:   5%|████████                                                                                                                                             | 109/2001 [3:12:17<55:02:53, 104.74s/it]Median error 0.1999833881855011m and 4.013225078582764 degrees.
Mean error 0.21540212529421093m and 5.548719225956602 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1999833881855011 val_loss =  0.007436242217265412
epochs:   5%|████████▏                                                                                                                                            | 110/2001 [3:12:22<55:00:24, 104.72s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 110
For nerf, args.lrate = 1e-09, new_lrate = 9.989781746381571e-10, global_step = 111
At epoch  110 : train loss: 27.4070, train psnr: 21.9632, val loss: 0.0076, val psnr: 20.9250                                                                                                              
epochs:   5%|████████▏                                                                                                                                            | 110/2001 [3:14:01<55:00:24, 104.72s/it]Median error 0.2036164253950119m and 3.939809799194336 degrees.
Mean error 0.21845160428479857m and 5.549255402585273 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2036164253950119 val_loss =  0.007603324021614908
epochs:   6%|████████▎                                                                                                                                            | 111/2001 [3:14:07<54:58:14, 104.71s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 111
For nerf, args.lrate = 1e-09, new_lrate = 9.98968973751516e-10, global_step = 112
At epoch  111 : train loss: 27.4801, train psnr: 21.9345, val loss: 0.0075, val psnr: 20.9364                                                                                                              
epochs:   6%|████████▎                                                                                                                                            | 111/2001 [3:15:46<54:58:14, 104.71s/it]Median error 0.20401819795370102m and 4.166935920715332 degrees.
Mean error 0.2186743711019576m and 5.584624915108507 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20401819795370102 val_loss =  0.007512913891295752
epochs:   6%|████████▎                                                                                                                                            | 112/2001 [3:15:51<54:57:23, 104.73s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 112
For nerf, args.lrate = 1e-09, new_lrate = 9.989597729496182e-10, global_step = 113
At epoch  112 : train loss: 27.9988, train psnr: 21.8413, val loss: 0.0075, val psnr: 21.2143                                                                                                              
epochs:   6%|████████▎                                                                                                                                            | 112/2001 [3:17:31<54:57:23, 104.73s/it]Median error 0.20258553326129913m and 4.224961996078491 degrees.
Mean error 0.2158639154242359m and 5.729977282706784 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20258553326129913 val_loss =  0.00750500533436927
epochs:   6%|████████▍                                                                                                                                            | 113/2001 [3:17:36<54:54:54, 104.71s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 113
For nerf, args.lrate = 1e-09, new_lrate = 9.989505722324625e-10, global_step = 114
At epoch  113 : train loss: 28.3504, train psnr: 21.8456, val loss: 0.0076, val psnr: 20.7387                                                                                                              
epochs:   6%|████████▍                                                                                                                                            | 113/2001 [3:19:15<54:54:54, 104.71s/it]Median error 0.20280832052230835m and 4.132505893707275 degrees.
Mean error 0.2176676587265754m and 5.711608778308277 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20280832052230835 val_loss =  0.007561878240786291
epochs:   6%|████████▍                                                                                                                                            | 114/2001 [3:19:21<54:50:32, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 114
For nerf, args.lrate = 1e-09, new_lrate = 9.989413716000479e-10, global_step = 115
At epoch  114 : train loss: 29.4469, train psnr: 21.5932, val loss: 0.0075, val psnr: 20.4711                                                                                                              
epochs:   6%|████████▍                                                                                                                                            | 114/2001 [3:21:00<54:50:32, 104.63s/it]Median error 0.2017030268907547m and 4.035902976989746 degrees.
Mean error 0.21535841370687672m and 5.622340690208833 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2017030268907547 val_loss =  0.007467448286429261
epochs:   6%|████████▌                                                                                                                                            | 115/2001 [3:21:05<54:50:14, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 115
For nerf, args.lrate = 1e-09, new_lrate = 9.989321710523738e-10, global_step = 116
At epoch  115 : train loss: 29.6676, train psnr: 21.5846, val loss: 0.0075, val psnr: 20.5044                                                                                                              
epochs:   6%|████████▌                                                                                                                                            | 115/2001 [3:22:44<54:50:14, 104.67s/it]Median error 0.20058684796094894m and 3.8878049850463867 degrees.
Mean error 0.21594355165249543m and 5.579908017717633 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20058684796094894 val_loss =  0.00745441665626845
epochs:   6%|████████▋                                                                                                                                            | 116/2001 [3:22:50<54:48:03, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 116
For nerf, args.lrate = 1e-09, new_lrate = 9.989229705894397e-10, global_step = 117
At epoch  116 : train loss: 28.7861, train psnr: 21.7196, val loss: 0.0075, val psnr: 20.6433                                                                                                              
epochs:   6%|████████▋                                                                                                                                            | 116/2001 [3:24:29<54:48:03, 104.66s/it]Median error 0.20307258516550064m and 4.061618804931641 degrees.
Mean error 0.2174627180757974m and 5.6328928007288015 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20307258516550064 val_loss =  0.007545774487107153
epochs:   6%|████████▋                                                                                                                                            | 117/2001 [3:24:35<54:45:57, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 117
For nerf, args.lrate = 1e-09, new_lrate = 9.989137702112446e-10, global_step = 118
At epoch  117 : train loss: 29.8487, train psnr: 21.6301, val loss: 0.0076, val psnr: 20.6408                                                                                                              
epochs:   6%|████████▋                                                                                                                                            | 117/2001 [3:26:14<54:45:57, 104.65s/it]Median error 0.2035738155245781m and 3.8753020763397217 degrees.
Mean error 0.21915944767851941m and 5.491058795648789 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2035738155245781 val_loss =  0.007597719751053225
epochs:   6%|████████▊                                                                                                                                            | 118/2001 [3:26:19<54:44:55, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.5e-06, global_step = 118
For nerf, args.lrate = 1e-09, new_lrate = 9.989045699177878e-10, global_step = 119
Epoch 00119: reducing learning rate of group 0 to 9.0250e-06.
At epoch  118 : train loss: 30.3620, train psnr: 21.5585, val loss: 0.0075, val psnr: 20.9296                                                                                                              
epochs:   6%|████████▊                                                                                                                                            | 118/2001 [3:27:59<54:44:55, 104.67s/it]Median error 0.20219429582357407m and 3.8865976333618164 degrees.
Mean error 0.21679566103422088m and 5.54579631507638 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20219429582357407 val_loss =  0.007491859603642702
epochs:   6%|████████▊                                                                                                                                            | 119/2001 [3:28:04<54:43:17, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 119
For nerf, args.lrate = 1e-09, new_lrate = 9.988953697090684e-10, global_step = 120
At epoch  119 : train loss: 27.7989, train psnr: 21.8648, val loss: 0.0076, val psnr: 21.2176                                                                                                              
epochs:   6%|████████▊                                                                                                                                            | 119/2001 [3:29:43<54:43:17, 104.67s/it]Median error 0.2026149332523346m and 4.066338539123535 degrees.
Mean error 0.21725174377442372m and 5.618306325906925 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2026149332523346 val_loss =  0.007565044641612227
epochs:   6%|████████▉                                                                                                                                            | 120/2001 [3:29:48<54:39:35, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 120
For nerf, args.lrate = 1e-09, new_lrate = 9.988861695850853e-10, global_step = 121
At epoch  120 : train loss: 29.2111, train psnr: 21.7849, val loss: 0.0075, val psnr: 20.8543                                                                                                              
epochs:   6%|████████▉                                                                                                                                            | 120/2001 [3:31:28<54:39:35, 104.61s/it]Median error 0.1993161290884018m and 3.9519121646881104 degrees.
Mean error 0.21613213855788294m and 5.58453974981419 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1993161290884018 val_loss =  0.007493461915043226
                     Median error 0.1993161290884018m and 3.9519121646881104 degrees.
Mean error 0.21613213855788294m and 5.58453974981419 degrees.
epochs:   6%|█████████                                                                                                                                            | 121/2001 [3:31:39<55:29:19, 106.25s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 121
For nerf, args.lrate = 1e-09, new_lrate = 9.988769695458385e-10, global_step = 122
At epoch  121 : train loss: 29.5683, train psnr: 21.6536, val loss: 0.0075, val psnr: 21.2824                                                                                                              
epochs:   6%|█████████                                                                                                                                            | 121/2001 [3:33:18<55:29:19, 106.25s/it]Median error 0.20314976572990417m and 3.9484450817108154 degrees.
Mean error 0.2170450400546012m and 5.522497432193293 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20314976572990417 val_loss =  0.007457712494642361
epochs:   6%|█████████                                                                                                                                            | 122/2001 [3:33:23<55:12:22, 105.77s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 122
For nerf, args.lrate = 1e-09, new_lrate = 9.988677695913267e-10, global_step = 123
At epoch  122 : train loss: 26.5677, train psnr: 22.0579, val loss: 0.0075, val psnr: 20.7114                                                                                                              
epochs:   6%|█████████                                                                                                                                            | 122/2001 [3:35:02<55:12:22, 105.77s/it]Median error 0.2043638899922371m and 4.132694959640503 degrees.
Mean error 0.21748023082762352m and 5.619105313109 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2043638899922371 val_loss =  0.007531004870528528
epochs:   6%|█████████▏                                                                                                                                           | 123/2001 [3:35:08<55:00:10, 105.44s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 123
For nerf, args.lrate = 1e-09, new_lrate = 9.988585697215491e-10, global_step = 124
At epoch  123 : train loss: 26.1556, train psnr: 22.0618, val loss: 0.0075, val psnr: 21.0779                                                                                                              
epochs:   6%|█████████▏                                                                                                                                           | 123/2001 [3:36:47<55:00:10, 105.44s/it]Median error 0.20126980543136597m and 3.9056771993637085 degrees.
Mean error 0.21761520841132534m and 5.536142608965275 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20126980543136597 val_loss =  0.007504088323205608
epochs:   6%|█████████▏                                                                                                                                           | 124/2001 [3:36:53<54:51:21, 105.21s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 124
For nerf, args.lrate = 1e-09, new_lrate = 9.988493699365052e-10, global_step = 125
At epoch  124 : train loss: 26.3981, train psnr: 22.0750, val loss: 0.0075, val psnr: 20.6341                                                                                                              
epochs:   6%|█████████▏                                                                                                                                           | 124/2001 [3:38:32<54:51:21, 105.21s/it]Median error 0.20102065056562424m and 4.0425896644592285 degrees.
Mean error 0.21694276808395319m and 5.640273349819637 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20102065056562424 val_loss =  0.007506348602339999
epochs:   6%|█████████▎                                                                                                                                           | 125/2001 [3:38:37<54:45:19, 105.07s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 125
For nerf, args.lrate = 1e-09, new_lrate = 9.98840170236194e-10, global_step = 126
At epoch  125 : train loss: 28.4064, train psnr: 21.8166, val loss: 0.0076, val psnr: 21.4260                                                                                                              
epochs:   6%|█████████▎                                                                                                                                           | 125/2001 [3:40:16<54:45:19, 105.07s/it]Median error 0.20206841826438904m and 4.021908760070801 degrees.
Mean error 0.21752952998466338m and 5.6228255028968395 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20206841826438904 val_loss =  0.00756993175727911
epochs:   6%|█████████▍                                                                                                                                           | 126/2001 [3:40:22<54:39:38, 104.95s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 126
For nerf, args.lrate = 1e-09, new_lrate = 9.98830970620615e-10, global_step = 127
At epoch  126 : train loss: 27.8219, train psnr: 21.8632, val loss: 0.0076, val psnr: 20.5470                                                                                                              
epochs:   6%|█████████▍                                                                                                                                           | 126/2001 [3:42:01<54:39:38, 104.95s/it]Median error 0.20296987891197205m and 4.0279412269592285 degrees.
Mean error 0.21888316373306851m and 5.5763283343570915 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20296987891197205 val_loss =  0.007591815498488558
epochs:   6%|█████████▍                                                                                                                                           | 127/2001 [3:42:07<54:36:08, 104.89s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 127
For nerf, args.lrate = 1e-09, new_lrate = 9.988217710897667e-10, global_step = 128
At epoch  127 : train loss: 28.3448, train psnr: 21.8620, val loss: 0.0074, val psnr: 21.1739                                                                                                              
epochs:   6%|█████████▍                                                                                                                                           | 127/2001 [3:43:46<54:36:08, 104.89s/it]Median error 0.20133599638938904m and 4.0410380363464355 degrees.
Mean error 0.21556396650429438m and 5.575744241838031 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20133599638938904 val_loss =  0.007407558003774192
epochs:   6%|█████████▌                                                                                                                                           | 128/2001 [3:43:51<54:30:36, 104.77s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 128
For nerf, args.lrate = 1e-09, new_lrate = 9.98812571643649e-10, global_step = 129
At epoch  128 : train loss: 26.6766, train psnr: 22.0183, val loss: 0.0075, val psnr: 20.8725                                                                                                              
epochs:   6%|█████████▌                                                                                                                                           | 128/2001 [3:45:30<54:30:36, 104.77s/it]Median error 0.20281822979450226m and 4.041329860687256 degrees.
Mean error 0.2181081805295247m and 5.588577521474738 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20281822979450226 val_loss =  0.0075198830096262015
epochs:   6%|█████████▌                                                                                                                                           | 129/2001 [3:45:36<54:28:21, 104.75s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 129
For nerf, args.lrate = 1e-09, new_lrate = 9.988033722822612e-10, global_step = 130
At epoch  129 : train loss: 26.4952, train psnr: 22.0501, val loss: 0.0074, val psnr: 20.5067                                                                                                              
epochs:   6%|█████████▌                                                                                                                                           | 129/2001 [3:47:15<54:28:21, 104.75s/it]Median error 0.20037941634655m and 4.1230247020721436 degrees.
Mean error 0.21356396272265718m and 5.669477734126542 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20037941634655 val_loss =  0.007381314876816788
epochs:   6%|█████████▋                                                                                                                                           | 130/2001 [3:47:20<54:23:32, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 130
For nerf, args.lrate = 1e-09, new_lrate = 9.98794173005602e-10, global_step = 131
At epoch  130 : train loss: 25.9830, train psnr: 22.1265, val loss: 0.0074, val psnr: 21.1856                                                                                                              
epochs:   6%|█████████▋                                                                                                                                           | 130/2001 [3:49:00<54:23:32, 104.66s/it]Median error 0.20064616203308105m and 4.085731267929077 degrees.
Mean error 0.215781569944672m and 5.580860926554753 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20064616203308105 val_loss =  0.007442222147374527
epochs:   7%|█████████▊                                                                                                                                           | 131/2001 [3:49:05<54:21:33, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 131
For nerf, args.lrate = 1e-09, new_lrate = 9.98784973813671e-10, global_step = 132
At epoch  131 : train loss: 29.4347, train psnr: 21.7913, val loss: 0.0076, val psnr: 20.6364                                                                                                              
epochs:   7%|█████████▊                                                                                                                                           | 131/2001 [3:50:44<54:21:33, 104.65s/it]Median error 0.20322273671627045m and 3.8675156831741333 degrees.
Mean error 0.21894905175108778m and 5.532225211411111 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20322273671627045 val_loss =  0.0076372943287483196
epochs:   7%|█████████▊                                                                                                                                           | 132/2001 [3:50:50<54:19:16, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 132
For nerf, args.lrate = 1e-09, new_lrate = 9.987757747064673e-10, global_step = 133
At epoch  132 : train loss: 27.0898, train psnr: 21.9759, val loss: 0.0074, val psnr: 20.7965                                                                                                              
epochs:   7%|█████████▊                                                                                                                                           | 132/2001 [3:52:29<54:19:16, 104.63s/it]Median error 0.20056834071874619m and 3.9542895555496216 degrees.
Mean error 0.21587618065221229m and 5.5302652490706095 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20056834071874619 val_loss =  0.007441775418570791
epochs:   7%|█████████▉                                                                                                                                           | 133/2001 [3:52:34<54:18:02, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 133
For nerf, args.lrate = 1e-09, new_lrate = 9.9876657568399e-10, global_step = 134
At epoch  133 : train loss: 27.4484, train psnr: 21.9239, val loss: 0.0075, val psnr: 20.2774                                                                                                              
epochs:   7%|█████████▉                                                                                                                                           | 133/2001 [3:54:13<54:18:02, 104.65s/it]Median error 0.19966477900743484m and 3.903676986694336 degrees.
Mean error 0.21616737105646114m and 5.528213338609709 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.19966477900743484 val_loss =  0.00746574388181087
epochs:   7%|█████████▉                                                                                                                                           | 134/2001 [3:54:19<54:14:54, 104.60s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 134
For nerf, args.lrate = 1e-09, new_lrate = 9.987573767462386e-10, global_step = 135
At epoch  134 : train loss: 30.6244, train psnr: 21.6325, val loss: 0.0076, val psnr: 21.0090                                                                                                              
epochs:   7%|█████████▉                                                                                                                                           | 134/2001 [3:55:58<54:14:54, 104.60s/it]Median error 0.2029680460691452m and 3.9651631116867065 degrees.
Mean error 0.21800667705836324m and 5.58009169730339 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2029680460691452 val_loss =  0.007620482291628725
epochs:   7%|██████████                                                                                                                                           | 135/2001 [3:56:03<54:12:55, 104.60s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 135
For nerf, args.lrate = 1e-09, new_lrate = 9.987481778932122e-10, global_step = 136
At epoch  135 : train loss: 29.7651, train psnr: 21.5842, val loss: 0.0074, val psnr: 21.1229                                                                                                              
epochs:   7%|██████████                                                                                                                                           | 135/2001 [3:57:42<54:12:55, 104.60s/it]Median error 0.2013346254825592m and 4.1329779624938965 degrees.
Mean error 0.21522739025111864m and 5.647623787947029 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2013346254825592 val_loss =  0.0074167999740643335
epochs:   7%|██████████▏                                                                                                                                          | 136/2001 [3:57:48<54:10:34, 104.58s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 136
For nerf, args.lrate = 1e-09, new_lrate = 9.9873897912491e-10, global_step = 137
At epoch  136 : train loss: 28.1530, train psnr: 21.8274, val loss: 0.0076, val psnr: 21.0244                                                                                                              
epochs:   7%|██████████▏                                                                                                                                          | 136/2001 [3:59:27<54:10:34, 104.58s/it]Median error 0.20268776267766953m and 3.9795491695404053 degrees.
Mean error 0.2182272464708097m and 5.581698983455235 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20268776267766953 val_loss =  0.007575926725805792
epochs:   7%|██████████▏                                                                                                                                          | 137/2001 [3:59:32<54:09:01, 104.58s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 137
For nerf, args.lrate = 1e-09, new_lrate = 9.98729780441331e-10, global_step = 138
At epoch  137 : train loss: 27.1982, train psnr: 21.8985, val loss: 0.0074, val psnr: 19.9693                                                                                                              
epochs:   7%|██████████▏                                                                                                                                          | 137/2001 [4:01:12<54:09:01, 104.58s/it]Median error 0.20063113421201706m and 4.070764064788818 degrees.
Mean error 0.21478078543747725m and 5.591862909857802 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20063113421201706 val_loss =  0.007372285632580035
epochs:   7%|██████████▎                                                                                                                                          | 138/2001 [4:01:17<54:08:34, 104.62s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 138
For nerf, args.lrate = 1e-09, new_lrate = 9.987205818424746e-10, global_step = 139
At epoch  138 : train loss: 27.8054, train psnr: 21.8393, val loss: 0.0076, val psnr: 21.0862                                                                                                              
epochs:   7%|██████████▎                                                                                                                                          | 138/2001 [4:02:56<54:08:34, 104.62s/it]Median error 0.2028985321521759m and 3.918392062187195 degrees.
Mean error 0.21778148782971177m and 5.557283374763694 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2028985321521759 val_loss =  0.0076007786741139
epochs:   7%|██████████▎                                                                                                                                          | 139/2001 [4:03:02<54:06:21, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 139
For nerf, args.lrate = 1e-09, new_lrate = 9.987113833283402e-10, global_step = 140
At epoch  139 : train loss: 27.8741, train psnr: 21.8974, val loss: 0.0076, val psnr: 21.1956                                                                                                              
epochs:   7%|██████████▎                                                                                                                                          | 139/2001 [4:04:41<54:06:21, 104.61s/it]Median error 0.2022371143102646m and 3.9504263401031494 degrees.
Mean error 0.217993370664536m and 5.548047987465193 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2022371143102646 val_loss =  0.007551812801650548
epochs:   7%|██████████▍                                                                                                                                          | 140/2001 [4:04:46<54:03:57, 104.59s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 140
For nerf, args.lrate = 1e-09, new_lrate = 9.987021848989268e-10, global_step = 141
At epoch  140 : train loss: 26.3486, train psnr: 22.0710, val loss: 0.0076, val psnr: 20.8874                                                                                                              
epochs:   7%|██████████▍                                                                                                                                          | 140/2001 [4:06:26<54:03:57, 104.59s/it]Median error 0.20348908007144928m and 4.235695123672485 degrees.
Mean error 0.2171899676549169m and 5.750182139970031 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20348908007144928 val_loss =  0.007557773047009825
                     Median error 0.20348908007144928m and 4.235695123672485 degrees.
Mean error 0.2171899676549169m and 5.750182139970031 degrees.
epochs:   7%|██████████▍                                                                                                                                          | 141/2001 [4:06:37<54:54:42, 106.28s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 141
For nerf, args.lrate = 1e-09, new_lrate = 9.986929865542337e-10, global_step = 142
At epoch  141 : train loss: 26.5384, train psnr: 22.0376, val loss: 0.0075, val psnr: 21.3497                                                                                                              
epochs:   7%|██████████▍                                                                                                                                          | 141/2001 [4:08:16<54:54:42, 106.28s/it]Median error 0.20125068724155426m and 3.958147168159485 degrees.
Mean error 0.21784691772751721m and 5.5143456020607395 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20125068724155426 val_loss =  0.007493654332794263
epochs:   7%|██████████▌                                                                                                                                          | 142/2001 [4:08:21<54:36:35, 105.75s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 142
For nerf, args.lrate = 1e-09, new_lrate = 9.9868378829426e-10, global_step = 143
At epoch  142 : train loss: 29.8047, train psnr: 21.6159, val loss: 0.0076, val psnr: 20.9965                                                                                                              
epochs:   7%|██████████▌                                                                                                                                          | 142/2001 [4:10:00<54:36:35, 105.75s/it]Median error 0.20344524085521698m and 3.980041027069092 degrees.
Mean error 0.21929814523229232m and 5.544415387728436 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20344524085521698 val_loss =  0.0075745065349383
epochs:   7%|██████████▋                                                                                                                                          | 143/2001 [4:10:05<54:22:25, 105.35s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 143
For nerf, args.lrate = 1e-09, new_lrate = 9.98674590119005e-10, global_step = 144
At epoch  143 : train loss: 30.1603, train psnr: 21.6276, val loss: 0.0075, val psnr: 19.9921                                                                                                              
epochs:   7%|██████████▋                                                                                                                                          | 143/2001 [4:11:45<54:22:25, 105.35s/it]Median error 0.20473291724920273m and 4.067492485046387 degrees.
Mean error 0.21814479943560927m and 5.682018673552675 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20473291724920273 val_loss =  0.007542896693635323
epochs:   7%|██████████▋                                                                                                                                          | 144/2001 [4:11:50<54:13:14, 105.11s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 144
For nerf, args.lrate = 1e-09, new_lrate = 9.98665392028468e-10, global_step = 145
At epoch  144 : train loss: 28.9203, train psnr: 21.7197, val loss: 0.0075, val psnr: 21.2649                                                                                                              
epochs:   7%|██████████▋                                                                                                                                          | 144/2001 [4:13:29<54:13:14, 105.11s/it]Median error 0.2023632898926735m and 3.9818109273910522 degrees.
Mean error 0.21750793744044505m and 5.545105888866461 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2023632898926735 val_loss =  0.007498053999156748
epochs:   7%|██████████▊                                                                                                                                          | 145/2001 [4:13:35<54:06:03, 104.94s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 145
For nerf, args.lrate = 1e-09, new_lrate = 9.986561940226481e-10, global_step = 146
At epoch  145 : train loss: 28.8443, train psnr: 21.8186, val loss: 0.0076, val psnr: 21.1789                                                                                                              
epochs:   7%|██████████▊                                                                                                                                          | 145/2001 [4:15:14<54:06:03, 104.94s/it]Median error 0.20070087909698486m and 3.9333468675613403 degrees.
Mean error 0.21736977209416236m and 5.577714287468537 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20070087909698486 val_loss =  0.007564364461484412
epochs:   7%|██████████▊                                                                                                                                          | 146/2001 [4:15:19<53:59:46, 104.79s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 146
For nerf, args.lrate = 1e-09, new_lrate = 9.986469961015446e-10, global_step = 147
At epoch  146 : train loss: 29.0776, train psnr: 21.7708, val loss: 0.0075, val psnr: 21.2751                                                                                                              
epochs:   7%|██████████▊                                                                                                                                          | 146/2001 [4:16:58<53:59:46, 104.79s/it]Median error 0.2024751380085945m and 4.104087591171265 degrees.
Mean error 0.21657956287883193m and 5.599644561769509 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2024751380085945 val_loss =  0.007468793684296661
epochs:   7%|██████████▉                                                                                                                                          | 147/2001 [4:17:04<53:58:05, 104.79s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 147
For nerf, args.lrate = 1e-09, new_lrate = 9.986377982651569e-10, global_step = 148
At epoch  147 : train loss: 25.7552, train psnr: 22.0707, val loss: 0.0075, val psnr: 20.4339                                                                                                              
epochs:   7%|██████████▉                                                                                                                                          | 147/2001 [4:18:43<53:58:05, 104.79s/it]Median error 0.1994142234325409m and 4.183156251907349 degrees.
Mean error 0.2146700618388923m and 5.62951560339585 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.1994142234325409 val_loss =  0.007450093960111182
epochs:   7%|███████████                                                                                                                                          | 148/2001 [4:18:48<53:51:48, 104.65s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 148
For nerf, args.lrate = 1e-09, new_lrate = 9.986286005134838e-10, global_step = 149
At epoch  148 : train loss: 28.1365, train psnr: 21.9213, val loss: 0.0075, val psnr: 21.3108                                                                                                              
epochs:   7%|███████████                                                                                                                                          | 148/2001 [4:20:27<53:51:48, 104.65s/it]Median error 0.2031763270497322m and 4.019575834274292 degrees.
Mean error 0.2174807102362878m and 5.604396276930083 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2031763270497322 val_loss =  0.007538817654496251
epochs:   7%|███████████                                                                                                                                          | 149/2001 [4:20:33<53:48:51, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 149
For nerf, args.lrate = 1e-09, new_lrate = 9.986194028465248e-10, global_step = 150
At epoch  149 : train loss: 26.4978, train psnr: 22.0325, val loss: 0.0075, val psnr: 21.0821                                                                                                              
epochs:   7%|███████████                                                                                                                                          | 149/2001 [4:22:12<53:48:51, 104.61s/it]Median error 0.20248844474554062m and 3.976005434989929 degrees.
Mean error 0.2175184930014888m and 5.545865067646571 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20248844474554062 val_loss =  0.007510446754860034
epochs:   7%|███████████▏                                                                                                                                         | 150/2001 [4:22:17<53:49:23, 104.68s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 150
For nerf, args.lrate = 1e-09, new_lrate = 9.98610205264279e-10, global_step = 151
At epoch  150 : train loss: 27.7539, train psnr: 21.9137, val loss: 0.0076, val psnr: 20.5279                                                                                                              
epochs:   7%|███████████▏                                                                                                                                         | 150/2001 [4:23:57<53:49:23, 104.68s/it]Median error 0.20566638559103012m and 4.042880058288574 degrees.
Mean error 0.2184820471007211m and 5.567486322450976 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20566638559103012 val_loss =  0.007574198943373572
epochs:   8%|███████████▏                                                                                                                                         | 151/2001 [4:24:02<53:46:32, 104.64s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 151
For nerf, args.lrate = 1e-09, new_lrate = 9.986010077667455e-10, global_step = 152
At epoch  151 : train loss: 28.1706, train psnr: 21.8689, val loss: 0.0075, val psnr: 21.2881                                                                                                              
epochs:   8%|███████████▏                                                                                                                                         | 151/2001 [4:25:41<53:46:32, 104.64s/it]Median error 0.2010742425918579m and 4.0818071365356445 degrees.
Mean error 0.21650747385117328m and 5.6203367252219545 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2010742425918579 val_loss =  0.0074913566874345834
epochs:   8%|███████████▎                                                                                                                                         | 152/2001 [4:25:47<53:43:25, 104.60s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 152
For nerf, args.lrate = 1e-09, new_lrate = 9.98591810353924e-10, global_step = 153
At epoch  152 : train loss: 27.6255, train psnr: 21.8230, val loss: 0.0075, val psnr: 21.0550                                                                                                              
epochs:   8%|███████████▎                                                                                                                                         | 152/2001 [4:27:26<53:43:25, 104.60s/it]Median error 0.20193321257829666m and 3.9918248653411865 degrees.
Mean error 0.2172554080008797m and 5.552340823267153 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20193321257829666 val_loss =  0.007492648231093951
epochs:   8%|███████████▍                                                                                                                                         | 153/2001 [4:27:31<53:42:05, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 153
For nerf, args.lrate = 1e-09, new_lrate = 9.985826130258132e-10, global_step = 154
At epoch  153 : train loss: 28.2388, train psnr: 21.8488, val loss: 0.0074, val psnr: 21.0111                                                                                                              
epochs:   8%|███████████▍                                                                                                                                         | 153/2001 [4:29:11<53:42:05, 104.61s/it]Median error 0.2026139572262764m and 4.055253267288208 degrees.
Mean error 0.21656105784993424m and 5.547277217120053 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2026139572262764 val_loss =  0.0074424603437865345
epochs:   8%|███████████▍                                                                                                                                         | 154/2001 [4:29:16<53:42:02, 104.67s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 154
For nerf, args.lrate = 1e-09, new_lrate = 9.985734157824128e-10, global_step = 155
At epoch  154 : train loss: 26.6536, train psnr: 21.9848, val loss: 0.0075, val psnr: 20.5025                                                                                                              
epochs:   8%|███████████▍                                                                                                                                         | 154/2001 [4:30:55<53:42:02, 104.67s/it]Median error 0.20356129109859467m and 4.028913974761963 degrees.
Mean error 0.21614212714331715m and 5.629168686023367 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20356129109859467 val_loss =  0.007480677041502741
epochs:   8%|███████████▌                                                                                                                                         | 155/2001 [4:31:01<53:39:30, 104.64s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 155
For nerf, args.lrate = 1e-09, new_lrate = 9.985642186237215e-10, global_step = 156
At epoch  155 : train loss: 31.3743, train psnr: 21.4945, val loss: 0.0076, val psnr: 21.2891                                                                                                              
epochs:   8%|███████████▌                                                                                                                                         | 155/2001 [4:32:40<53:39:30, 104.64s/it]Median error 0.20234166830778122m and 3.9374260902404785 degrees.
Mean error 0.2184708799209129m and 5.567615888288871 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20234166830778122 val_loss =  0.00758209298293826
epochs:   8%|███████████▌                                                                                                                                         | 156/2001 [4:32:45<53:38:15, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 156
For nerf, args.lrate = 1e-09, new_lrate = 9.985550215497389e-10, global_step = 157
At epoch  156 : train loss: 28.4471, train psnr: 21.7272, val loss: 0.0075, val psnr: 20.4558                                                                                                              
epochs:   8%|███████████▌                                                                                                                                         | 156/2001 [4:34:24<53:38:15, 104.66s/it]Median error 0.202139750123024m and 4.195190906524658 degrees.
Mean error 0.21818489299310365m and 5.609036463716252 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.202139750123024 val_loss =  0.007508790910292063
epochs:   8%|███████████▋                                                                                                                                         | 157/2001 [4:34:30<53:35:34, 104.63s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 157
For nerf, args.lrate = 1e-09, new_lrate = 9.98545824560464e-10, global_step = 158
At epoch  157 : train loss: 29.2302, train psnr: 21.7783, val loss: 0.0075, val psnr: 20.8814                                                                                                              
epochs:   8%|███████████▋                                                                                                                                         | 157/2001 [4:36:09<53:35:34, 104.63s/it]Median error 0.20410922914743423m and 4.173507452011108 degrees.
Mean error 0.2173182820629796m and 5.664740044578367 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20410922914743423 val_loss =  0.007538349212261354
epochs:   8%|███████████▊                                                                                                                                         | 158/2001 [4:36:15<53:35:58, 104.70s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 158
For nerf, args.lrate = 1e-09, new_lrate = 9.985366276558961e-10, global_step = 159
At epoch  158 : train loss: 29.3115, train psnr: 21.6669, val loss: 0.0075, val psnr: 20.7500                                                                                                              
epochs:   8%|███████████▊                                                                                                                                         | 158/2001 [4:37:54<53:35:58, 104.70s/it]Median error 0.2036433219909668m and 4.101703405380249 degrees.
Mean error 0.21730838496961935m and 5.652875357733564 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2036433219909668 val_loss =  0.007526422124443814
epochs:   8%|███████████▊                                                                                                                                         | 159/2001 [4:37:59<53:33:06, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 159
For nerf, args.lrate = 1e-09, new_lrate = 9.985274308360345e-10, global_step = 160
At epoch  159 : train loss: 27.7833, train psnr: 21.8407, val loss: 0.0075, val psnr: 21.3974                                                                                                              
epochs:   8%|███████████▊                                                                                                                                         | 159/2001 [4:39:38<53:33:06, 104.66s/it]Median error 0.20197320729494095m and 4.045299530029297 degrees.
Mean error 0.2160208892333604m and 5.637971272413065 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20197320729494095 val_loss =  0.007482533725389201
epochs:   8%|███████████▉                                                                                                                                         | 160/2001 [4:39:44<53:31:20, 104.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 160
For nerf, args.lrate = 1e-09, new_lrate = 9.985182341008783e-10, global_step = 161
At epoch  160 : train loss: 27.0530, train psnr: 22.0010, val loss: 0.0076, val psnr: 20.1989                                                                                                              
epochs:   8%|███████████▉                                                                                                                                         | 160/2001 [4:41:23<53:31:20, 104.66s/it]Median error 0.20157106220722198m and 4.042879581451416 degrees.
Mean error 0.21779687738852946m and 5.611932092229364 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20157106220722198 val_loss =  0.007589800774837611
                     Median error 0.20157106220722198m and 4.042879581451416 degrees.
Mean error 0.21779687738852946m and 5.611932092229364 degrees.
epochs:   8%|███████████▉                                                                                                                                         | 161/2001 [4:41:33<54:14:45, 106.13s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 161
For nerf, args.lrate = 1e-09, new_lrate = 9.985090374504269e-10, global_step = 162
At epoch  161 : train loss: 29.1633, train psnr: 21.6622, val loss: 0.0075, val psnr: 21.2435                                                                                                              
epochs:   8%|███████████▉                                                                                                                                         | 161/2001 [4:43:13<54:14:45, 106.13s/it]Median error 0.20144005119800568m and 3.9656563997268677 degrees.
Mean error 0.2172329326307303m and 5.534305597938266 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20144005119800568 val_loss =  0.007478314349509121
epochs:   8%|████████████                                                                                                                                         | 162/2001 [4:43:18<53:58:36, 105.66s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 162
For nerf, args.lrate = 1e-09, new_lrate = 9.984998408846793e-10, global_step = 163
At epoch  162 : train loss: 29.2491, train psnr: 21.7631, val loss: 0.0076, val psnr: 20.5646                                                                                                              
epochs:   8%|████████████                                                                                                                                         | 162/2001 [4:44:57<53:58:36, 105.66s/it]Median error 0.20289333909749985m and 3.961406707763672 degrees.
Mean error 0.2193723403309521m and 5.579244328504391 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20289333909749985 val_loss =  0.007616810494244286
epochs:   8%|████████████▏                                                                                                                                        | 163/2001 [4:45:03<53:47:40, 105.36s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 163
For nerf, args.lrate = 1e-09, new_lrate = 9.984906444036348e-10, global_step = 164
At epoch  163 : train loss: 29.7338, train psnr: 21.7225, val loss: 0.0077, val psnr: 20.3019                                                                                                              
epochs:   8%|████████████▏                                                                                                                                        | 163/2001 [4:46:42<53:47:40, 105.36s/it]Median error 0.20387233048677444m and 4.077489137649536 degrees.
Mean error 0.21982975377275152m and 5.6254793395880265 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20387233048677444 val_loss =  0.007675333426333728
epochs:   8%|████████████▏                                                                                                                                        | 164/2001 [4:46:47<53:38:49, 105.13s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 164
For nerf, args.lrate = 1e-09, new_lrate = 9.984814480072926e-10, global_step = 165
At epoch  164 : train loss: 29.0336, train psnr: 21.7629, val loss: 0.0075, val psnr: 20.9019                                                                                                              
epochs:   8%|████████████▏                                                                                                                                        | 164/2001 [4:48:27<53:38:49, 105.13s/it]Median error 0.20103894919157028m and 3.9619027376174927 degrees.
Mean error 0.2174192543522368m and 5.575307623275861 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20103894919157028 val_loss =  0.00753780463278583
epochs:   8%|████████████▎                                                                                                                                        | 165/2001 [4:48:32<53:32:58, 105.00s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 165
For nerf, args.lrate = 1e-09, new_lrate = 9.98472251695652e-10, global_step = 166
At epoch  165 : train loss: 27.8773, train psnr: 21.8935, val loss: 0.0075, val psnr: 21.2442                                                                                                              
epochs:   8%|████████████▎                                                                                                                                        | 165/2001 [4:50:11<53:32:58, 105.00s/it]Median error 0.20247260481119156m and 3.900571346282959 degrees.
Mean error 0.21773013598492996m and 5.549241134542444 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20247260481119156 val_loss =  0.007530362283300065
epochs:   8%|████████████▎                                                                                                                                        | 166/2001 [4:50:17<53:28:30, 104.91s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 166
For nerf, args.lrate = 1e-09, new_lrate = 9.984630554687123e-10, global_step = 167
At epoch  166 : train loss: 27.5190, train psnr: 21.9237, val loss: 0.0075, val psnr: 21.2740                                                                                                              
epochs:   8%|████████████▎                                                                                                                                        | 166/2001 [4:51:56<53:28:30, 104.91s/it]Median error 0.20130916684865952m and 3.9606175422668457 degrees.
Mean error 0.21657452080775852m and 5.593436634009667 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20130916684865952 val_loss =  0.007545122009422064
epochs:   8%|████████████▍                                                                                                                                        | 167/2001 [4:52:01<53:24:38, 104.84s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 167
For nerf, args.lrate = 1e-09, new_lrate = 9.984538593264724e-10, global_step = 168
At epoch  167 : train loss: 26.7786, train psnr: 22.0374, val loss: 0.0075, val psnr: 21.0504                                                                                                              
epochs:   8%|████████████▍                                                                                                                                        | 167/2001 [4:53:41<53:24:38, 104.84s/it]Median error 0.20413337647914886m and 3.9770896434783936 degrees.
Mean error 0.21755103572358486m and 5.525160145693221 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20413337647914886 val_loss =  0.007457529441181331
epochs:   8%|████████████▌                                                                                                                                        | 168/2001 [4:53:46<53:20:47, 104.77s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 168
For nerf, args.lrate = 1e-09, new_lrate = 9.984446632689317e-10, global_step = 169
At epoch  168 : train loss: 27.6687, train psnr: 21.8899, val loss: 0.0078, val psnr: 20.8665                                                                                                              
epochs:   8%|████████████▌                                                                                                                                        | 168/2001 [4:55:25<53:20:47, 104.77s/it]Median error 0.20454438775777817m and 4.026192903518677 degrees.
Mean error 0.22113324030253448m and 5.628520268298354 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20454438775777817 val_loss =  0.0077884015177686694
epochs:   8%|████████████▌                                                                                                                                        | 169/2001 [4:55:31<53:18:35, 104.76s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 9.025e-06, global_step = 169
For nerf, args.lrate = 1e-09, new_lrate = 9.984354672960895e-10, global_step = 170
Epoch 00170: reducing learning rate of group 0 to 8.5738e-06.
At epoch  169 : train loss: 27.4337, train psnr: 21.8688, val loss: 0.0076, val psnr: 20.9482                                                                                                              
epochs:   8%|████████████▌                                                                                                                                        | 169/2001 [4:57:10<53:18:35, 104.76s/it]Median error 0.20503877848386765m and 4.079599857330322 degrees.
Mean error 0.21804574732989193m and 5.6404215776727264 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20503877848386765 val_loss =  0.007552922332428654
epochs:   8%|████████████▋                                                                                                                                        | 170/2001 [4:57:15<53:14:46, 104.69s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 170
For nerf, args.lrate = 1e-09, new_lrate = 9.98426271407945e-10, global_step = 171
At epoch  170 : train loss: 30.1918, train psnr: 21.5941, val loss: 0.0077, val psnr: 19.9486                                                                                                              
epochs:   8%|████████████▋                                                                                                                                        | 170/2001 [4:58:54<53:14:46, 104.69s/it]Median error 0.20262431353330612m and 4.1211256980896 degrees.
Mean error 0.2197366649179384m and 5.665595183940793 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20262431353330612 val_loss =  0.007662396462758987
epochs:   9%|████████████▋                                                                                                                                        | 171/2001 [4:59:00<53:11:02, 104.62s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 171
For nerf, args.lrate = 1e-09, new_lrate = 9.984170756044972e-10, global_step = 172
At epoch  171 : train loss: 27.1260, train psnr: 21.9252, val loss: 0.0075, val psnr: 20.3385                                                                                                              
epochs:   9%|████████████▋                                                                                                                                        | 171/2001 [5:00:39<53:11:02, 104.62s/it]Median error 0.2030709609389305m and 4.0219128131866455 degrees.
Mean error 0.21825542604090714m and 5.578527724091341 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2030709609389305 val_loss =  0.00751838353876098
epochs:   9%|████████████▊                                                                                                                                        | 172/2001 [5:00:44<53:07:21, 104.56s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 172
For nerf, args.lrate = 1e-09, new_lrate = 9.984078798857456e-10, global_step = 173
At epoch  172 : train loss: 26.9415, train psnr: 22.0346, val loss: 0.0075, val psnr: 21.3462                                                                                                              
epochs:   9%|████████████▊                                                                                                                                        | 172/2001 [5:02:23<53:07:21, 104.56s/it]Median error 0.2019268348813057m and 4.009631633758545 degrees.
Mean error 0.21657563588744114m and 5.615230589712921 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2019268348813057 val_loss =  0.007524171981985043
epochs:   9%|████████████▉                                                                                                                                        | 173/2001 [5:02:29<53:06:24, 104.59s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 173
For nerf, args.lrate = 1e-09, new_lrate = 9.983986842516894e-10, global_step = 174
At epoch  173 : train loss: 25.1186, train psnr: 22.2610, val loss: 0.0076, val psnr: 20.8712                                                                                                              
epochs:   9%|████████████▉                                                                                                                                        | 173/2001 [5:04:08<53:06:24, 104.59s/it]Median error 0.20104015618562698m and 4.071917772293091 degrees.
Mean error 0.21855930844510374m and 5.61544240809042 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20104015618562698 val_loss =  0.007609865237593576
epochs:   9%|████████████▉                                                                                                                                        | 174/2001 [5:04:13<53:05:34, 104.62s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 174
For nerf, args.lrate = 1e-09, new_lrate = 9.983894887023276e-10, global_step = 175
At epoch  174 : train loss: 25.8971, train psnr: 22.1154, val loss: 0.0075, val psnr: 20.6384                                                                                                              
epochs:   9%|████████████▉                                                                                                                                        | 174/2001 [5:05:52<53:05:34, 104.62s/it]Median error 0.20297154039144516m and 4.116753339767456 degrees.
Mean error 0.21793950062154638m and 5.6507702149480945 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20297154039144516 val_loss =  0.00750937641215398
epochs:   9%|█████████████                                                                                                                                        | 175/2001 [5:05:58<53:00:56, 104.52s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 175
For nerf, args.lrate = 1e-09, new_lrate = 9.983802932376596e-10, global_step = 176
At epoch  175 : train loss: 28.2536, train psnr: 21.8298, val loss: 0.0076, val psnr: 20.9960                                                                                                              
epochs:   9%|█████████████                                                                                                                                        | 175/2001 [5:07:37<53:00:56, 104.52s/it]Median error 0.2020762860774994m and 3.8712600469589233 degrees.
Mean error 0.21738154096868237m and 5.5833684364673095 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2020762860774994 val_loss =  0.007589292539241686
epochs:   9%|█████████████                                                                                                                                        | 176/2001 [5:07:42<53:00:07, 104.55s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 176
For nerf, args.lrate = 1e-09, new_lrate = 9.983710978576846e-10, global_step = 177
At epoch  176 : train loss: 25.8346, train psnr: 22.1413, val loss: 0.0076, val psnr: 20.9894                                                                                                              
epochs:   9%|█████████████                                                                                                                                        | 176/2001 [5:09:22<53:00:07, 104.55s/it]Median error 0.2045227810740471m and 4.017913579940796 degrees.
Mean error 0.21803047486132215m and 5.60503219255069 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2045227810740471 val_loss =  0.0075507876496373905
epochs:   9%|█████████████▏                                                                                                                                       | 177/2001 [5:09:27<52:59:20, 104.58s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 177
For nerf, args.lrate = 1e-09, new_lrate = 9.983619025624019e-10, global_step = 178
At epoch  177 : train loss: 26.2960, train psnr: 22.0742, val loss: 0.0076, val psnr: 20.8970                                                                                                              
epochs:   9%|█████████████▏                                                                                                                                       | 177/2001 [5:11:06<52:59:20, 104.58s/it]Median error 0.20252759009599686m and 3.9475525617599487 degrees.
Mean error 0.21766171647756086m and 5.60066785078179 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20252759009599686 val_loss =  0.007572137388522216
epochs:   9%|█████████████▎                                                                                                                                       | 178/2001 [5:11:12<52:58:51, 104.62s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 178
For nerf, args.lrate = 1e-09, new_lrate = 9.983527073518103e-10, global_step = 179
At epoch  178 : train loss: 27.2004, train psnr: 22.0032, val loss: 0.0074, val psnr: 21.0356                                                                                                              
epochs:   9%|█████████████▎                                                                                                                                       | 178/2001 [5:12:51<52:58:51, 104.62s/it]Median error 0.20111246407032013m and 3.9329497814178467 degrees.
Mean error 0.2153555573292288m and 5.5495887772002925 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20111246407032013 val_loss =  0.0074342558148670764
epochs:   9%|█████████████▎                                                                                                                                       | 179/2001 [5:12:56<52:56:14, 104.60s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 179
For nerf, args.lrate = 1e-09, new_lrate = 9.983435122259095e-10, global_step = 180
At epoch  179 : train loss: 27.1195, train psnr: 21.9852, val loss: 0.0076, val psnr: 20.1565                                                                                                              
epochs:   9%|█████████████▎                                                                                                                                       | 179/2001 [5:14:35<52:56:14, 104.60s/it]Median error 0.2031666859984398m and 4.055155992507935 degrees.
Mean error 0.21820699246713388m and 5.630107126798224 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2031666859984398 val_loss =  0.007571387883718314
epochs:   9%|█████████████▍                                                                                                                                       | 180/2001 [5:14:41<52:55:17, 104.62s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 180
For nerf, args.lrate = 1e-09, new_lrate = 9.983343171846985e-10, global_step = 181
At epoch  180 : train loss: 26.7770, train psnr: 21.9980, val loss: 0.0076, val psnr: 20.8402                                                                                                              
epochs:   9%|█████████████▍                                                                                                                                       | 180/2001 [5:16:20<52:55:17, 104.62s/it]Median error 0.20184429734945297m and 4.172285556793213 degrees.
Mean error 0.2165877614094902m and 5.6757412543180985 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20184429734945297 val_loss =  0.00756059952603942
                     Median error 0.20184429734945297m and 4.172285556793213 degrees.
Mean error 0.2165877614094902m and 5.6757412543180985 degrees.
epochs:   9%|█████████████▍                                                                                                                                       | 181/2001 [5:16:31<53:40:10, 106.16s/it]

 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 181
For nerf, args.lrate = 1e-09, new_lrate = 9.983251222281766e-10, global_step = 182
At epoch  181 : train loss: 26.5122, train psnr: 22.0473, val loss: 0.0076, val psnr: 20.7196                                                                                                              
epochs:   9%|█████████████▍                                                                                                                                       | 181/2001 [5:18:10<53:40:10, 106.16s/it]Median error 0.20489677041769028m and 4.242066144943237 degrees.
Mean error 0.21736936141484178m and 5.728344927854866 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20489677041769028 val_loss =  0.007580477251033916
epochs:   9%|█████████████▌                                                                                                                                       | 182/2001 [5:18:15<53:23:57, 105.68s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 182
For nerf, args.lrate = 1e-09, new_lrate = 9.983159273563432e-10, global_step = 183
At epoch  182 : train loss: 27.6785, train psnr: 21.8528, val loss: 0.0075, val psnr: 21.1858                                                                                                              
epochs:   9%|█████████████▌                                                                                                                                       | 182/2001 [5:19:54<53:23:57, 105.68s/it]Median error 0.20167864114046097m and 3.9452717304229736 degrees.
Mean error 0.21837537092824094m and 5.544377604627657 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20167864114046097 val_loss =  0.007532841969304529
epochs:   9%|█████████████▋                                                                                                                                       | 183/2001 [5:20:00<53:10:04, 105.28s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 183
For nerf, args.lrate = 1e-09, new_lrate = 9.983067325691969e-10, global_step = 184
At epoch  183 : train loss: 27.5424, train psnr: 21.9335, val loss: 0.0074, val psnr: 20.5773                                                                                                              
epochs:   9%|█████████████▋                                                                                                                                       | 183/2001 [5:21:39<53:10:04, 105.28s/it]Median error 0.2001786231994629m and 4.049235105514526 degrees.
Mean error 0.21505760916542668m and 5.604059449212271 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2001786231994629 val_loss =  0.007425861349784174
epochs:   9%|█████████████▋                                                                                                                                       | 184/2001 [5:21:44<53:00:35, 105.03s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 184
For nerf, args.lrate = 1e-09, new_lrate = 9.982975378667376e-10, global_step = 185
At epoch  184 : train loss: 26.6584, train psnr: 21.9769, val loss: 0.0075, val psnr: 21.4470                                                                                                              
epochs:   9%|█████████████▋                                                                                                                                       | 184/2001 [5:23:23<53:00:35, 105.03s/it]Median error 0.201150581240654m and 3.8773183822631836 degrees.
Mean error 0.21818189299571128m and 5.516265187910212 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.201150581240654 val_loss =  0.00754376198249072
epochs:   9%|█████████████▊                                                                                                                                       | 185/2001 [5:23:29<52:56:50, 104.96s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 185
For nerf, args.lrate = 1e-09, new_lrate = 9.982883432489642e-10, global_step = 186
At epoch  185 : train loss: 26.4801, train psnr: 22.0671, val loss: 0.0075, val psnr: 21.4435                                                                                                              
epochs:   9%|█████████████▊                                                                                                                                       | 185/2001 [5:25:08<52:56:50, 104.96s/it]Median error 0.20219318568706512m and 3.9154947996139526 degrees.
Mean error 0.2181670062492794m and 5.500496151265104 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20219318568706512 val_loss =  0.007531348396486674
epochs:   9%|█████████████▊                                                                                                                                       | 186/2001 [5:25:13<52:50:13, 104.80s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 186
For nerf, args.lrate = 1e-09, new_lrate = 9.982791487158759e-10, global_step = 187
At epoch  186 : train loss: 26.7918, train psnr: 22.0673, val loss: 0.0076, val psnr: 21.3478                                                                                                              
epochs:   9%|█████████████▊                                                                                                                                       | 186/2001 [5:26:52<52:50:13, 104.80s/it]Median error 0.20189371705055237m and 3.9588396549224854 degrees.
Mean error 0.2184261654990043m and 5.581151139790471 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20189371705055237 val_loss =  0.007575699274628145
epochs:   9%|█████████████▉                                                                                                                                       | 187/2001 [5:26:58<52:47:01, 104.75s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 187
For nerf, args.lrate = 1e-09, new_lrate = 9.98269954267472e-10, global_step = 188
At epoch  187 : train loss: 24.3139, train psnr: 22.3068, val loss: 0.0074, val psnr: 21.5678                                                                                                              
epochs:   9%|█████████████▉                                                                                                                                       | 187/2001 [5:28:37<52:47:01, 104.75s/it]Median error 0.20202647149562836m and 4.018505334854126 degrees.
Mean error 0.21667737410467888m and 5.575001450775847 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20202647149562836 val_loss =  0.007449490654982531
epochs:   9%|█████████████▉                                                                                                                                       | 188/2001 [5:28:42<52:40:49, 104.61s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 188
For nerf, args.lrate = 1e-09, new_lrate = 9.982607599037518e-10, global_step = 189
At epoch  188 : train loss: 26.7130, train psnr: 22.0202, val loss: 0.0076, val psnr: 20.3549                                                                                                              
epochs:   9%|█████████████▉                                                                                                                                       | 188/2001 [5:30:21<52:40:49, 104.61s/it]Median error 0.20356052368879318m and 4.079312801361084 degrees.
Mean error 0.21858303462294673m and 5.668348139868333 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20356052368879318 val_loss =  0.007606105587822489
epochs:   9%|██████████████                                                                                                                                       | 189/2001 [5:30:27<52:36:58, 104.54s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 189
For nerf, args.lrate = 1e-09, new_lrate = 9.982515656247145e-10, global_step = 190
At epoch  189 : train loss: 28.2256, train psnr: 21.8506, val loss: 0.0075, val psnr: 21.1009                                                                                                              
epochs:   9%|██████████████                                                                                                                                       | 189/2001 [5:32:06<52:36:58, 104.54s/it]Median error 0.2023290991783142m and 4.103133916854858 degrees.
Mean error 0.2174830081936741m and 5.629034921376087 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2023290991783142 val_loss =  0.007502507033328025
epochs:   9%|██████████████▏                                                                                                                                      | 190/2001 [5:32:11<52:37:12, 104.60s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 190
For nerf, args.lrate = 1e-09, new_lrate = 9.982423714303591e-10, global_step = 191
At epoch  190 : train loss: 27.1964, train psnr: 22.0250, val loss: 0.0075, val psnr: 20.8094                                                                                                              
epochs:   9%|██████████████▏                                                                                                                                      | 190/2001 [5:33:50<52:37:12, 104.60s/it]Median error 0.20144864916801453m and 4.134579420089722 degrees.
Mean error 0.21595449097499794m and 5.665881039582283 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20144864916801453 val_loss =  0.007501355251682657
epochs:  10%|██████████████▏                                                                                                                                      | 191/2001 [5:33:56<52:32:07, 104.49s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 191
For nerf, args.lrate = 1e-09, new_lrate = 9.98233177320685e-10, global_step = 192
At epoch  191 : train loss: 26.8342, train psnr: 22.0871, val loss: 0.0076, val psnr: 21.0298                                                                                                              
epochs:  10%|██████████████▏                                                                                                                                      | 191/2001 [5:35:34<52:32:07, 104.49s/it]Median error 0.20228861272335052m and 4.2319910526275635 degrees.
Mean error 0.21733688357991246m and 5.728609369562464 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20228861272335052 val_loss =  0.00758739864332427
epochs:  10%|██████████████▎                                                                                                                                      | 192/2001 [5:35:40<52:29:28, 104.46s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 192
For nerf, args.lrate = 1e-09, new_lrate = 9.982239832956913e-10, global_step = 193
At epoch  192 : train loss: 27.5355, train psnr: 21.9098, val loss: 0.0075, val psnr: 21.2093                                                                                                              
epochs:  10%|██████████████▎                                                                                                                                      | 192/2001 [5:37:19<52:29:28, 104.46s/it]Median error 0.20339708775281906m and 3.850258946418762 degrees.
Mean error 0.21934899392911056m and 5.474622601620582 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20339708775281906 val_loss =  0.007548229283651314
epochs:  10%|██████████████▎                                                                                                                                      | 193/2001 [5:37:24<52:26:45, 104.43s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 193
For nerf, args.lrate = 1e-09, new_lrate = 9.982147893553776e-10, global_step = 194
At epoch  193 : train loss: 25.7494, train psnr: 22.0497, val loss: 0.0076, val psnr: 21.2267                                                                                                              
epochs:  10%|██████████████▎                                                                                                                                      | 193/2001 [5:39:03<52:26:45, 104.43s/it]Median error 0.20234347134828568m and 4.238917827606201 degrees.
Mean error 0.21877469804122862m and 5.666293752639882 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20234347134828568 val_loss =  0.007565491483090205
epochs:  10%|██████████████▍                                                                                                                                      | 194/2001 [5:39:09<52:26:27, 104.48s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 194
For nerf, args.lrate = 1e-09, new_lrate = 9.982055954997425e-10, global_step = 195
At epoch  194 : train loss: 25.9199, train psnr: 22.0918, val loss: 0.0076, val psnr: 21.1270                                                                                                              
epochs:  10%|██████████████▍                                                                                                                                      | 194/2001 [5:40:48<52:26:27, 104.48s/it]Median error 0.2030358910560608m and 4.018018007278442 degrees.
Mean error 0.21910030817469725m and 5.558633990615968 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.2030358910560608 val_loss =  0.0075818854976658235
epochs:  10%|██████████████▌                                                                                                                                      | 195/2001 [5:40:53<52:25:56, 104.52s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 195
For nerf, args.lrate = 1e-09, new_lrate = 9.981964017287858e-10, global_step = 196
At epoch  195 : train loss: 26.0256, train psnr: 22.1275, val loss: 0.0075, val psnr: 21.1738                                                                                                              
epochs:  10%|██████████████▌                                                                                                                                      | 195/2001 [5:42:33<52:25:56, 104.52s/it]Median error 0.20188265293836594m and 4.052645921707153 degrees.
Mean error 0.21686682848237182m and 5.611750562513164 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20188265293836594 val_loss =  0.007512717556001228
epochs:  10%|██████████████▌                                                                                                                                      | 196/2001 [5:42:38<52:25:02, 104.54s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
For dfnetdm, args.learning_rate = 1e-05, new_lrate = 8.57375e-06, global_step = 196
For nerf, args.lrate = 1e-09, new_lrate = 9.981872080425063e-10, global_step = 197
At epoch  196 : train loss: 27.2871, train psnr: 22.0422, val loss: 0.0076, val psnr: 21.1680                                                                                                              
epochs:  10%|██████████████▌                                                                                                                                      | 196/2001 [5:44:17<52:25:02, 104.54s/it]Median error 0.20214883238077164m and 3.9474459886550903 degrees.
Mean error 0.2177364620067149m and 5.5970444339007015 degrees.


 ============= self.val_on_psnr =  False validation on median_t!! (in /home/jialu/zeroshot123cycle0524/dm/callbacks.py)
=====. median_t =  0.20214883238077164 val_loss =  0.007593039158921522
epochs:  10%|██████████████▋                                                                                                                                      | 197/2001 [5:44:23<52:22:20, 104.51s/it]
Best val loss: 0.1980
 ==== Origional DFnet training in train_on_epoch==========
epochs:  10%|██████████████▋                                                                                                                                      | 197/2001 [5:45:26<52:43:16, 105.21s/it]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 356, in train_on_batch
    rgb, disp, acc, extras = render(H//4, W//4, focal/4, chunk=args.chunk, c2w=pose_nerf[0,:3,:4], img_idx=img_idx, **render_kwargs_train)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 399, in render
    all_ret = batchify_rays(rays, chunk, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 344, in batchify_rays
    ret = render_rays(rays_flat[i:i+chunk], **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 313, in render_rays
    raw = network_query_fn(pts, viewdirs, img_idxs, network_fine, 'fine', embedding_a, embedding_t, output_transient, test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 441, in <lambda>
    test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 93, in run_network_NeRFW
    embedded_inputs = [embed_fn(inputs_flat[i: i+netchunk]), embeddirs_fn(input_dirs_flat[i:i+netchunk])]
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 223, in <lambda>
    embed = lambda x, eo=embedder_obj : eo.embed(x)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 137, in embed
    ret = torch.cat([fn(inputs) for fn in self.embed_fns], -1) # cos, sin embedding
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 137, in <listcomp>
    ret = torch.cat([fn(inputs) for fn in self.embed_fns], -1) # cos, sin embedding
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 130, in <lambda>
    embed_fns.append(lambda x, p_fn=p_fn, freq=freq : p_fn(x * freq))
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/traceback.py", line 197, in format_stack
    return format_list(extract_stack(f, limit=limit))
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/traceback.py", line 39, in format_list
    return StackSummary.from_list(extracted_list).format()
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/traceback.py", line 427, in format
    result.append(''.join(row))
KeyboardInterrupt
Best val loss: 0.1980
(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ python train_dfnet_nerf_dso.py --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Command Line Args:   --config config_dfnetdm.txt --real --pose_avg_stats_mode 100 --no_grad_update False --lrate 1e-9 --learning_rate 0.00001
Config File (config_dfnetdm.txt):
  model_name:        dfnetdm
  expname:           nerfh
  basedir:           ./logs/heads
  datadir:           ./data/7Scenes/heads
  dataset_type:      7Scenes
  pretrain_model_path:./logs/heads/dfnetdm/checkpoint-0065-0.1980.pt
  pretrain_featurenet_path:./logs/heads/dfnetdm/checkpoint-0065-0.1980.pt
  trainskip:         5
  testskip:          1
  df:                2
  load_pose_avg_stats:True
  NeRFH:             True
  encode_hist:       True
  freezeBN:          False
  featuremetric:     True
  pose_only:         3
  svd_reg:           True
  combine_loss:      True
  combine_loss_w:    [0.01, 1, 500]
  finetune_unlabel:  True
  i_eval:            20
  DFNet:             True
  val_on_psnr:       False
  feature_matching_lvl:[0]
Defaults:
  --fff:             1
  --reduce_embedding:-1
  --epochToMaxFreq:  -1
  --train_local_nerf:-1
  --batch_size:      1
  --patience:        [200, 50]
  --resize_factor:   2
  --efficientnet_block:6
  --dropout:         0.5
  --val_batch_size:  1
  --netdepth:        8
  --netwidth:        128
  --netdepth_fine:   8
  --netwidth_fine:   128
  --N_rand:          1536
  --lrate_decay:     250
  --chunk:           32768
  --netchunk:        65536
  --N_vocab:         1000
  --hist_bin:        10
  --in_channels_a:   50
  --in_channels_t:   20
  --N_samples:       64
  --N_importance:    64
  --perturb:         1.0
  --i_embed:         0
  --multires:        10
  --multires_views:  4
  --raw_noise_std:   0.0
  --render_factor:   0
  --mesh_grid_size:  80
  --precrop_iters:   0
  --precrop_frac:    0.5
  --factor:          8
  --llffhold:        8
  --i_print:         1
  --i_img:           500
  --i_weights:       200
  --i_testset:       200
  --i_video:         50000
  --num_cycle:       2
  --pose_avg_stats_mode_pred_eval:-1



 ************ in /home/jialu/zeroshot123cycle0524/train_pre_posenet_dso.py 
 args.real= True


 ************ in load_7Scenes.py line 510 
 args.real= True
 in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py
  args.finetune_unlabel = True


 **********in seven_scenes.py line 230  self.real =  True
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 17 22 27]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= True
frame_idx_dso[0:4] =  [ 0  5 10 15]


 ======== real = True, loading poses from ./data/7Scenes/heads/dso_poses/seq-01.txt, using vo_stats_filename=./data/7Scenes/heads/seq-01/dso_vo_stats.pkl  ========




 ======= len(self.c_imgs) =  198


 **********in seven_scenes.py line 230  self.real =  False
=================train=False, split_file = ./data/7Scenes/heads/TestSplit.txt


 ===train=False, frame_idx[0:4] = [12 13 14 15]







!!!!!!!!!!!!!!!!!!!!!!!!!!!! self.real= False


 ======== real = False, loading poses from ./data/7Scenes/heads/seq-01/frame-000012.pose.txt  and etc ========




 ======= len(self.c_imgs) =  988


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.97469172 -0.12902098  0.18256406  0.01019205]
 [ 0.07811936  0.96173645  0.26260306 -0.10702473]
 [-0.20945981 -0.24169524  0.94747559  0.10368893]], poses.shape = (988, 3, 4)


 ================== 
 val  using seq01abs test best (pose_avg_stats_abs_999imgs_seq01and2-skip5.txt)


 =========== in /home/jialu/zeroshot123cycle0524/dataset_loaders/load_7Scenes.py def center_poses =========== 


pose_avg = [[ 0.65544772 -0.23273923  0.71848503 -0.09990896]
 [ 0.56813786  0.77874678 -0.26603162  0.31429131]
 [-0.49760191  0.58256837  0.64265577  0.29820491]], poses.shape = (198, 3, 4)


 ================== 
 train using pose_avg_stats_nerf_best.txt


 in load_7Scenes.py, batch_size for train_dl = 1
args.val_batch_size =  1
/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/hub.py:564: UserWarning: TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead
  warnings.warn('TORCH_MODEL_ZOO is deprecated, please use env TORCH_HOME instead')


 ================ args.no_grad_update =  False
optimizer 2  ,nerf optimizer is not None
Current line: 11 in /home/jialu/zeroshot123cycle0524/models/nerfw.py
Found ckpts ['./logs/heads/nerfh/001000.tar']
Reloading from ./logs/heads/nerfh/001000.tar
Not ndc!
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:00<?, ?it/s]

 ==== Origional DFnet training in train_on_epoch==========


 ================ pose_loss = 3.1509272957919165e-05, photo_loss = 0.005819524172693491, feat_loss=0.032515883445739746


 ================ pose_loss = 2.1235788153717294e-05, photo_loss = 0.005803142208606005, feat_loss=0.029745757579803467


 ================ pose_loss = 3.6042042665940244e-06, photo_loss = 0.006065883208066225, feat_loss=0.049464643001556396


 ================ pose_loss = 2.239505192846991e-05, photo_loss = 0.017870482057332993, feat_loss=0.16715455055236816


 ================ pose_loss = 3.4158215385104995e-06, photo_loss = 0.002802817849442363, feat_loss=0.0395967960357666


 ================ pose_loss = 1.8351587641518563e-05, photo_loss = 0.020755112171173096, feat_loss=0.14752304553985596


 ================ pose_loss = 4.676080061472021e-05, photo_loss = 0.006562017370015383, feat_loss=0.04813265800476074


 ================ pose_loss = 1.080806578102056e-05, photo_loss = 0.004482898861169815, feat_loss=0.042490363121032715


 ================ pose_loss = 2.304846202605404e-05, photo_loss = 0.00646582618355751, feat_loss=0.04557722806930542


 ================ pose_loss = 3.0742608942091465e-05, photo_loss = 0.021526286378502846, feat_loss=0.11000466346740723
epochs:   0%|                                                                                                                                                                     | 0/2001 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "train_dfnet_nerf_dso.py", line 236, in <module>
    train()
  File "train_dfnet_nerf_dso.py", line 203, in train
    train_feature_matching(args, model, feat_model, optimizer, i_split, hwf, near, far, device, early_stopping, train_dl=train_dl, val_dl=val_dl, test_dl=test_dl,num_cycle=args.num_cycle)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 703, in train_feature_matching
    loss, psnr = train_on_epoch(args, data_loaders, model, feat_model, hwf, optimizer, half_res, device, world_setup_dict, optimizer_nerf, num_cycle, **render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 466, in train_on_epoch
    loss, psnr = train_on_batch(args, data, model, feat_model, pose, img_idx, hwf, optimizer, half_res, device, world_setup_dict,optimizer_nerf,**render_kwargs_train)
  File "./feature/direct_feature_matching_unfreeze_nerf.py", line 356, in train_on_batch
    rgb, disp, acc, extras = render(H//4, W//4, focal/4, chunk=args.chunk, c2w=pose_nerf[0,:3,:4], img_idx=img_idx, **render_kwargs_train)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 399, in render
    all_ret = batchify_rays(rays, chunk, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 344, in batchify_rays
    ret = render_rays(rays_flat[i:i+chunk], **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/rendering.py", line 313, in render_rays
    raw = network_query_fn(pts, viewdirs, img_idxs, network_fine, 'fine', embedding_a, embedding_t, output_transient, test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 441, in <lambda>
    test_time=test_time)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 99, in run_network_NeRFW
    out_chunks += [fn(torch.cat(embedded_inputs, 1), output_transient=output_transient)]
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/zeroshot123cycle0524/models/nerfw.py", line 339, in forward
    static_sigma = self.static_sigma(xyz_) # (B, 1)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jialu/anaconda3/envs/dfnet0514/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt

(dfnet0514) jialu@jialu-System-Product-Name:~/zeroshot123cycle0524$ 
